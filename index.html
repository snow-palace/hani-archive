<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸å…¬æ­£çš„å“ˆå°¼ - æœ€ç»ˆå®Œæ•´å…¨æ™¯æ¡£æ¡ˆ</title>
    <style>
        :root {


            /* ================= å…¨å±€å˜é‡ ================= */
            /* å¸ƒå±€ */
            --sidebar-width: 0px;
            --navbar-height: 50px; /* [æ–°å¢] é¡¶éƒ¨å¯¼èˆªé«˜åº¦ */
            --time-col-width: 100px;
            
            /* èƒŒæ™¯é¢œè‰² */
            --bg-body: #111;
            --bg-real: #666;       /* ç°å®ï¼šäº®ç° */
            --bg-park: #444;       /* å…¬å›­ï¼šä¸­ç° */
            --bg-banqiu: #353535;     /* æ–‘ä¸˜ï¼šæ·±é»‘ */

            
            /* çº¹ç†è®¾ç½® */
            --grid-color: rgba(255, 255, 255, 0.04);
            --grid-size: 15px;

            /* è§’è‰²è‰²è°± */
            --c-yu: #FFD700;    /* äºæ²å· */
            --c-kid: #FF00FF;   /* å°å­© */
            --c-hei: #00FFFF;   /* å°é»‘ */
            --c-yan: #FFFFFF;   /* é—«ä½³å·§ */
            --c-piao: #00FF7F;  /* é£˜é£˜ */
            --c-npc: #000000;   /* NPC */
            
            /* è§„åˆ™é¡µä¸“ç”¨è‰² */
            --c-rule-surface: #aaa;
            --c-rule-hidden: #ff0055; /* éšè—è§„åˆ™æ ¸å¿ƒè‰² */
            --bg-hidden: #1a0505;     /* éšè—è§„åˆ™èƒŒæ™¯è‰² */
            
            /* åŒè‰²æ¸å˜ */
            --g-strawberry: linear-gradient(to right, #00FF7F 40%, #FF0055 60%); 
            --g-wildcat: linear-gradient(to right, #FFD700 40%, #0000FF 60%);
            
            /* === ã€æ–°å¢ã€‘äººç‰©æ¡£æ¡ˆä¸“ç”¨å˜é‡ (å¿…é¡»è¡¥å…¨ï¼) === */
            --bg-card: #ffffff55;        /* ç¤¾å›¢å¤§æ¡†èƒŒæ™¯ */
            --bg-char: #1a1a1a;        /* äººç‰©æ¡èƒŒæ™¯ */
            --border-color: #666;   /* é€šç”¨è¾¹æ¡†è‰² */

            /* --- æ–‘ä¸˜æ™¯è‰²å…¨å±€åƒæ•¸ --- */
            --bqv-dot-size: 1.2px;       /* å°é»é»å¤§å° */
            --bqv-dot-gap: 13px;         /* å°é»é»é–“è· */
            --bqv-dot-color: rgba(255, 255, 255, 0.11);
            
            --bqv-photo-border: 4px;     /* ç›¸ç‰‡é»‘é‚Šå¯¬åº¦ */
            --bqv-photo-shadow: 0 10px 30px rgba(0,0,0,0.8); /* çµ±ä¸€é™°å½± */
            --bqv-tilt-limit: 3deg;      /* æœ€å¤§å‚¾æ–œè§’åº¦é™åˆ¶ */
            
            --bqv-glass-bg: rgba(255, 255, 255, 0.05);
            --bqv-glass-blur: 12px;
        /* [æ–°å¢] æ ‡ç­¾è‰²è°± */
            --tab-home: #ffffff;   /* ä¸»é¡µ - ç™½ */
            --tab-overview: #fffb00; /* æ€»è§ˆ - æ˜é»„ */
            --tab-chars: #ff258b;  /* äººç‰© - ç²‰ */
            --tab-scenery: #3f72ff; /* æ™¯è‰² - è“å®çŸ³ */
            --tab-cards: #00b400;  /* å¡ç‰Œ - æ·±ç»¿ */
            --tab-story: #DC143C;  /* å‰§æƒ… - çº¢ */
            --tab-others: #00FFFF; /* å…¶ä»– - é’ */
            --tab-black: #000
        }

        * { box-sizing: border-box; }

/* ================= 0. [æ ¸å¿ƒä¿®å¤] åŸºç¡€å¸ƒå±€ ================= */
html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow: hidden; /* ç¦æ­¢ body æ»šåŠ¨ï¼Œäº¤ç»™å†…éƒ¨å®¹å™¨ */
    background-color: #111; 
    -webkit-tap-highlight-color: transparent;
}

/* æ‰‹æœºç«¯é«˜åº¦è¦†ç›– */
@media (max-width: 768px) {
    :root {
        --navbar-height: 40px; 
    }
}

.navbar {
    position: fixed; top: 0; left: 0; width: 100%; height: var(--navbar-height);
    background: #252525; /* æ·±è‰²åº•ï¼Œæ›´æœ‰è´¨æ„Ÿ */
    border-bottom: 2px solid #333;
    display: flex; align-items: center; justify-content: space-between;
    padding: 0; /* å†…éƒ¨å¸ƒå±€è‡ªå·±æ§åˆ¶ padding */
    z-index: 2000;
    box-shadow: 0 4px 15px rgba(0,0,0,0.8);
    transition: height 0.3s ease;
}

/* === å·¦ä¾§ï¼šLogo ä¸ æ ‡é¢˜åŒº === */
.nav-left-zone {
    display: flex; height: 100%; align-items: center;
    background: #252525; /* å·¦ä¾§çº¯é»‘åº•è‰²ï¼Œçªå‡ºLogo */
    padding-right: 20px;
    clip-path: polygon; /* åˆ‡ä¸€ä¸ªæ–œè§’ï¼Œå¢åŠ è®¾è®¡æ„Ÿ */
    width: auto;
    min-width: 200px;
}

.nav-logo-box {
    width: var(--navbar-height); /* æ­£æ–¹å½¢ï¼Œè·Ÿå¯¼èˆªæ ä¸€æ ·é«˜ */
    height: 100%;
    background: #22222200;
    display: flex; align-items: center; justify-content: center;
    border-right: 0px solid #333;
}
.nav-logo-box img {
    width: 100%; height: 100%; object-fit: contain;
}

.nav-title-box {
    display: flex; flex-direction: column; justify-content: center;
    padding-left: 15px;
}
.nav-title-main {
    color: #fff; font-weight: 900; font-size: 16px; line-height: 1.2; letter-spacing: 1px;
}
.nav-title-sub {
    color: #888; font-size: 10px; line-height: 1.2; letter-spacing: 2px; text-transform: uppercase;
}

/* === å³ä¾§ï¼šæ ‡ç­¾æ  (ç”µè„‘ç«¯) === */
.nav-tabs-container {
    flex-grow: 1; height: 100%;
    display: flex; 
    align-items: flex-end; /* æ ‡ç­¾æ²‰åº• */
    justify-content: flex-end; /* å³å¯¹é½ */
    padding-right: 40px; /* å³ä¾§ç•™ç©º */
    gap: 5px; /* æ ‡ç­¾é—´éš™ */
}

/* å•ä¸ªæ ‡ç­¾æ ·å¼ */
.nav-tab {
    position: relative;
    height: 70%; /* ä¸å æ»¡é«˜åº¦ï¼Œåƒæ–‡ä»¶å¤¹æ ‡ç­¾ */
    padding: 0 20px;
    display: flex; align-items: center; justify-content: center;
    
    font-size: 14px; font-weight: bold; color: #aaa;
    background: #444;
    border-top-left-radius: 8px; border-top-right-radius: 8px;
    border: 1px solid #777; border-bottom: none;
    
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
}

/* æ ‡ç­¾é¢œè‰²å®šä¹‰ (é€šè¿‡ CSS å˜é‡) */
.tab-home { --tab-color: var(--tab-home); }
.tab-overview { --tab-color: var(--tab-overview); }
.tab-chars { --tab-color: var(--tab-chars); }
.tab-scenery { --tab-color: var(--tab-scenery); }
.tab-cards { --tab-color: var(--tab-cards); }
.tab-story { --tab-color: var(--tab-story); }
.tab-others { --tab-color: var(--tab-others); }

/* æ‚¬æµ®ä¸æ¿€æ´»çŠ¶æ€ */
.nav-tab:hover {
    background: #333; color: #fff;
    height: 75%; /* æ‚¬æµ®ç¨å¾®å†’å¤´ */
    box-shadow: 0 0 10px var(--tab-color); /* å‘å…‰ */
    border-top-color: var(--tab-color);
}

.nav-tab.active {
    background: #111; /* æ¿€æ´»åå˜é»‘ï¼Œå’Œé¡µé¢èä¸ºä¸€ä½“ */
    color: var(--tab-color);
    height: 85%; /* æ¿€æ´»æœ€é«˜ */
    border-color: var(--tab-color);
    border-bottom: 2px solid #111; /* é®ä½å¯¼èˆªæ åº•çº¿ï¼Œå®ç°è¿é€šæ„Ÿ */
    z-index: 10;
    text-shadow: 0 0 5px var(--tab-color);
}

/* æ ‡ç­¾åº•éƒ¨çš„å°è‰²æ¡è£…é¥° */
.nav-tab::after {
    content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px;
    background: var(--tab-color); opacity: 0.5;
}
.nav-tab.active::after { opacity: 1; height: 0; } /* æ¿€æ´»åä¸éœ€è¦åº•æ¡ */


/* === æ‰‹æœºç«¯é€‚é… (æ±‰å ¡èœå•) === */
.nav-toggle-btn { display: none; } /* ç”µè„‘ç«¯éšè—æ±‰å ¡ */
.mobile-menu-overlay { display: none; } /* é»˜è®¤éšè—ä¸‹æ‹‰èœå• */

@media (max-width: 768px) {
    /* 1. éšè—æ ‡ç­¾æ  */
    .nav-tabs-container { display: none; }
    
    /* 2. å·¦ä¾§åŒºåŸŸè°ƒæ•´ */
    .nav-left-zone { 
        min-width: auto; width: auto; 
        padding-right: 15px;
        clip-path: none; /* æ‰‹æœºç«¯å»æ‰æ–œåˆ‡ï¼Œçœç©ºé—´ */
    }
    .nav-logo-box { width: 40px; border-right: none; }
    .nav-title-main { font-size: 13px; }
    .nav-title-sub { font-size: 10px; /* æ‰‹æœºå¤ªçª„å¯ä»¥éšè—å‰¯æ ‡é¢˜ */ }

/* 2. æ”¾å¤§æ±‰å ¡æŒ‰é’®åŠå…¶ç‚¹å‡»æ„Ÿ */
    .nav-toggle-btn {
        width: 40px;
        height: 40px;
        font-size: 30px; /* ä¸‰æ¨ªæ å˜å¤§ */
        display: flex;
        align-items: center;
        color:#fff;
        justify-content: center;
        cursor: pointer;
        background: rgba(255, 255, 255, 0.05); /* ç»™ä¸€ä¸ªæ·¡æ·¡çš„åº•è‰²æ–¹ä¾¿è¯†åˆ« */
        border-radius: 8px;
    }

    /* 3. èœå•å¼¹å‡ºä½ç½®ä¹Ÿè¦ç›¸åº”ä¸‹ç§»ï¼Œé˜²æ­¢æŒ¡ä½å¯¼èˆªæ  */
    #nav-menu {
        top: 70px !important;
    }

    /* 4. å…¨å®½ä¸‹æ‹‰èœå• */
    .mobile-menu-overlay {
        display: none; /* JS æ§åˆ¶ flex */
        position: fixed; top: var(--navbar-height); left: 0;
        width: 100%; height: auto;
        background: rgba(20, 20, 20, 0.95);
        backdrop-filter: blur(10px);
        flex-direction: column;
        border-bottom: 2px solid #444;
        box-shadow: 0 10px 30px rgba(0,0,0,1);
        z-index: 1999;
        padding-bottom: 10px;
    }
    .mobile-menu-overlay.open { display: flex; animation: slideDown 0.3s ease; }

    /* æ‰‹æœºèœå•é¡¹ */
    .m-nav-item {
        padding: 15px 20px;
        border-bottom: 1px solid #333;
        color: #ccc; font-weight: bold; font-size: 14px;
        display: flex; align-items: center; gap: 10px;
    }
    .m-nav-item:hover { background: #333; color: #fff; }
    .m-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--color); }
    
    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }
}

/* ================= 2. [æ–°å¢] å›åˆ°é¡¶éƒ¨æŒ‰é’® ================= */
.back-to-top {
    position: fixed; 
    bottom: 40px; right: 40px;
    width: 80px; height: 80px;
    background: rgba(255, 255, 255, 0.37); /* åŠé€æ˜é»‘åº• */
    border: 0px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px; /* æ–¹å½¢åœ†è§’ */
    
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    z-index: 9000;
    
    opacity: 0; pointer-events: none; /* é»˜è®¤éšè— */
    transition: all 0.3s ease;
    backdrop-filter: blur(2px);
    
    
}
.back-to-top.visible { opacity: 1; pointer-events: auto; }
.back-to-top:hover { background: rgba(0, 0, 0, 0.9); border-color: #fff; }
.back-to-top svg { width: 40px; height: 40px; fill: #ffffffb9; }
/* @media (max-width: 768px) {
    .back-to-top {
        display: none !important;
    }  
} æ‰‹æœºç«¯æ˜¾ç¤ºå›åˆ°é¡¶éƒ¨æŒ‰é’®*/

/* é’ˆå¯¹æ‰‹æœºç«¯çš„æ ·å¼è°ƒæ•´ */
@media (max-width: 768px) {
    .back-to-top {
        /* 1. è°ƒæ•´ä½ç½®ï¼šè·ç¦»è¾¹ç¼˜æ›´è¿‘ä¸€äº› */
        bottom: 25px; 
        right: 25px;
        
        /* 2. ç¼©å°å°ºå¯¸ï¼š80px åœ¨æ‰‹æœºä¸Šå¤ªå¤§äº†ï¼Œå»ºè®® 45-50px */
        width: 50px; 
        height: 50px;
        
        /* 3. è°ƒæ•´åœ†è§’ï¼šæŒ‰æ¯”ä¾‹ç¼©å° */
        border-radius: 8px; 
        
        /* 4. é’ˆå¯¹ iOS åº•éƒ¨æ¨ªæ¡çš„å®‰å…¨åŒºåŸŸé€‚é…ï¼ˆå¯é€‰ï¼‰ */
        bottom: calc(20px + env(safe-area-inset-bottom));
        
        /* 5. ç»ç’ƒæ‹Ÿæ€å¢å¼ºï¼šæ‰‹æœºä¸ŠèƒŒæ™¯å¯ä»¥ç¨å¾®æ·±ä¸€ç‚¹ï¼Œæ–¹ä¾¿çœ‹æ¸… */
        background: rgba(0, 0, 0, 0.5); 
    }

    /* 6. åŒæ—¶ç¼©å°å†…éƒ¨å›¾æ ‡çš„å¤§å° */
    .back-to-top svg {
        width: 24px; 
        height: 24px;
        fill: #ffffff; /* æ‰‹æœºç«¯çº¯ç™½é€šå¸¸å¯¹æ¯”åº¦æ›´å¥½ */
    }
    
    /* 7. æ‰‹æœºç«¯é€šå¸¸æ²¡æœ‰ hover æ€ï¼Œå¯ä»¥å–æ¶ˆæˆ–ç®€åŒ– hover æ•ˆæœ */
    .back-to-top:hover {
        background: rgba(0, 0, 0, 0.7);
    }
}
/* ================= 2. [ä¿®æ­£] ä¸»è§†å›¾åŒºåŸŸ (ç»å¯¹å®šä½ç‰ˆ) ================= */
.main-view {
    /* ç»å¯¹å®šä½ï¼Œæ’‘æ»¡é™¤å¯¼èˆªæ ä»¥å¤–çš„åŒºåŸŸ */
    position: absolute;
    top: var(--navbar-height); /* 60px æˆ– 30px */
    bottom: 0;
    left: 0;
    right: 0;
    
    /* ã€æ ¸å¿ƒä¿®å¤ã€‘èƒŒæ™¯é€æ˜ï¼ä¸è¦è®¾ä¸ºé»‘è‰²ï¼Œå¦åˆ™ä¼šæŒ¡ä½å­é¡µé¢çš„èƒŒæ™¯å›¾ */
    background: transparent; 
    
    /* å¸ƒå±€ */
    display: flex;
    flex-direction: column;
    overflow: hidden; /* è¿™é‡Œä¹Ÿä¸è¦æ»š */
}


/* === [åˆå¹¶ä¿®å¤ç‰ˆ] é€šç”¨é¡µé¢å®¹å™¨æ ·å¼ === */
.view-section { 
    display: none;       /* é»˜è®¤éšè— */
    width: 100%; 
    height: 100%;        /* æ’‘æ»¡ main-view */
    
    /* ã€æ ¸å¿ƒä¿®å¤ã€‘æ»šåŠ¨æ¡åŠ åœ¨è¿™é‡Œï¼ */
    overflow-y: auto;    
    overflow-x: hidden;  
    -webkit-overflow-scrolling: touch; /* iOS ä¸æ»‘æ»šåŠ¨ */

    /* é»˜è®¤èƒŒæ™¯ (å¦‚æœä¸ªåˆ«é¡µé¢æ²¡è®¾èƒŒæ™¯ï¼Œå°±ç”¨è¿™ä¸ª) */
    background-color: #353535;
    background-image: radial-gradient(var(--bqv-dot-color) var(--bqv-dot-size), transparent var(--bqv-dot-size));
    background-size: var(--bqv-dot-gap) var(--bqv-dot-gap);
/* ã€æ–°å¢ã€‘å¼€å¯å®¹å™¨å†…çš„å¹³æ»‘æ»šåŠ¨æ•ˆæœ */
    scroll-behavior: smooth;
}

/* æ¿€æ´»çš„é¡µé¢æ˜¾ç¤ºå‡ºæ¥ */
.view-section.active { 
    display: flex; 
    flex-direction: column;
}

        /* ================= 3. æ—¶é—´è½´è§†å›¾æ ·å¼ ================= */
        
        /* é¡¶éƒ¨å›ºå®šå®¹å™¨ */
        .top-fixed-wrapper {
            background: #111; z-index: 1000; flex-shrink: 0;
            border-bottom: 2px solid #808080; width: 100%;
        }

        /* å›¾ä¾‹æ  */
        .legend-bar {
            width: 100%; padding: 10px 20px; display: flex; gap: 25px; font-size: 12px; align-items: center;
        }
        .legend-group { display: flex; align-items: center; gap: 8px; border-right: 1px solid #444; padding-right: 15px; }
        .legend-group:last-child { border: none; }
        .legend-label { font-weight: bold; color: #aaa; margin-right: 5px; }
        .dot { width: 10px; height: 10px; border-radius: 2px; display: inline-block; border: 1px solid #555; }
        
        .bg-yan { background: var(--c-yan); } .bg-yu { background: var(--c-yu); }
        .bg-kid { background: var(--c-kid); } .bg-hei { background: var(--c-hei); }
        .bg-piao { background: var(--c-piao); } .bg-npc { background: #333; border-color: #666; }
        .bg-sb { background: var(--g-strawberry); } .bg-wc { background: var(--g-wildcat); }

        /* è¡¨å¤´ */
        .header-row {
            width: 100%; display: grid;
            grid-template-columns: var(--time-col-width) 1fr 1fr 1fr; height: 45px;
        }
        .h-cell {
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; font-size: 13px; letter-spacing: 1px;
            border-right: 1px solid rgba(0,0,0,0.5);
        }
        .h-real { background: var(--bg-real); color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
        .h-park { background: var(--bg-park); color: #ddd; }
        .h-banqiu { background: var(--bg-banqiu); color: #fff; }

        /* è§†å£å®¹å™¨ (å›ºå®šèƒŒæ™¯çš„æ ¸å¿ƒ) */
        .viewport-container {
            flex-grow: 1; position: relative; overflow: hidden; width: 100%; background: #000;
        }

        /* é™æ€èƒŒæ™¯å±‚ */
        .static-background {
            position: absolute; top: 0; bottom: 0; width: 100%;
            display: grid; grid-template-columns: var(--time-col-width) 1fr 1fr 1fr;
            z-index: 0; pointer-events: none;
        }
        .bg-col { height: 100%; border-right: 2px solid #000; }
        .bg-col-real { grid-column: 2; background-color: var(--bg-real); }
        .bg-col-park {
            grid-column: 3; background-color: var(--bg-park);
            background-image: linear-gradient(var(--grid-color) 1px, transparent 1px), linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: var(--grid-size) var(--grid-size);
        }
        .bg-col-banqiu {
            grid-column: 4; background-color: var(--bg-banqiu);
            background-image: linear-gradient(var(--grid-color) 1px, transparent 1px), linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: var(--grid-size) var(--grid-size);
        }

        /* æ»šåŠ¨å†…å®¹å±‚ */
        .scrolling-content {
            position: absolute; inset: 0; overflow-y: auto; overflow-x: hidden; z-index: 1;
        }
        .scrolling-content::-webkit-scrollbar { width: 8px; background: #111; }
        .scrolling-content::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }

        /* å†…å®¹ç½‘æ ¼ */
        .timeline-grid { width: 100%; display: grid; grid-template-columns: var(--time-col-width) 1fr 1fr 1fr; }

        /* ç« èŠ‚æ¡ */
        .chapter-bar {
            grid-column: 1 / -1; background: linear-gradient(180deg, #111, #000);
            color: #fff; padding: 15px; text-align: center;
            font-weight: bold; letter-spacing: 4px; font-size: 16px;
            border-top: 2px solid #555; border-bottom: 2px solid #000;
            position: sticky; top: 0; z-index: 100; box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        /* å•å…ƒæ ¼ */
        .row-group { display: contents; }
        .time-cell {
            padding: 20px 5px; text-align: center; background: #000000; color: #ffffff; font-size: 13px; font-weight: bold;
            border-bottom: 1px dashed #333; border-right: 1px solid #444;
            display: flex; flex-direction: column; justify-content: center;
        }
        .event-cell {
            padding: 20px; border-bottom: 1px dashed rgba(255,255,255,0.1);
            display: flex; flex-direction: column; gap: 15px;
        }

        /* äº‹ä»¶å¡ç‰‡ */
        .card {
            width: 100%; background: #242424; border: 1px solid #555;
            border-left-width: 6px; border-left-style: solid; border-radius: 4px; padding: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); cursor: pointer; transition: transform 0.2s; position: relative;
        }
        .card:hover { transform: translateY(-3px); background: #444; border-color: #999; z-index: 20; box-shadow: 0 8px 20px rgba(0,0,0,0.6); }
        .c-time {
            font-family: "Consolas", monospace; font-size: 11px; color: #bbb;
            background: rgba(0, 0, 0, 0.226); padding: 2px 6px; border-radius: 3px;
            display: inline-block; margin-bottom: 8px;
        }
        .c-title { font-size: 15px; font-weight: bold; color: #fff; margin-bottom: 6px; display: block; }
        .c-desc-preview { font-size: 13px; color: #bbb; line-height: 1.5; }

        /* å¡ç‰‡è¾¹æ¡†è‰² */
        .bd-yu { border-left-color: var(--c-yu); } .bd-kid { border-left-color: var(--c-kid); }
        .bd-hei { border-left-color: var(--c-hei); } .bd-yan { border-left-color: var(--c-yan); }
        .bd-piao { border-left-color: var(--c-piao); } .bd-npc { border-left-color: #000; border-left-width: 6px; }
        .bd-sb { border-left: 6px solid transparent; border-image: var(--g-strawberry) 1; }
        .bd-wc { border-left: 6px solid transparent; border-image: var(--g-wildcat) 1; }

        /* ================= 4. è§„åˆ™è§†å›¾æ ·å¼ (å®Œæ•´åˆå¹¶) ================= */
        .rules-wrapper {
            padding: 40px; background: #353535; min-height: 100%; flex-grow: 1; overflow-y: auto;
            color: #eee; font-family: "Microsoft YaHei", sans-serif;
            background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: var(--grid-size) var(--grid-size); display: flex; flex-direction: column; align-items: center;
        }
        .rules-wrapper::-webkit-scrollbar { width: 8px; background: #111; }
        .rules-wrapper::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }

        .rule-section {
            width: 100%; max-width: 1000px; margin-bottom: 60px;
            background: #666; border: 3px solid hsl(0, 0%, 71%); padding: 30px; border-radius: 10px;
            position: relative;
        }
        .rule-header {
            font-size: 24px; font-weight: 900; color: #fff; margin-bottom: 20px;
            border-left: 5px solid var(--c-yu); padding-left: 15px;
        }
        .chapter-summary {
            background: #252525; padding: 15px; border-radius: 4px; margin-bottom: 30px;
            font-size: 14px; color: #aaa; line-height: 1.6; border-left: 2px solid #555;
        }
        .chapter-summary strong { color: #fff; }

        /* æ¬¢è¿ä¾¿ç­¾ */
        .intro-section { display: flex; justify-content: center; margin-bottom: 40px; width: 100%; }
        .sticky-note {
            background: #f7e779; color: #222; padding: 30px; width: 80%; max-width: 600px;
            transform: rotate(-1deg); box-shadow: 5px 5px 15px rgba(0,0,0,0.5); position: relative;
            font-family: "KaiTi", "SimKai", serif; font-size: 16px; line-height: 1.6; font-weight: bold;
        }

        /* éšè—è§„åˆ™ç»Ÿä¸€æ ·å¼ */
        .hidden-rule-style {
            background-color: var(--bg-hidden) !important;
            border: 2px dashed var(--c-rule-hidden) !important;
            position: relative; border-radius: 6px;
        }
        .hidden-stamp {
            position: absolute; top: 0; right: 0; 
            background: var(--c-rule-hidden); color: #000;
            font-size: 10px; font-weight: 900; padding: 2px 6px;
            border-bottom-left-radius: 4px;
        }
        .hidden-text { color: var(--c-rule-hidden); }

        /* è·èƒœè·¯å¾„ */
        .victory-wrapper { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .path-box { background: #222; border: 1px solid #444; padding: 20px; border-radius: 6px; position: relative;}
        .path-header { text-align: center; font-weight: bold; margin-bottom: 20px; color: #ccc; font-size: 16px; }
        
        .flow-chart { display: flex; flex-direction: column; align-items: center; }
        .flow-step { background: #333; padding: 10px 15px; border-radius: 4px; font-size: 13px; width: 100%; text-align: center; margin-bottom: 5px; }
        .flow-step.final { background: #eee; color: #000; font-weight: bold; }
        .flow-step.secret { background: transparent; border: 1px solid var(--c-rule-hidden); color: var(--c-rule-hidden); }
        .flow-step.secret.final { background: var(--c-rule-hidden); color: #000; border: none; }
        .flow-arrow { color: #555; font-size: 18px; margin: 2px 0; }
        .rule-note { font-size: 12px; color: #666; margin-top: 10px; font-style: italic; }

        /* æ–‘ä¸˜å¡è¡¨æ ¼ */
/* === [ä¿®å¤ç‰ˆ] æ–‘ä¸˜å¡è¡¨æ ¼æ ·å¼ === */
        /* === æ–°å¢ï¼šå¡ç‰Œå·¦ä¾§å›¾é‰´æ ·å¼ (å›¾ç‰‡+å½©æ¡†) === */
        
        /* 1. å¡ç‰Œå•å…ƒå®¹å™¨ */
        .card-type-unit {
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 6px;
            width: 60px;    /* å›ºå®šå®½åº¦ */
            flex-shrink: 0; /* ã€å…³é”®ã€‘é“å¸ƒè¡«ï¼šç¦æ­¢è¢«æŒ¤å‹å˜å½¢ */
        }

        /* 2. å›¾ç‰‡æ¡† */
        .card-img-box {
            width: 60px; height: 60px;
            background: #22222200; 
            border: 0px solid #444;
            border-radius: 4px;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
            color: #555; font-size: 10px;
        }
        /* æ–‘ä¸˜å¡å›¾ç‰‡é€‚é… - ç¼©æ”¾ä¿®æ­£ç‰ˆ */
        .card-img-box img { 
            /* 1. æ§åˆ¶å¤§å°ï¼šæ”¹æˆ 70% (æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è¿™ä¸ªæ•°å­—) */
            width: 83.333%; 
            height: 83.333%; 
            
            /* 2. æ˜¾ç¤ºæ¨¡å¼ï¼šå®Œæ•´æ˜¾ç¤ºå›¾ç‰‡ï¼Œä¸è£å‰ª */
            object-fit: contain; 
            
            /* 3. ä¿æŒå—çº§æ˜¾ç¤º */
            display: block; 
            
            /* æ³¨æ„ï¼šæ— éœ€å†™å±…ä¸­ä»£ç ï¼Œçˆ¶å®¹å™¨å·²ç»å¸®æ‚¨å±…ä¸­äº† */
        }

        /* 3. æ–‡å­—æ ‡ç­¾æ¡† (å¸¦é¢œè‰²) */
        .card-label-box {
            --tag-bg: #444; /* é»˜è®¤é¢œè‰²å˜é‡ */
            background-color: var(--tag-bg);
            color: #fff;
            font-size: 12px; font-weight: bold;
            padding: 2px 0; width: 100%; text-align: center;
            border-radius: 3px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* éšè—è§„åˆ™ç‰¹æ®Šé€‚é… */
        .hidden-rule-style .card-img-box {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.3);
        }
        /* 1. è¡¨å¤´å®¹å™¨ */
        .card-table-header {
            display: flex; 
            background: #1e1e1e; 
            border-top-left-radius: 4px; border-top-right-radius: 4px;
            border: 1px solid #333; border-bottom: none;
            font-weight: bold; font-size: 13px; color: #ccc;
        }

        /* 2. å†…å®¹è¡Œå®¹å™¨ */
        .card-row {
            display: flex; align-items: stretch; 
            border: 1px solid #1e1e1e; border-top: none;
            background: #777; transition: 0.2s;
            min-height: 60px; /* ç»™ä¸ªæœ€å°é«˜åº¦ */
        }
        .card-row:hover { background: #2a2a2a; }
        .card-row.hidden-rule-style { margin-top: 15px; border-top: 2px dashed var(--c-rule-hidden); }

        /* === åˆ—å®½æ§åˆ¶ç³»ç»Ÿ (è¡¨å¤´å’Œå†…å®¹å…±ç”¨) === */
        
        /* ç¬¬ä¸€åˆ—ï¼šå›¾æ ‡/ç±»å‹ (å›ºå®šå®½åº¦ 90px) */
        .col-icon-fixed {
            width: 90px; flex-shrink: 0;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-right: 1px solid #444; 
            padding: 4px; background: #1e1e1e;
            text-align: center;
        }
        /* è¡¨å¤´çš„ç¬¬ä¸€åˆ—ä¸éœ€è¦èƒŒæ™¯è‰²ï¼Œå¾®è°ƒä¸€ä¸‹ */
        .card-table-header .col-icon-fixed { background: transparent; }
        /* éšè—è§„åˆ™çš„ç¬¬ä¸€åˆ—èƒŒæ™¯é€æ˜ */
        .hidden-rule-style .col-icon-fixed { background: transparent; border-right: 1px dashed var(--c-rule-hidden); }

        /* å³ä¾§æ•°æ®åŒº (å¼¹æ€§å®¹å™¨) */
        .col-data-flex {
            flex: 1; display: flex; 
            /* å…³é”®ï¼šè¿™é‡Œä¸èƒ½æœ‰ paddingï¼Œå¦åˆ™ä¼šå¯¹ä¸é½ */
        }

        /* æ•°æ®åˆ—æ¯”ä¾‹ (Headerå’ŒBodyéƒ½ç”¨è¿™ä¸ª) */
        .c-1  { flex: 1.2; } /* è·å–æ–¹å¼ */
        .c-2  { flex: 2; }   /* åŠŸèƒ½ */
        .c-3  { flex: 0.8; } /* æ¬¡æ•° */
        .c-4  { flex: 0.8; } /* å„æ–­ */
        .c-5  { flex: 0.8; } /* äº¤æ¢ */

        /* å•å…ƒæ ¼é€šç”¨æ ·å¼ */
        .cell-common {
            padding: 8px 5px; 
            display: flex; align-items: center; justify-content: center; text-align: center;
            border-right: 1px dashed #333;
            font-size: 12px; color: #ffffff;
            word-break: break-word; /* é˜²æ­¢æ–‡å­—æ’‘å¼€ */
        }
        /* è¡¨å¤´çš„å•å…ƒæ ¼è¾¹æ¡†æ˜¯å®çº¿ */
        .card-table-header .cell-common { border-right: 1px solid #444; color: #fff; }
        .cell-common:last-child { border-right: none; }
        
        /* éšè—è§„åˆ™çš„è¾¹æ¡† */
        .hidden-rule-style .cell-common { border-right: 1px dashed #5a1a2a; color: #dcb; }

        /* çŠ¶æ€è‰² */
        .yes { color: #00FF7F; } 
        .no { color: #a1a1a1; } 
        .warn { color: #ffcc00; }

        /* å›¾æ ‡å¾®è°ƒ */
        .entity-icon { font-size: 24px; margin-bottom: 5px; }
        .entity-name { font-size: 12px; font-weight: bold; }        .card-data-area { flex: 1; display: flex; align-items: center; padding: 0 10px; }
        .cd-cell { padding: 8px 5px; font-size: 13px; color: #aaa; text-align: center; flex: 1; border-right: 1px dashed #333; }
        .cd-cell:last-child { border-right: none; }
        .hidden-rule-style .cd-cell { border-right: 1px dashed #5a1a2a; color: #dcb; }

        .cd-cell.yes { color: #00FF7F; } .cd-cell.no { color: #666; } .cd-cell.warn { color: #ffcc00; }
        .table-footer-note { margin-top: 10px; font-size: 12px; color: #888; background: #222; padding: 8px; border-left: 3px solid #ffcc00; }

/* === 4. å±æ€§é‡‘å­—å¡” (å›¾é‰´ç‰ˆ - æœ€ç»ˆä¿®æ­£) === */
        .attr-pyramid-container { 
            display: flex; flex-direction: column; align-items: center; gap: 25px; 
        }
        
        .attr-row { 
            display: flex; gap: 12px; justify-content: center; width: 100%; flex-wrap: wrap;
        }
        
        .attr-tier-label { 
            font-size: 12px; color: #666; margin-bottom: 5px; width: 100%; 
            text-align: center; border-bottom: 1px solid #333; padding-bottom: 2px; 
        }

        /* å•ä¸ªå±æ€§å•å…ƒ (åŒ…è£¹å›¾ç‰‡å’Œæ ‡ç­¾) */
        .attr-unit {
            display: flex; flex-direction: column; align-items: center; gap: 6px;
            width: 60px; /* æ§åˆ¶æ•´ä½“å®½åº¦ */
            flex-shrink: 0; /* ã€å…³é”®ã€‘é“å¸ƒè¡«ï¼šç¦æ­¢è¢«æŒ¤å‹å˜å½¢ */
            position: relative;
        }

        /* 1. ä¸Šæ–¹çš„æ­£æ–¹å½¢å›¾ç‰‡ä½ */
        .attr-img-box {
            width: 60px; height: 60px;
            background: #222; 
            border: 1px solid #444;
            border-radius: 4px;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; /* å›¾ç‰‡å¤ªå¤§æ—¶è‡ªåŠ¨åˆ‡è¾¹ */
        }
        
        /* å›¾ç‰‡æœ¬èº« - ç¼©æ”¾ä¿®æ­£ç‰ˆ */
        .attr-img-box img {
            /* 1. æ§åˆ¶å¤§å°ï¼šè¿™é‡Œæ”¹ç™¾åˆ†æ¯” (ä¾‹å¦‚ 70% æˆ– 80%) */
            width: 90%;  
            height: 90%; 
            
            /* 2. æ˜¾ç¤ºæ¨¡å¼ï¼šcontain è¡¨ç¤º"å›¾ç‰‡å®Œæ•´æ˜¾ç¤º"ï¼Œcover è¡¨ç¤º"å¡«æ»¡è£å‰ª" */
            object-fit: contain; 
            
            /* 3. å…¶å®ƒä¿æŒä¸å˜ */
            display: block;
            
            /* æ³¨æ„ï¼šæ— éœ€å†™å±…ä¸­ä»£ç ï¼Œå› ä¸ºçˆ¶å®¹å™¨(.attr-img-box)å·²ç»å¸®æ‚¨å±…ä¸­äº† */
        }

        /* 2. ä¸‹æ–¹çš„å®å¿ƒåç§°æ¡† */
        .attr-label-box {
            /* é»˜è®¤é¢œè‰²å˜é‡ï¼ŒHTMLé‡Œå¯å•ç‹¬æ”¹ */
            --tag-bg: #444; 
            background-color: var(--tag-bg);
            color: #fff;
            font-size: 12px; font-weight: bold;
            padding: 2px 0; width: 100%; text-align: center;
            border-radius: 3px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }

/* === ç‰¹æ®Šæ ·å¼é€‚é… (é¢œè‰²å·²æ ¹æ®å›¾ç‰‡æ ¡å‡†) === */
        
        /* éšè—å±æ€§çš„å®¹å™¨ */
        .hidden-attr-container {
            width: 100%; padding: 20px; 
            display: flex; flex-direction: column; align-items: center; gap: 15px;
            margin-top: 10px;
        }
        
        /* éšè—å±æ€§çš„å‘å…‰å›¾ç‰‡æ¡† */
        .attr-unit.special .attr-img-box {
            background: transparent; /* é€æ˜åº• */
            border-color: rgba(255,255,255,0.5);
        }
        
        /* å…‰ (å›¾ç‰‡è‰²ï¼šäº®é»„ #F8E71C) */
        .attr-unit.light .attr-img-box { box-shadow: 0 0 15px #F8E71C; border-color: #F8E71C; }
        .attr-unit.light .attr-label-box { background-color: #F8E71C; color: #000; text-shadow: none; }
        
        /* æ˜Ÿ (å›¾ç‰‡è‰²ï¼šç²‰çº¢ #FF69B4) */
        .attr-unit.star .attr-img-box { box-shadow: 0 0 15px #FF69B4; border-color: #FF69B4; }
        .attr-unit.star .attr-label-box { background-color: #FF69B4; color: #000; text-shadow: none; }
        
        /* æ³¢ (å›¾ç‰‡è‰²ï¼šé’ç»¿ #00E0C0) */
        .attr-unit.wave .attr-img-box { 
            box-shadow: 0 0 20px #00E0C0; 
            border-color: #00E0C0; 
            background: rgba(0, 224, 192, 0.1); 
        }
        .attr-unit.wave .attr-label-box { background-color: #00E0C0; color: #000; text-shadow: none; }        
        .attr-unit.wave .attr-label-box { background-color: #fff; color: #000; text-shadow: none; }

        .divider-glitch { width: 100%; text-align: center; color: var(--c-rule-hidden); font-size: 12px; margin: 15px 0; opacity: 0.8; letter-spacing: 1px; }        /* ç¤¾å›¢ä¸æˆ˜æ–— */
        .club-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;}
        .rule-block { background: #222; border: 1px solid #444; padding: 20px; border-radius: 6px; }
        .rule-block.attention { grid-column: 1 / -1; border-color: #ffcc00; background: rgba(255, 204, 0, 0.05); display: flex; flex-direction: column; }
        .rule-title { font-size: 15px; font-weight: bold; color: #fff; margin-bottom: 10px; border-bottom: 1px solid #444; padding-bottom: 5px; }
        .rule-list li { margin-bottom: 8px; font-size: 13px; color: #ccc; list-style: none; padding-left: 15px; position: relative; }
        .rule-list li::before { content: 'â€¢'; position: absolute; left: 0; color: #666; }
        
        .reward-row { display: flex; gap: 20px; font-size: 13px; color: #ccc; flex-wrap: wrap; }
        .reward-item { flex: 1; min-width: 200px; }
        .reward-item strong { color: #ffcc00; display: block; margin-bottom: 3px; }

        .battle-flex { display: flex; flex-wrap: wrap; gap: 15px; }
        .battle-card { flex: 1; min-width: 150px; background: #252525; padding: 15px; border-radius: 4px; border-left: 3px solid #666; }
        .battle-card.special { border-left-color: var(--c-hei); background: #1a2a2a; }
        .bt-title { font-weight: bold; color: #fff; margin-bottom: 5px; font-size: 14px; }
        .bt-desc { font-size: 12px; color: #aaa; line-height: 1.4; }

        /* ================= 5. æ‚¬æµ®çª—æ ·å¼ ================= */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            /* ğŸ‘‡ æ§åˆ¶æš—åŒ–ç¨‹åº¦ï¼šä¿®æ”¹è¿™é‡Œçš„  */
            background: rgba(70,70,70,0.7); 
            /* ğŸ‘‡ æ§åˆ¶æ¨¡ç³Šç¨‹åº¦ï¼šä¿®æ”¹è¿™é‡Œçš„ 5px */
            backdrop-filter: blur(5px);
            z-index: 3000; display: none; align-items: center; justify-content: center;
        }
    /* =========================================
    [ä¿®æ”¹] æ—¶é—´çº¿è¯¦æƒ…æµ®çª—ï¼šçº¯æ–‡å­—å±…ä¸­ç‰ˆ
    ========================================= */

/* 1. å¸ƒå±€æ”¹ä¸ºå•åˆ—ï¼Œå»æ‰åŸæ¥çš„ 350px å›¾ç‰‡åˆ— */
.modal-window {
    grid-template-columns: 1fr !important;
    /* ä¿æŒåŸå®½åº¦ 800px ä¸å˜ */
    border: 4px solid #666;
}

/* 2. å½»åº•éšè—å·¦ä¾§å›¾ç‰‡å®¹å™¨ */
.m-left {
    display: none !important;
}

/* 3. æ”¹é€ å³ä¾§å®¹å™¨ï¼šè®©å®ƒå æ»¡æ•´ä¸ªå¡ç‰‡ */
.m-right {
    width: 100%;
    height: 100%;
    padding: 40px 60px; /* å¢åŠ å·¦å³ç•™ç™½ï¼Œæ˜¾å¾—æ›´ç²¾è‡´ */
    
    /* å¼€å¯ Flex å¸ƒå±€æ–¹ä¾¿å±…ä¸­ */
    display: flex;
    flex-direction: column;
    align-items: center; /* æ°´å¹³å±…ä¸­æ ¸å¿ƒ */
}

/* 4. æ—¶é—´ä¸æ ‡é¢˜ï¼šå¼ºåˆ¶å±…ä¸­ */
.m-time {
    text-align: center !important;
    width: 100%;
    
    /* å¼ºåŒ–ä¸­é—´åˆ†å‰²çº¿ï¼šè®©å®ƒçœ‹èµ·æ¥æ›´åƒä¸€æ¡åˆ†ç•Œçº¿ */
    border-bottom: 2px solid #444 !important; 
    margin-bottom: 25px !important;
}

.m-title {
    text-align: center !important;
    width: 100%;
    margin-bottom: 30px !important; /* æ ‡é¢˜å’Œæ­£æ–‡æ‹‰å¼€è·ç¦» */
}

/* 5. ä¸»æ–‡å†…å®¹ï¼šä¸Šä¸‹å·¦å³ç»å¯¹å±…ä¸­ */
.m-desc {
    /* å æ»¡å‰©ä½™çš„æ‰€æœ‰å‚ç›´ç©ºé—´ */
    flex-grow: 1;
    width: 100%;
    
    /* æ–‡å­—æ’ç‰ˆï¼šå±…ä¸­ */
    text-align: center !important;
    
    /* å‚ç›´å±…ä¸­æ ¸å¿ƒç»„åˆ */
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important; /* ä¸Šä¸‹å±…ä¸­ */
    align-items: center !important;     /* å·¦å³å±…ä¸­ */
    
    /* å­—ä½“å¾®è°ƒï¼šç¨å¾®å¤§ä¸€ç‚¹ç‚¹ï¼Œæ›´æœ‰è´¨æ„Ÿ */
    font-size: 16px !important;
    padding: 0 20px; /* é˜²æ­¢æ–‡å­—è´´è¾¹ */
}
/* === [ä¿®å¤] æµ®çª—å³ä¾§æ–‡å­—åŒº === */
    .m-right { 
        padding: 40px 30px; 
        display: flex; 
        flex-direction: column; 
        background: #1a1a1a; 
        
        /* å…³é”®ä¿®æ”¹ 1: å¼ºåˆ¶é«˜åº¦å æ»¡ï¼Œå¹¶ç¦æ­¢æº¢å‡ºï¼Œé˜²æ­¢æŠŠå·¦è¾¹å›¾ç‰‡æŒ¤è·‘ */
        height: 100%; 
        overflow: hidden; 
        position: relative;
    }
    
    .m-time { 
        font-family: monospace; font-size: 14px; color: #888; 
        border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 15px; 
        flex-shrink: 0; /* é˜²æ­¢æ—¶é—´è¢«å‹ç¼© */
    }
    
    .m-title { 
        font-size: 26px; font-weight: bold; color: #fff; margin-bottom: 20px; 
        flex-shrink: 0; /* é˜²æ­¢æ ‡é¢˜è¢«å‹ç¼© */
    }
    
    /* é‚£ä¸ªéœ€è¦æ»šåŠ¨çš„æ–‡å­—åŒºåŸŸï¼Œè‹±æ–‡åå« .m-desc */
    .m-desc { 
        flex-grow: 1;        /* å æ»¡å‰©ä¸‹çš„æ‰€æœ‰ç©ºé—´ */
        overflow-y: auto;    /* å¼€å¯å‚ç›´æ»šåŠ¨æ¡ */
        min-height: 0;       /* å…³é”®ä¿®æ”¹ 2: å…è®¸ flex å­é¡¹æ”¶ç¼©ï¼Œè¿™æ˜¯æ»šåŠ¨ç”Ÿæ•ˆçš„å‰æ */
        
        color: #ccc; 
        line-height: 1.8; 
        font-size: 15px; 
        text-align: justify; 
        padding-right: 10px; /* ç»™æ»šåŠ¨æ¡ç•™ç‚¹ä½ç½® */
    }
    
    /* æ»šåŠ¨æ¡æ ·å¼ç¾åŒ– */
    .m-desc::-webkit-scrollbar { width: 6px; }
    .m-desc::-webkit-scrollbar-track { background: #222; }
    .m-desc::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }
    .m-desc::-webkit-scrollbar-thumb:hover { background: #777; }        
    .m-desc { flex-grow: 1; overflow-y: auto; color: #ccc; line-height: 1.8; font-size: 15px; text-align: justify; padding-right: 10px; }
    .m-desc::-webkit-scrollbar { width: 6px; }
    .m-desc::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }



    
    /* æ¿€æ´»çŠ¶æ€ (JSæ§åˆ¶æ˜¾ç¤º) */
    .view-section.active { 
        display: flex; 
    }

    /* é¢„ç•™ä½ç½®çš„è™šçº¿æ¡†æ ·å¼ */
    .paste-zone {
        margin: 50px auto;
        padding: 80px;
        max-width: 800px;
        border: 2px dashed #333;
        border-radius: 10px;
        background: #111;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }
    .paste-zone h2 { color: #fff; margin: 0; }
    .paste-zone p { color: #888; margin: 0; }

        /* ä¸»å®¹å™¨ */
        /* [ä¿®å¤] æ¡£æ¡ˆä¸»å®¹å™¨ï¼šè§£æ”¾å®½åº¦ï¼Œå…è®¸é“ºæ»¡å±å¹• */
        .archive-container {
            /* åŸæ¥æ˜¯ max-width: 1400px; ç°åœ¨æ”¹ä¸º 95% æˆ– 100% */
            max-width: 85%; 
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 50px;
            width: 100%;
            padding: 40px;
            box-sizing: border-box; /* ç¡®ä¿paddingä¸ä¼šæ’‘ç ´å±å¹• */
        }
/* [ä¿®æ”¹] äººç‰©æ¡£æ¡ˆèƒŒæ™¯ï¼šåŒæ­¥è§„åˆ™é¡µæ ·å¼ */
        #view-chars {
background-color: #353535;
    background-image: radial-gradient(var(--bqv-dot-color) var(--bqv-dot-size), transparent var(--bqv-dot-size));
    background-size: var(--bqv-dot-gap) var(--bqv-dot-gap);
    scroll-behavior: smooth;
        }
        /* === åˆ†å‰²çº¿ === */
        .section-header {
            display: flex; align-items: center; gap: 20px; margin-bottom: 10px;
        }
        .section-title {
            font-size: 24px; font-weight: 900; color: #fff; letter-spacing: 2px; text-transform: uppercase;
            background: #1a1a1a; padding: 10px 30px; border: 1px solid #444; border-radius: 4px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .section-line { height: 2px; background: #888; flex-grow: 1; }

/* --- æ™®é€šç¤¾å›¢å’Œç®¡ç†ç¤¾å›¢ä¿æŒåŸæ¥çš„ç½‘æ ¼å¸ƒå±€ --- */
.society-grid {
    display: grid; 
    grid-template-columns: repeat(3, 1fr); 
/* é€™è£¡åªç•™å·¦å³é–“è·ï¼Œä¸Šä¸‹é–“è·äº¤çµ¦å…§éƒ¨çš„ .society-card æ§åˆ¶ */
    column-gap: 25px; 
    row-gap: 0; 
    width: 100%;
}

/* --- ã€æ ¸å¿ƒä¿®æ”¹ã€‘åªè®©â€œå“ˆå°¼ç¤¾å›¢â€è¿™ä¸€ç»„å˜æˆç€‘å¸ƒæµæ’å¸ƒ --- */
#group-HANI .society-grid {
    display: block !important; /* å…³æ‰ Gridï¼Œå¼€å¯ Column æ¨¡å¼å®ç°ç€‘å¸ƒæµ */
    column-count: 3;           /* ç”µè„‘ç«¯åˆ†ä¸º 3 åˆ— */
    column-gap: 25px;          /* å·¦å³é—´è· */
}

/* --- é€šç”¨çš„ç¤¾å›¢å¡ç‰‡åŸºç¡€æ ·å¼ --- */
.society-card {
    background: var(--bg-card);

    border-radius: 8px;
    display: block;             /* æ”¹ç‚º block ç¢ºä¿ç€‘å¸ƒæµç›¸å®¹æ€§ */
    overflow: hidden;
    box-shadow: 0 5px 20px rgba(39, 39, 39, 0.3);
    
/* === çµ±ä¸€åŸå‰‡ 1ï¼šå‚ç›´é–“è·å…¨é å®ƒ === */
    margin-bottom: 25px;        
    break-inside: avoid;        /* é˜²æ­¢ç€‘å¸ƒæµåˆ‡æ–·å¡ç‰‡ */
    height: auto !important; 
}
/* --- ã€ç‰¹æƒã€‘å“ˆå°¼å“ˆå°¼ç¤¾å›¢ï¼šæ¨ªè·¨ 3 åˆ—ç‹¬å ä¸€è¡Œ --- */
#society-card-honeyhoney {    
    column-span: all !important;  /* å¼ºåˆ¶æ¨ªè·¨æ‰€æœ‰åˆ— */
    width: 100% !important;
    margin-bottom: 25px;       /* ä¸‹æ–¹ç•™ç™½ */
}

/* --- ã€æ ¸å¿ƒã€‘å“ˆå°¼å“ˆå°¼å†…éƒ¨ï¼šä¸€è¡Œ 6 äººï¼Œä¸”æ¢è¡Œåä¸Šä¸‹å¯¹é½ --- */
#society-card-honeyhoney .char-list > div {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important; /* å¼ºåˆ¶ 6 åˆ— */
    gap: 20px 60px !important;  /* ä¸Šä¸‹ 20pxï¼Œå·¦å³ 30pxï¼Œé—´è·åŠ å®½ */
}

        .society-header {
            background: #070707;
            padding: 0px;
            display: flex; align-items: center; gap: 15px;
            border-bottom: 2px solid var(--bg-card);
        }
        .society-logo {
            width: 80px; height: 80px;
            background: #00000000; border: 0px dashed #55555500;
            display: flex; align-items: center; justify-content: center;
            color: #555; font-size: 10px; flex-shrink: 0;
        }
        .society-name { font-size: 18px; font-weight: 900; color: #ffffff; letter-spacing: 1px; }

/* === åˆ—è¡¨å®¹å™¨ === */
        .char-list {
            padding: 15px;
            /* æ³¨æ„ï¼šè¿™é‡Œåªè´Ÿè´£å†…è¾¹è·ï¼Œä¸è¦åœ¨è¿™é‡Œå†™ gap */
        }

        /* è¿™æ˜¯åˆšæ‰åŠ çš„ï¼šä¸“é—¨æ§åˆ¶å¡ç‰‡é—´è· */
        .char-list > div {
            display: flex;
            flex-direction: column;
            gap: 12px; /* è¿™é‡Œä¿®æ”¹é—´è·å¤§å° */
        }

        /* === äººç‰©å¡ç‰‡ === */
        .char-card {
            background: var(--bg-char);
            border: 1px solid #333; 
            border-radius: 4px;
            display: flex; 
            
            /* å…³é”®ä¿®æ”¹ï¼šå…è®¸ç‹å† å’Œæ¤…å­çªå‡ºæ¥ */
            overflow: visible !important; 
            
            height: 100px; 
            /* [æ–°å¢] å®½åº¦ç”± Grid çˆ¶äº²å†³å®šï¼Œè‡ªå·±æ’‘æ»¡å³å¯ */
            width: 100%; 
            max-width: 100%;

            cursor: pointer; 
            
            /* å…³é”®ï¼šå¿…é¡»æœ‰è¿™ä¸ª transition æ‚¬æµ®æ‰ä¼šå¹³æ»‘ */
            transition: all 0.2s; 
            
            position: relative;
            z-index: 1; /* ä¿è¯å¡ç‰‡å±‚çº§æ­£ç¡® */
            
            border-left-width: 6px; 
            border-left-style: solid;
        }

        /* === æ‚¬æµ®æ•ˆæœï¼ˆæ‰¾å›ä¸¢å¤±çš„è¿™éƒ¨åˆ†ï¼ï¼‰ === */
/* === [ä¿®æ”¹] äººç‰©å¡æ‚¬æµ®ç‰¹æ•ˆï¼šå…‰ç¯ç‚¹äº® === */
        .char-card:hover {
            /* 1. ä½ç§»ï¼šå‘å³æµ®åŠ¨ */
            transform: translateX(5px); 
            
            /* 2. èƒŒæ™¯ï¼šç¨å¾®å˜äº®ä¸€ç‚¹çš„ç°è‰² */
            background: #414141; 
            
            /* 3. ã€æ ¸å¿ƒã€‘è¾¹æ¡†å˜è‰²ï¼šè°ƒç”¨ JS ä¼ è¿‡æ¥çš„å°è±¡è‰² */
            border-color: var(--hover-color);
            
            /* 4. ã€æ–°å¢ã€‘å…‰æ™•ç‰¹æ•ˆï¼šåŠ ä¸€å±‚æ·¡æ·¡çš„åŒè‰²é˜´å½±ï¼Œåƒéœ“è™¹ç¯ä¸€æ · */
            box-shadow: 0 0 20px var(--hover-color);
            
            /* 5. å±‚çº§æå‡ */
            z-index: 10; 
        }
                /* === 2. æ–°å¢ï¼šç‹å† è§’æ ‡æ ·å¼ === */
        .crown-badge {
            position: absolute;
            top: -13px;      /* ä½ç½®å¾®è°ƒï¼šçªå‡ºå»ä¸€ç‚¹ */
            left: -13px;
            font-size: 26px; /* å¤§å° */
            color: #FFD700;  /* äº®é»„è‰² */
            text-shadow: 3px 3px 3px rgb(0, 0, 0); /* åŠ é»‘æŠ•å½±è®©å®ƒçœ‹æ¸… */
            z-index: 20;     /* ä¿è¯åœ¨æœ€ä¸Šå±‚ */
            display: none;   /* ã€æ ¸å¿ƒã€‘é»˜è®¤éšè—ï¼åªæœ‰å¼€å¯æ‰æ˜¾ç¤º */
            transform: rotate(-30deg); /* ç¨å¾®æ­ªä¸€ç‚¹ */
        }
        
        /* å½“å¡ç‰‡æ‹¥æœ‰ 'is-king' è¿™ä¸ªç±»åæ—¶ï¼Œæ˜¾ç¤ºç‹å†  */
        .char-card.is-king .crown-badge {
            display: block;
        }
        /* === è¯¦æƒ…å¼¹çª— (å‡çº§ç‰ˆ) === */
        /* === ä¿®æ”¹ï¼šæ•°å€¼æ¡å®¹å™¨ (å¢åŠ å‘¼å¸æ„Ÿ) === */
        .stats-container {
            display: flex;
            flex-direction: column;
            gap: 10px; /* ã€æ ¸å¿ƒã€‘åŸæ¥çš„é—´è·å¤ªå°äº†ï¼Œæ”¹æˆ 20px æˆ–æ›´å¤§ï¼Œç¬é—´é€šé€ */
        }

/* 1. æ¤…å­å®¹å™¨ä½ç½® (å³ä¾§å‚ç›´å±…ä¸­) */
.chair-container {
    position: absolute;
    right: 6px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column; /* å‚ç›´æ’åˆ— */
    gap: 4px;
    z-index: 998;
    pointer-events: none;
}

/* 2. æ¤…å­å›¾æ ‡æœ¬èº« */
.chair-icon {
    /* è¿™é‡Œå¿…é¡»æ˜¯ relativeï¼Œå¦åˆ™ç¦æ­¢å›¾æ ‡ä¼šé£åˆ°å¡ç‰‡å·¦ä¸Šè§’å»ï¼ */
    position: relative !important; 
    width: 20px !important;
    height: 20px !important;
    display: flex !important;
    align-items: center;
    justify-content: center;
    overflow: visible !important; /* é˜²æ­¢è¶…å‡ºéƒ¨åˆ†è¢«åˆ‡æ‰ */
}

/* 3. ç¦æ­¢å›¾æ ‡ (çº¢æ¡†ä¿®æ­£) */
/* [å¼·åŠ›ä¿®å¾©] å¼·åˆ¶æ–œæ§“ç‚ºé»‘è‰²ï¼Œç„¡è¦–æ¤…å­é¡è‰² */
.forbidden-mark svg path {
    fill: #000000 !important; /* å¼·åˆ¶å¡«å……ç´”é»‘ */
    stroke: none !important;
}

/* å¢åŠ ç™½è‰²ç™¼å…‰æé‚Šï¼Œé˜²æ­¢åœ¨æ·±è‰²æ¤…å­ä¸Šçœ‹ä¸æ¸… */
.forbidden-mark svg {
    filter: drop-shadow(0px 0px 1px #ffffff) drop-shadow(0px 0px 1px #ffffff) !important;
    width: 100%;
    height: 100%;
}

.forbidden-mark {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    z-index: 10 !important;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}
        
        /* æ¤…å­é¢œè‰²å®šä¹‰ (SVG å¡«å……è‰²) */
        .chair-white path { fill: #f0f0f0; } /* ç™½æ¤…å­åŠ ä¸ªè¾¹æ¡†ä¸ç„¶çœ‹ä¸è§ */
        .chair-cyan path  { fill: #00ffff; }
        .chair-yellow path{ fill: #ffd700; }
        .chair-green path { fill: #32cd32; }
        .chair-rose path  { fill: #ff007f; }
        
        /* å·¦ä¾§ï¼šå›¾ç‰‡ä½ (1800:750 = 2.4:1) */
        .char-card-img {
                border: none !important; 
                border-bottom: none !important;
            width: 240px; 
            


            /* === [ä¿®æ”¹] èƒŒæ™¯çº¹ç†ï¼š45åº¦æ–œçº¿ === */

            /* 1. åº•è‰²ï¼šä¿æŒä½ åŸæ¥çš„æ·±ç°è‰² */
            background-color: #a8a8a8; 

            /* 2. çº¹ç†æ ¸å¿ƒï¼šä½¿ç”¨é‡å¤çº¿æ€§æ¸å˜ç”»æ–œçº¿ */
            /* 45deg = è§’åº¦ */
            /* rgba(255, 255, 255, 0.2) = çº¿æ¡é¢œè‰² (ç™½è‰²åŠé€æ˜) */
            /* 0px åˆ° 1px = çº¿æ¡çš„ç²—ç»† (è¿™é‡Œæ˜¯ 1px ç»†çº¿) */
            /* 1px åˆ° 8px = çº¿æ¡ä¹‹é—´çš„é€æ˜é—´è· (é—´è· 7px) */
            background-image: repeating-linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.25) 0px, 
                rgba(255, 255, 255, 0.25) 1px, 
                transparent 3px, 
                transparent 8px
            );

/* 3. æ³¨æ„ï¼šåŸæ¥çš„ background-size éœ€è¦åˆ æ‰æˆ–è€…è®¾ä¸º auto */
/* å› ä¸º repeating-linear-gradient ä¸éœ€è¦ size æ¥é‡å¤ï¼Œå®ƒè‡ªå·±ä¼šé“ºæ»¡ */
background-size: auto;
            /* === [ç»“æŸ] === */

            border-right: 1px solid #333;
            display: flex; align-items: center; justify-content: center;
            color: #444; font-size: 10px; flex-shrink: 0; position: relative;
            overflow: hidden;
        }
        .char-card-img img { width: 100%; height: 100%; object-fit: cover; }
        .char-card-img::after { content: ''; position: absolute; bottom: 2px; right: 5px; opacity: 0.3; }

        /* å³ä¾§ï¼šä¿¡æ¯ */
        .char-card-info {
            flex-grow: 1; padding: 10px 15px; position: relative;
            display: flex; flex-direction: column; justify-content: center;
        }
        
        .cc-names { display: flex; flex-direction: column; }
        .cc-nickname { font-size: 22px; font-weight: 900; color: #fff; line-height: 1; margin-bottom: 4px; }
        .cc-realname { font-size: 13px; color: #9e9e9e; font-weight: normal; }

        /* å³ä¸Šè§’ï¼šèŒä¸š */
        .cc-job {
            position: absolute; top: 6px; right: 6px;
            background: #ccc; color: #111;
            padding: 2px 4px; border-radius: 4px;
            font-size: 12px; font-weight: 800;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        /* å³ä¸‹è§’ï¼šå­¦æ ¡ */
/* === [CSS é…å¥—] ç¡®ä¿é•¿åå­—èƒ½å®Œæ•´æ˜¾ç¤º === */
.cc-school {
    position: absolute !important;
    bottom: 6px !important;
    right: 10px !important;
    
    /* 1. å¼ºåˆ¶æ‹‰é€šå·¦è¾¹ï¼Œç»™å®ƒæœ€å¤§çš„èˆå° */
    left: 10px !important;
    width: auto !important;
    
    /* 2. å…è®¸åå­—å¾ˆé•¿ï¼Œä¸è®¸æ¢è¡Œ */
    max-width: none !important;
    white-space: nowrap !important;
    
    /* 3. å³å¯¹é½ */
    text-align: right !important;
    
    /* 4. å¦‚æœåå­—å®åœ¨å¤ªé•¿(è¶…è¿‡å¡ç‰‡å®½åº¦)ï¼Œæ‰æ˜¾ç¤ºçœç•¥å· */
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    
    font-size: 11px !important;
    color: #555 !important;
    background: none !important;
    pointer-events: none;
    z-index: 5;
}


/* === ä¿®æ”¹ï¼šå±æ€§å›¾æ ‡æ¡† (åŠé€æ˜æ¯›ç»ç’ƒé£æ ¼) === */
        .attr-img-box {
            width: 60px; 
            height: 60px; 
            
            /* ã€æ ¸å¿ƒã€‘æ”¹ä¸ºåŠé€æ˜äº®è‰²åº• */
            background: rgba(255, 255, 255, 0.08); 
            /* ã€æ ¸å¿ƒã€‘ç£¨ç ‚ç»ç’ƒæ•ˆæœ */
            backdrop-filter: blur(5px); 
            /* åŠ ä¸€ä¸ªæ·¡æ·¡çš„å‘å…‰è¾¹æ¡† */
            border: 1px solid rgba(255, 255, 255, 0.2); 
            border-radius: 6px;
            
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #ccc; /* æ–‡å­—é¢œè‰²ä¹Ÿç¨å¾®æäº® */
            font-size: 10px;
        }
        /* === 1. ä¿®æ”¹ï¼šé®ç½©å±‚ (å…è®¸æ•´ä½“æ»šåŠ¨) === */
/* === ä¿®æ­£ï¼šé®ç½©å±‚ === */
        .modal-overlay {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            background: rgba(70, 70, 70, 0.7); 
            backdrop-filter: blur(5px);
            z-index: 9999; 
            
            /* ã€æ”¹è¿™é‡Œã€‘åŸæ¥æˆ‘å†™äº† flexï¼Œç°åœ¨å¿…é¡»æ”¹å› none */
            display: none; 
            
            /* ä¸‹é¢è¿™äº›ä¿ç•™ï¼Œæ˜¯ä¸ºäº†å¼¹å‡ºæ¥çš„æ—¶å€™èƒ½å±…ä¸­ */
            justify-content: center; 
            align-items: center;     
            overflow: auto; 
            padding: 20px; 
            }

/* === ä¿®æ­£ç‰ˆï¼šå¼¹çª—æœ¬ä½“ === */
        .char-modal-window {
            /* 1. åŸºç¡€å°ºå¯¸ */
            width: 90vw;
            max-width: 960px;
            min-width: 960px;
            height: 640px; 
            
            /* 2. å®šä½ä¸ç¼©æ”¾ */
            position: absolute; 
            left: 5%;           
            top: 50%;           
            transform: translateY(-50%) scale(0.9); 
            
            /* 3. ã€æ ¸å¿ƒä¿®å¤ã€‘è¿™ä¸€å¥ä¹‹å‰æ¼äº†ï¼Œå¿…é¡»åŠ ä¸Šï¼ */
            display: grid; 
            
            /* 4. ç½‘æ ¼æ¯”ä¾‹ (å·¦ä¾§376pxï¼Œå³ä¾§è‡ªåŠ¨å‰©ä½™) */
            grid-template-columns: 376px 1fr; 
            
            /* 5. å¤–è§‚ */
            background: #222;
            border: 4px solid #444;
            border-radius: 8px;
            box-shadow: 0 50px 100px rgba(0,0,0,1);
            
            /* 6. å±‚çº§ä¸æº¢å‡º */
            z-index: 1000; 
            overflow: visible !important; 
        }
        .close-btn {
            position: absolute; top: 10px; right: 20px;
            font-size: 40px; color: #666; cursor: pointer; z-index: 20; line-height: 1;
        }
        .close-btn:hover { color: #fff; }

/* === ä¿®æ”¹ï¼šå·¦ä¾§ç«‹ç»˜åŒº (è·Ÿéšçˆ¶å®¹å™¨æ¯”ä¾‹) === */
        .modal-left {
            background: #050505; 
            border-right: 1px solid #333;
            display: flex; 
            align-items: center; 
            justify-content: center;
            position: relative; 
            overflow: hidden;
            /* ä¸éœ€è¦å†™å®½åº¦ï¼Œå®ƒä¼šè‡ªåŠ¨å¡«æ»¡ grid çš„å·¦è¾¹é‚£ 27% */
            width: 100%; 
            height: 100%;
        }        
        
/* === ä¿®æ­£ï¼šç«‹ç»˜å®¹å™¨ (å»æ‰é»‘è¾¹) === */
.modal-portrait-placeholder {
    width: 100%; 
    height: 100%; 
    
    /* ã€æ ¸å¿ƒã€‘å»æ‰ä¹‹å‰çš„ padding å’Œè¾¹æ¡† */
    padding: 0;       
    border: none;     
    
    /* ç¡®ä¿å›¾ç‰‡èƒ½æ’‘æ»¡ */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden; 
    
}

/* === [ä¿®æ”¹] å·¦ä¾§ç«‹ç»˜ï¼šé—ªå…‰ç¯è¿‡æ›åˆ‡æ¢ === */
        #m-portrait {
            width: 100%; 
            height: 100%; 
            object-fit: cover;
            
            /* 1. å¸¸æ€ï¼šæ­£å¸¸æ˜¾ç¤º */
            opacity: 1;
            filter: brightness(1) blur(0);
            
            /* 2. è¿‡æ¸¡æ—¶é—´ï¼š0.2ç§’ */
            /* ç¨å¾®å¿«ä¸€ç‚¹(0.2s)ï¼Œé—ªå…‰ç¯çš„æ„Ÿè§‰æ›´å¼ºçƒˆ */
            transition: all 0.2s ease-out;
        }
        
        /* === å½“ JS åŠ ä¸Š .loading ç±»åæ—¶çš„â€œé—ªå…‰ç¬é—´â€ === */
        #m-portrait.loading {
            /* 1. ä¸éœ€è¦å˜é€æ˜ï¼Œåè€Œæ˜¯è¦ä¿æŒä¸é€æ˜ */
            opacity: 1; 
            
            /* 2. ã€æ ¸å¿ƒé­”æ³•ã€‘äº®åº¦æ‹‰æ»¡ + ç¨å¾®ä¸€ç‚¹å…‰æ™•(blur) */
            /* brightness(5) = 5å€äº®åº¦ï¼Œç›´æ¥è®©å›¾ç‰‡è¿‡æ›æˆæƒ¨ç™½ */
            /* grayscale(1) = å»è‰²ï¼Œæ¨¡æ‹Ÿå¼ºå…‰ä¸‹çœ‹ä¸æ¸…é¢œè‰²çš„æ„Ÿè§‰ */
            filter: brightness() grayscale(0.5) blur(3px);
            
            /* 3. (å¯é€‰) å¦‚æœä½ æƒ³ç¨å¾®ç¨å¾®é€ä¸€ç‚¹ç‚¹åº•è‰²ï¼Œå¯ä»¥æŠŠ scale æ”¾å¤§ä¸€ç‚¹ç‚¹ */
            transform: scale(1.02); 
        }

/* === 3. ä¿®æ”¹ï¼šå³ä¾§åŒºåŸŸ (å»æ‰æ»šåŠ¨æ¡) === */
        .modal-right {
            display: flex; 
            flex-direction: column; 
            height: 100%;       
            overflow: hidden; /* ã€éµå‘½ã€‘å½»åº•éšè—å†…éƒ¨æ»šåŠ¨æ¡ */
            position: relative;
        }

/* === ä¿®æ”¹ï¼šä¸ŠåŠéƒ¨åˆ† (é«˜åº¦å¾®è°ƒ) === */
        .modal-top-row {
            padding: 25px;         /* å†…è¾¹è·ç¨å¾®æ”¹å°ä¸€ç‚¹ç‚¹ï¼Œæ›´ç´§å‡‘ */
            border-bottom: 1px dashed #333;
            
            height: 360px;         /* ã€ç¼©å°ã€‘ä» 420 æ”¹ä¸º 360ï¼Œé…åˆæ•´ä½“é«˜åº¦ */
            flex-shrink: 0; 
            
            display: grid; 
            grid-template-columns: 1fr 1.2fr; 
            gap: 30px;             /* é—´è·ä¹Ÿç¨å¾®æ”¶ç´§ */
            box-sizing: border-box; 
        }

        /* é¡ºä¾¿ç¡®è®¤ä¸€ä¸‹å·¦ä¾§å›¾ç‰‡å®¹å™¨ */
        .modal-left {
            background: #050505; 
            border-right: 1px solid #333;
            display: flex; 
            align-items: center; 
            justify-content: center;
            /* å¡«æ»¡é‚£ä¸ª 350px çš„æ ¼å­ */
            width: 100%; 
            height: 100%;
            overflow: hidden;
        }        
        /* A. åŸºæœ¬ä¿¡æ¯æ  */
        .info-panel {
            display: flex; flex-direction: column; gap: 15px; justify-content: center;
        }
        .info-header { font-size: 14px; color: #888; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 5px; margin-bottom: 5px; letter-spacing: 1px; }
        
        .info-grid-styled {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
        }
        .info-capsule {
            background: #181818; border: 1px solid #333; border-radius: 4px;
            padding: 8px 12px; display: flex; flex-direction: column; gap: 2px;
        }
        .info-capsule.full { grid-column: span 2; }
        
        .ic-label { font-size: 10px; color: #666; font-weight: bold; text-transform: uppercase; }
        .ic-value { font-size: 15px; color: #eee; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* B. å±æ€§ä¸æ•°å€¼ */
        .stats-panel {
            display: flex; flex-direction: column; gap: 10px; justify-content: center;
            background: #1a1a1a00; padding: 20px; border-radius: 8px; border: 1px solid #2a2a2a00;
        }

/* === ä¿®æ”¹ï¼šå±æ€§æ å®¹å™¨ (å¯¹é½æŸ±çŠ¶å›¾çš„é»‘åº•è¾¹ç¼˜) === */
        .attr-slots {
            display: flex;
            width: 100%;
            justify-content: flex-end; /* å…ˆæ¨åˆ°æœ€å³è¾¹ */
            gap: 15px;                 /* æ–¹å—ä¹‹é—´çš„é—´è· */
            margin-bottom: 25px;       
            
            /* ã€æ ¸å¿ƒå…³é”®ç‚¹ã€‘ */
            /* ä½ çš„æ•°å­—å®½åº¦æ˜¯ 40pxï¼Œå·¦è¾¹è·æ˜¯ 10pxï¼Œä¸€å…± 50px */
            /* æ‰€ä»¥æˆ‘ä»¬ç»™è¿™é‡ŒåŠ  50px çš„å³å†…è¾¹è·ï¼Œå¼ºè¡ŒæŠŠå®ƒå¾€å·¦æŒ¤ */
            /* è¿™æ · Attr 2 çš„å³è¾¹ï¼Œå°±æ­£å¥½å¯¹é½é»‘è‰²æ¡çš„å³è¾¹äº† */
            padding-right: 50px; 
            
            box-sizing: border-box; /* ç¡®ä¿ padding ç®—åœ¨å®½åº¦å†… */
        }

        /* æŸ±çŠ¶å›¾ (çŸ©å½¢åšå®ç‰ˆ) */
        .stat-row { display: flex; align-items: center; font-size: 13px; font-weight: bold; height: 24px; }
        .stat-name { width: 50px; color: #888; text-align: right; margin-right: 15px; }
        .stat-bar-bg { width: 135px;; height: 100%; background: #2c2c2c; border-radius: 2px; overflow: hidden; border: 1px solid #333; }
        .stat-bar-fill { height: 100%; transition: width 0.3s ease; border-right: 2px solid rgba(255,255,255,0.5); }
        .stat-num { width: 40px; text-align: right; color: #fff; font-family: "Consolas", monospace; font-size: 16px; margin-left: 10px; }


/* === ä¿®æ”¹ï¼šä¸‹åŠéƒ¨åˆ† (ç»™å³ä¾§ç•™è¶³ç©ºé—´) === */
        .modal-bottom-row {
            flex-grow: 1; 
            display: grid; 
            
            /* ã€å…³é”®ä¿®æ”¹ã€‘å·¦å³æ¯”ä¾‹ */
            /* 1fr: å·¦è¾¹æ–‡å­—åŒºè‡ªåŠ¨å æ»¡å‰©ä½™ç©ºé—´ */
            /* 150px: å³è¾¹ Logo åŒºå›ºå®šå®½åº¦ (æƒ³è®© Logo åŒºæ›´å®½å°±æ”¹å¤§è¿™ä¸ªæ•°) */
            grid-template-columns: 1fr 150px; 
            
            /* ä¸¤å—åŒºåŸŸä¸­é—´çš„ç¼éš™ */
            gap: 20px;
            /* æ•´ä¸ªåŒºåŸŸçš„å†…è¾¹è· (ä¸Š å³ ä¸‹ å·¦) */
            padding: 0px; 
            /* --- èƒŒæ™¯ä¸å†…è¾¹è· --- */
            /* æ•´ä¸ªä¸‹åŠéƒ¨åˆ†çš„èƒŒæ™¯è‰² (å¦‚æœä¸æƒ³è¦å¯ä»¥è®¾ä¸º transparent) */
            background: #181818;
            /* æº¢å‡ºæ§åˆ¶ (ä¿æŒ hidden é˜²æ­¢æ’‘ç ´) */
            overflow: hidden;
            box-sizing: border-box;
        }
        
        /* === ä¿®æ”¹ï¼šäººç‰©å°è®¡ (è§†è§‰å®Œç¾å±…ä¸­) === */
        .bio-area {
            /* --- èƒŒæ™¯ä¸è¾¹æ¡† --- */
            /* èƒŒæ™¯è‰²ï¼šæƒ³äº®ä¸€ç‚¹å°±æ”¹è¿™é‡Œï¼Œæ¯”å¦‚ #222 æˆ– #333 */
            background: #181818; 
            /* è¾¹æ¡†ï¼šå¦‚æœæƒ³è¦è¾¹æ¡†ï¼ŒæŠŠ 0px æ”¹æˆ 1pxï¼Œé¢œè‰² #333 æ”¹äº® */
            border: 0px solid #333; 
            /* åœ†è§’ï¼šæ§åˆ¶æ–¹æ¡†çš„åœ†æ¶¦ç¨‹åº¦ */
            border-radius: 0px;

            /* --- å†…è¾¹è· --- */
            /* æ–‡å­—ç¦»è¾¹æ¡†çš„è·ç¦» (ä¸Šä¸‹ å·¦å³) */
            padding: 60px 20px; 
            
            
            color: #c7c7c7; 
            font-size: 14px; 
            font-family: "Microsoft YaHei", "SimKai", serif;
            
            /* === Flexbox å¼ºåŠ›å±…ä¸­ === */
            display: flex;
            flex-direction: column; /* ç¡®ä¿æ–‡å­—æ˜¯å—çŠ¶æ’åˆ— */
            justify-content: normal; /* å‚ç›´å±…ä¸­ */
            align-items: center;     /* æ°´å¹³å±…ä¸­ */
            
            height: 100%; 
            width: 100%;
            overflow: hidden; /* é˜²æ­¢æº¢å‡º */
        }      
        /* === æ–°å¢ï¼šé’ˆå¯¹æ–‡å­—å†…å®¹çš„å¾®è°ƒ === */
        #m-bio {
            text-align: left; /* ç¡®ä¿æ¯ä¸€è¡Œæ–‡å­—éƒ½å±…ä¸­ */
            line-height: 1.8;   /* ä¿æŒèˆ’é€‚çš„è¡Œé—´è· */
            width: 100%;        /* å æ»¡å®½åº¦ */
            
            /* ã€è§†è§‰æ ¡å‡†ã€‘ */
            /* æœ‰æ—¶å€™æ–‡å­—çœ‹èµ·æ¥åä¸‹ï¼Œæ˜¯å› ä¸ºè¡Œé«˜æ’‘çš„ */
            /* å¦‚æœä½ è§‰å¾—æ–‡å­—è¿˜æ˜¯åä¸‹ï¼Œå¯ä»¥æŠŠä¸‹é¢çš„ margin-top æ”¹æˆ -5px è¯•è¯• */
            margin-top: 0; 
        }
        /* === ä¿®æ”¹ï¼šLogo å®¹å™¨ (å¼ºåˆ¶å·¦å³å±…ä¸­) === */
        .logos-area {
            display: flex; 
            flex-direction: column; /* å‚ç›´æ’åˆ— */
            gap: 15px; 
            
            /* ã€æ ¸å¿ƒæŒ‡ä»¤ 1ã€‘align-items åœ¨ column æ¨¡å¼ä¸‹æ§åˆ¶â€œå·¦å³â€ */
            /* å¿…é¡»è®¾ä¸º centerï¼ŒLogo æ‰ä¼šæ°´å¹³å±…ä¸­ */
            align-items: center; 
            
            /* ã€æ ¸å¿ƒæŒ‡ä»¤ 2ã€‘justify-content åœ¨ column æ¨¡å¼ä¸‹æ§åˆ¶â€œä¸Šä¸‹â€ */
            justify-content: center;
            
            /* ç¡®ä¿å®ƒå æ»¡æ ¼å­ï¼Œæ‰æœ‰ç©ºé—´å»å±…ä¸­ */
            width: 100%; 
            height: 100%;
            
            /* (å¯é€‰) å¦‚æœè¿˜è§‰å¾—åï¼ŒåŠ ä¸ªä¸´æ—¶çº¢æ¡†çœ‹çœ‹è¾¹ç•Œï¼š border: 1px solid red; */
        }
        /* å•ä¸ª Logo çš„å°æ–¹å— */
        .logo-box {
        /* --- å°ºå¯¸æ§åˆ¶ --- */
        /* æƒ³è®© Logo å¤§ä¸€ç‚¹å°±æ”¹å¤§è¿™é‡Œï¼Œæ¯”å¦‚ 80px */
            width: 100px; 
            height: 100px; 
            
            /* --- èƒŒæ™¯ä¸è¾¹æ¡† --- */
            /* å°æ–¹å—çš„èƒŒæ™¯è‰²ï¼š#000 æ˜¯çº¯é»‘ï¼Œå»ºè®®æ”¹æˆ transparent (é€æ˜) æˆ– #222 */
            background: transparent; 
            /* è¾¹æ¡†ï¼š1px dashed #444 æ˜¯è™šçº¿æ¡†ï¼Œä¸æƒ³è¦å°±æ”¹ border: none */
            border: 0px dashed #444; 
            /* åœ†è§’ */
            border-radius: 8px;
            
        /* --- å†…éƒ¨å¸ƒå±€ (ä¿è¯å›¾ç‰‡å±…ä¸­) --- */
            display: flex; 
            align-items: center; 
            justify-content: center; 
            
        /* --- æ–‡å­—æ ·å¼ (Logoæ²¡å›¾æ—¶æ˜¾ç¤ºçš„å­—) --- */
            color: #ffffff; 
            font-size: 12px; 
            text-align: center;
        }

        /* Logo å›¾ç‰‡æœ¬èº« */
        .logo-box img {
        /* å›¾ç‰‡ç¼©æ”¾æ¯”ä¾‹ï¼š80% è¡¨ç¤ºå›¾ç‰‡å æ ¼å­çš„ 80% å¤§å°ï¼Œç•™ç‚¹è¾¹è· */
        width: 100%; 
        height: 100%; 
        
        /* å›¾ç‰‡å¡«å……æ¨¡å¼ï¼šcontain (å®Œæ•´æ˜¾ç¤º) æˆ– cover (å¡«æ»¡è£å‰ª) */
        object-fit: contain; 
        }

/* === ä¿®æ­£ï¼šç ´çª—å…ƒç´  1 - å·¦ä¾§å¤§åå­— (å¤–æè¾¹ç‰ˆ) === */
/* === [ä¿®å¤] ç ´çª—å¤§åå­—ï¼šåˆ†å±‚æ¸²æŸ“æ³• === */
/* === [ç»ˆæä¿®å¤] ç ´çª—å¤§åå­—ï¼šæœ¬ä½“åšæè¾¹ï¼Œä¼ªå…ƒç´ åšå¡«å…… === */
        .broken-name {
            position: absolute;
            bottom: -80px;   
            left: -120px;   
            
            font-size: 100px; 
            font-weight: 900; 
            font-family: "Microsoft YaHei", "SimHei", "Impact", sans-serif;
            font-style: italic; 
            white-space: nowrap;
            z-index: 1010; 
            pointer-events: none;

            /* --- å±‚çº§ 1 (åº•å±‚)ï¼šè´Ÿè´£é»‘è‰²æè¾¹ --- */
            /* è®©æœ¬ä½“å˜æˆçº¯é»‘è‰² */
            color: #000; 
            /* åŠ è¶…ç²—æè¾¹ (16px å®é™…ä¸Šçœ‹èµ·æ¥æ˜¯ 8px å¤–æè¾¹) */
            -webkit-text-stroke: 16px #000;
            
            /* æ•´ä½“æŠ•å½± */
            filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.5));
        }

/* --- å±‚çº§ 2 (é¡¶å±‚)ï¼šè´Ÿè´£æ˜¾ç¤ºé¢œè‰²/æ¸å˜ --- */
        .broken-name::after {
            /* è¯»å–æ–‡å­— */
            content: attr(data-text);
            
            /* ç»å¯¹å®šä½ï¼Œè¦†ç›–åœ¨æœ¬ä½“ä¸Šé¢ */
            position: absolute;
            left: 0; 
            top: 0;
            z-index: 2;
            
            /* --- é¢œè‰²æ ¸å¿ƒ --- */
            /* è¯»å– JS ä¼ è¿‡æ¥çš„å˜é‡ */
            background: var(--char-color);
            
            /* è£å‰ªèƒŒæ™¯åˆ°æ–‡å­—å½¢çŠ¶ */
            -webkit-background-clip: text;
            
            /* æ–‡å­—æœ¬èº«å˜é€æ˜ï¼Œéœ²å‡ºèƒŒæ™¯è‰² */
            color: transparent;
            
            /* è¿™é‡Œçš„æè¾¹ä¸º0ï¼Œä¿è¯å­—å½¢çº¤ç»† */
            -webkit-text-stroke: 0;

            /* === ã€æ ¸å¿ƒä¿®å¤ã€‘ === */
            /* ç»™å³è¾¹å¤šç•™ 0.2ä¸ªå­— çš„ç©ºé—´ï¼Œä¸“é—¨å®¹çº³æ–œä½“å­—çš„â€œå°¾å·´â€ */
            /* è¿™æ ·èƒŒæ™¯å°±ä¸ä¼šåˆ‡æ–­æ–‡å­—çš„æœ€å³è¾¹äº† */
            padding-right: 0.2em; 
        }
        
        /* æ³¨æ„ï¼šåˆ æ‰äº†ä¹‹å‰çš„ ::beforeï¼Œç°åœ¨æ”¹ç”¨ ::after è¦†ç›–åœ¨ä¸Šé¢ */



/* === [ä¿®æ”¹] ç ´çª—å®¹å™¨ï¼šæ‰©å¤§èŒƒå›´ + å¼ºåˆ¶å³å¯¹é½ === */
        .broken-portrait-container {
            position: fixed; 
            top: 0;
            right: 0;
            
            /* ã€ä¿®æ”¹ç‚¹ 1ã€‘å®½åº¦ä» 50vw æ”¹ä¸º 65vw */
            /* åŸç†ï¼šè®©è¿™ä¸ªâ€œéšå½¢ç›’å­â€å æ®å±å¹•å®½åº¦çš„ 65%ï¼Œèˆå°æ›´å®½äº† */
            width: 65vw;     
            
            height: 100vh;   
            
            display: flex;
            align-items: center;   /* å‚ç›´å±…ä¸­ (ä¿æŒä¸å˜) */
            
            /* ã€ä¿®æ”¹ç‚¹ 2ã€‘æ°´å¹³å¯¹é½æ”¹ä¸º flex-end */
            /* åŸç†ï¼šåŸæ¥æ˜¯ center (å±…ä¸­)ï¼Œå¯¼è‡´å·¦å³éƒ½æœ‰ç©ºéš™ã€‚*/
            /* æ”¹ä¸º flex-end (æœ«ç«¯å¯¹é½)ï¼Œå°±æ˜¯å¼ºåˆ¶æŠŠå†…éƒ¨çš„å†…å®¹æ¨åˆ°æœ€å³è¾¹ï¼ */
            justify-content: flex-end; 
            
            z-index: 1020; 
            pointer-events: none; 
            /* ã€æ ¸å¿ƒä¿®å¤ã€‘åŠ åœ¨è¿™é‡Œï¼ */
            /* åªæœ‰è¿™ä¸ªå®¹å™¨é‡Œçš„ä¸œè¥¿è·‘å‡ºè¾¹ç•Œæ—¶è¢«éšè—ï¼Œä¸å½±å“æ•´ä¸ªç½‘é¡µ */
            overflow: hidden;
        }

/* === [ä¿®æ”¹] æˆ˜æ–—ç«‹ç»˜æœ¬ä½“ï¼šä¸‰é¢ç ´çª— (ä¸Šã€ä¸‹ã€å³) === */
        .broken-portrait-img {
            /* 1. å®½åº¦æ§åˆ¶ï¼šå…è®¸å¡«æ»¡å®¹å™¨å®½åº¦çš„ 100% */
            max-width: 100%;
            
            /* ã€æ ¸å¿ƒä¿®æ”¹ 1ã€‘é«˜åº¦æ‹‰ä¼¸ï¼šè®©å›¾ç‰‡é«˜åº¦è¶…è¿‡å±å¹•é«˜åº¦ä¸€ç‚¹ç‚¹ (102%) */
            /* åŸæ¥æ˜¯ max-height: 90%; ç°åœ¨æ”¹ä¸ºå…·ä½“çš„é«˜åº¦ */
            height: 102vh; 
            
            /* ã€æ ¸å¿ƒä¿®æ”¹ 2ã€‘è§£é™¤æœ€å¤§é«˜åº¦é” */
            max-height: none; 
            
            /* ã€æ ¸å¿ƒä¿®æ”¹ 3ã€‘æ˜¾ç¤ºæ¨¡å¼ï¼šä¿æŒæ¯”ä¾‹ï¼Œç´§è´´å³ä¾§ */
            /* æ³¨æ„ï¼šå¦‚æœæ‚¨çš„ç«‹ç»˜ç‰¹åˆ«å®½ï¼Œä¸ºäº†ä¿è¯ä¸Šä¸‹è´´è¾¹ï¼Œå¯èƒ½éœ€è¦æ”¹ä¸º coverï¼Œä½†ä¼šè£æ‰å·¦è¾¹ */
            /* ç›®å‰ç”¨ contain æ˜¯æœ€å®‰å…¨çš„ï¼Œä¿è¯äººæ˜¯å…¨çš„ */
            object-fit: contain;
            object-position: right center; /* é”šç‚¹é”å®šåœ¨å³è¾¹ä¸­é—´ */
            
            /* ã€æ ¸å¿ƒä¿®æ”¹ 4ã€‘ä¸‰ç»´è´Ÿè¾¹è·ï¼šä¸Šä¸‹å³å…¨éƒ¨â€œå†²â€å‡ºå±å¹• */
            /* ä¸Š(-1vh) å³(-5px) ä¸‹(-1vh) å·¦(0) */
            margin: -1vh -5px -1vh 0;
            
            /* é˜´å½±ä¿æŒä¸å˜ */
            filter: drop-shadow(5px 5px 10px rgba(0,0,0,0.9));
            display: none; 
        }

/* === [æ–°å¢] å¼¹çª—åº•éƒ¨å¯¼èˆªæŒ‰é’® === */
        .nav-controls {
            position: absolute;
            bottom: -100px; /* æ”¾åœ¨å¼¹çª—æ­£ä¸‹æ–¹å¤–é¢ */
            left: 100%;
            transform: translateX(-50%); /* æ°´å¹³å±…ä¸­ */
            display: flex;
            gap: 80px; /* ä¸¤ä¸ªæŒ‰é’®çš„é—´è· */
            z-index: 1010;
        }

        .nav-btn-char {
            width: 50px; height: 50px;
            background: rgba(30, 30, 30, 0.8);
            border: 1px solid #555;
            border-radius: 50%; /* åœ†å½¢æŒ‰é’®ï¼Œæ›´æœ‰ç§‘æŠ€æ„Ÿ */
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            color: #888;
            font-size: 20px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* å¼¹æ€§åŠ¨ç”» */
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            user-select: none;
        }

        /* æ‚¬æµ®ç‰¹æ•ˆï¼šå‘å…‰ + å˜å¤§ */
        .nav-btn-char:hover {
            background: #8a8a8a;
            color: #000;
            border-color: #fff;
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
        }

        /* ç‚¹å‡»ç‰¹æ•ˆ */
        .nav-btn-char:active {
            transform: scale(0.95);
        }

/* =========================================
        [ç»ˆæä¿®å¤] æŒ‰é’®é«˜äº®åŠ¨ç”» (å¼ºåˆ¶è¦†ç›–ç‰ˆ)
       ========================================= */
    
    /* åªè¦æœ‰è¿™ä¸ªç±»åï¼Œä¸ç®¡æ˜¯åœ¨æ‰‹æœºè¿˜æ˜¯ç”µè„‘ï¼Œå¿…é¡»å˜ç™½å‘å…‰ */
    .nav-btn-char.is-active {
        /* 1. å¼ºåˆ¶å˜ç™½ */
        background: #ffffff !important;
        border-color: #ffffff !important;
        color: #000000 !important;
        
        /* 2. å¼ºåŠ›å‘å…‰ (åŠ ä¸¤å±‚é˜´å½±) */
        box-shadow: 
            0 0 15px rgba(255, 255, 255, 0.8),
            0 0 30px rgba(255, 255, 255, 0.4) !important;
            
        /* 3. ç‰©ç†æŒ‰å‹æ„Ÿ (ç¼©å°) */
        transform: scale(0.9) !important;
        
        /* 4. è¿‡æ¸¡è¦æå¿« (æŒ‰ä¸‹ç¬é—´å˜äº®) */
        transition: all 0.05s linear !important; 
    }

    /* å¸¸æ€ä¸‹æ¢å¤æ…¢è¿‡æ¸¡ (æ¾å¼€æ—¶æ…¢æ…¢å˜æš—) */
    .nav-btn-char {
        transition: all 0.2s ease-out !important;
    }

/* =========================================
        PART 6: æ–‘ä¸˜å¡ç‰Œç³»ç»Ÿ (æœ€ç»ˆä¿®æ­£ç‰ˆ)
       ========================================= */
    
/* =========================================
        [ä¿®æ”¹] æ ‡é¢˜æ é€šç”¨æ ·å¼ (å¡ç‰Œ & äººç‰©å…±ç”¨)
   ========================================= */

/* 1. å¡ç‰Œé¡µæ ‡é¢˜æ  (å‹æ‰ç‰ˆ) */
.bqc-chapter-bar {
    /* [ä¿®æ”¹] é«˜åº¦å›ºå®šä¸º 50px (æ¯”å¯¼èˆªæ  60px ç¨å¾®å°ä¸€ç‚¹ï¼Œæ˜¾è‡´å¯†) */
    height: 40px; 
    
    /* [ä¿®æ”¹] å¸ƒå±€æ–¹å¼ï¼šFlex å±…ä¸­ */
    display: flex; 
    align-items: center; 
    gap: 15px;
    
    /* [ä¿®æ”¹] è¾¹è·æ§åˆ¶ */
    width: 100%; 
    padding: 0 20px; /* å·¦å³ç•™ç™½ */
    margin-bottom: 20px; /* æ ‡é¢˜å’Œä¸‹é¢å†…å®¹çš„é—´è· */
    margin-top: 60px !important; /* é¿å¼€é¡¶éƒ¨å¯¼èˆª */
    /* æ ¸å¿ƒä¿®æ­£ï¼šä¸è¦è®¾ä¸º 0ï¼Œè¦è®¾ä¸ºå¯¼èˆªæ çš„é«˜åº¦ï¼Œè¿™æ ·æ‰ä¼šç´§è´´å¯¼èˆªæ ä¸‹æ–¹ */
    top: var(--navbar-height) !important; 
    
    z-index: 1000; /* ç¡®ä¿å±‚çº§é«˜äºå†…å®¹ï¼Œä½†ä½äº navbar(2000) */

    /* æ ·å¼ */
    background: linear-gradient(90deg, #1a1a1a 0%, #0d0d0d 100%);
    border-top: 1px solid #333;
    border-bottom: 1px solid #000;
    
    /* å·¦ä¾§è‰²æ¡ */
    border-left-width: 6px; 
    border-left-style: solid; 
    
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    position: sticky;
    top: 0 !important;
    z-index: 100;
    cursor: pointer; /* æç¤ºå¯ç‚¹å‡» */
}

/* ç¬¬ä¸€ä¸ªæ ‡é¢˜é¡¶ä¸Šå» */
.bqc-chapter-bar:first-child { 
    margin-top: 0 !important; 
}

/* æ ‡é¢˜æ  Logo å¾®è°ƒ */
.bqc-bar-logo { 
    width: 24px; height: 24px; /* å›¾æ ‡æ”¹å°ä¸€ç‚¹é€‚é…æ‰æ¡ */
    object-fit: contain; 
}

/* æ ‡é¢˜æ–‡å­—å¾®è°ƒ */
.bqc-bar-title { 
    font-size: 16px; /* å­—ä½“æ”¹å°ä¸€ç‚¹ */
    font-weight: bold; 
    letter-spacing: 1px; 
    color: #fff; 
    text-transform: uppercase; 
}

    /* =========================================
    [æ–°å¢] äººç‰©é¡µä¸“ç”¨æ ‡é¢˜æ  (å¤ç”¨é€»è¾‘)
    ========================================= */
.char-sticky-bar {
    /* [æ ¸å¿ƒ] å®½åº¦å æ»¡å±å¹• */
    width: 100%; 
    height: 40px; /* å‹æ‰ */
    
    /* å†…éƒ¨å¸ƒå±€ */
    display: flex; 
    align-items: center; 
    gap: 15px;
    padding: 0 40px; /* å·¦å³ç•™ç™½ï¼Œæ–‡å­—ä¸è¦è´´è¾¹ */
    
    /* é¢œè‰²ä¸æ ·å¼ */
    background: linear-gradient(90deg, #1a1a1a 0%, #0d0d0d 100%);
    border-top: 1px solid #333;
    border-bottom: 1px solid #000;
    border-left-width: 8px; border-left-style: solid; /* å·¦ä¾§è‰²å— */
    
    /* === ã€æ ¸å¿ƒä¿®å¤ã€‘ === */
    /* 1. å¿…é¡»å£°æ˜ position: sticky */
    position: -webkit-sticky; /* å…¼å®¹ Safari */
    position: sticky;
    
    /* 2. å¿…é¡»ç´§è´´é¡¶éƒ¨ (å› ä¸ºæ»šåŠ¨çš„çˆ¶å®¹å™¨æ˜¯ view-section) */
    top: 0; 
    
    /* 3. å±‚çº§è¦é«˜ï¼Œå‹ä½ä¸‹é¢çš„å†…å®¹ */
    z-index: 100;
    
    /* 4. ã€å…³é”®ã€‘å»æ‰ margin-topï¼Œé˜²æ­¢å®ƒè¿˜æ²¡æ»šåˆ°é¡¶å°±å¡ä½ */
    margin-top: 0; 
    margin-bottom: 0; /* åº•éƒ¨é—´è·äº¤ç»™ä¸‹é¢çš„å†…å®¹å—å»æ’‘å¼€ */
    
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}

/* === [æ ¸å¿ƒä¿®å¤] åˆ†ç»„å®¹å™¨ === */
/* ç»™æ¯ä¸€ç»„ã€æ ‡é¢˜+ç¤¾å›¢ã€‘åŠ ä¸ªå¤–å¥—ï¼Œç¡®ä¿ Sticky åªåœ¨è¿™ä¸ªèŒƒå›´å†…ç”Ÿæ•ˆ */
.char-group-section {
    position: relative; /* å¿…é¡»æ˜¯ relative */
    width: 100%;
    
    /* ç»„ä¸ç»„ä¹‹é—´çš„é—´è·ï¼Œæ›¿ä»£ä¹‹å‰çš„ margin-top */
    padding-bottom: 60px; 
    
    /* ã€å…³é”®ã€‘ä¸èƒ½æœ‰ overflow: hiddenï¼Œå¦åˆ™ sticky ä¼šå¤±æ•ˆ */
    overflow: visible; 
}

/* æ‰‹æœºç«¯ç¨å¾®ç´§å‡‘ä¸€ç‚¹ */
@media (max-width: 1000px) {
    .char-group-section {
        padding-bottom: 30px;
    }
}

/* æ ‡é¢˜æ–‡å­—æ ·å¼ (å¼ºåˆ¶ç™½è‰²) */
.char-bar-title {
    font-size: 16px; 
    font-weight: 900; 
    letter-spacing: 2px;
    color: #ffffff !important; /* ã€éµå‘½ã€‘å…¨ç™½ */
    text-transform: uppercase;
    text-shadow: 0 2px 4px rgba(0,0,0,0.8);
}


/* 2. å±…ä¸­å†…å®¹å— (å—æ°”åŒ…) */
/* è¿™ä¸ªç±»åä¸“é—¨ç”¨æ¥åŒ…ä½ .society-grid */
/* === å†…å®¹å— (é…åˆæ ‡é¢˜æ ) === */
.archive-block {
    max-width: 85%; 
    width: 100%;
    margin: 0 auto;
    
    padding: 0 20px;
    padding-top: 20px !important;
    
    /* ã€æ–°å¢ã€‘ç»™ä¸Šé¢ç•™ç‚¹ç©ºéš™ï¼Œå…å¾—ç´§è´´ç€æ ‡é¢˜æ å¤ªæŒ¤ */
    padding-top: 30px; 
    
    /* åº•éƒ¨ç•™ç©º */
    padding-bottom: 30px; 
}

/* æ‰‹æœºç«¯é€‚é…ï¼šå†…å®¹å—å˜å®½ï¼Œç•™ç™½å˜å° */
@media (max-width: 1000px) {
    .archive-block {
        max-width: 95%; /* æ‰‹æœºä¸Šç¨å¾®å®½ä¸€ç‚¹ */
        padding: 0 10px;
        padding: 15px 10px 0 10px !important;
    }
    .char-sticky-bar {
        padding: 0 20px; /* æ‰‹æœºä¸Šæ ‡é¢˜æ ç•™ç™½ä¹Ÿå°ä¸€ç‚¹ */
    }
}

/* äººç‰©é¡µç¬¬ä¸€ä¸ªæ ‡é¢˜ä¸éœ€è¦é—´è· (å› ä¸ºå®ƒä¸Šé¢æ²¡æœ‰å¯¼èˆªæ é®æŒ¡ï¼Œæˆ–è€…ç”±å®¹å™¨æ§åˆ¶) */
.char-sticky-bar.first { margin-top: 0; }

.char-bar-title {
    font-size: 16px; font-weight: bold; letter-spacing: 2px;
    color: #ffffff !important; /* ã€æ ¸å¿ƒã€‘å¼ºåˆ¶ç™½è‰² */
}

/* =========================================
   [æ–°å¢] äººç‰©é¡µè·³è½¬èœå• (å¤ç”¨å¡ç‰Œèœå•æ ·å¼)
   ========================================= */
/* è¿™é‡Œçš„æ ·å¼å¤ç”¨ .jump-menu-overlay å³å¯ï¼Œä¸éœ€è¦é¢å¤–å†™ */

    /* 3. [å…³é”®] å¡ç‰Œç½‘æ ¼ï¼šç‹¬ç«‹çº¦æŸ (è¿™å°±æ˜¯æ‚¨è¦çš„è¥¿ç“œ) */
    .bqc-grid {
        display: grid;
        /* --- A. ç”µè„‘ç«¯åˆ—æ•° --- */
        /* repeat(6, 1fr) ä»£è¡¨ä¸€è¡Œ 6 å¼  */
        /* å¦‚æœè§‰å¾—å¤ªå¯†ï¼Œå¯ä»¥æ”¹æˆ 5 æˆ– 4 */
        grid-template-columns: repeat(6, 1fr);

        /* --- B. [ä¿®æ”¹] å¡ç‰Œé—´è· --- */
        /* æ§åˆ¶å¡ç‰Œä¹‹é—´çš„ç¼éš™å¤§å° */
        /* å»ºè®®ï¼šç”µè„‘ç«¯ 20px - 30pxï¼Œæ‰‹æœºç«¯ 10px - 15px */
        gap: 25px;
        
        /* ã€å…³é”®ã€‘è™½ç„¶çˆ¶äº²å…¨å®½äº†ï¼Œä½†æˆ‘è‡ªå·±ä¾ç„¶ä¿æŒæœ€å¤§ 1400px å±…ä¸­ */
        width: 100%;
        max-width: 1400px; 
        margin: 0 auto;   /* å±…ä¸­ */
        
        /* --- C. [ä¿®æ”¹] å·¦å³ç•™ç™½ --- */
        /* æ•´ä¸ªç½‘æ ¼è·ç¦»å±å¹•è¾¹ç¼˜çš„è·ç¦» */
        padding: 0 20px; 
        padding-bottom: 60px;

    }

/* --- D. å“åº”å¼è§„åˆ™ (å±å¹•å˜çª„æ—¶æ€ä¹ˆå˜) --- */

    /* å¹³æ¿ / å°ç”µè„‘ (1200px ä»¥ä¸‹) */
    @media (max-width: 1200px) { 
        .bqc-grid { 
            /* å˜æˆ 4 åˆ— */
            grid-template-columns: repeat(4, 1fr); 
        } 
    }

    /* æ‰‹æœº / çª„å± (768px ä»¥ä¸‹) */
    @media (max-width: 768px) { 

        /* 1. ä¿®æ”¹å…¨å±€å˜é‡ï¼šæŠŠæ—¶é—´åˆ—å®½ä» 100px å‹æ‰åˆ° 35px */
:root {
        --time-col-width: 35px; 
    }

    .time-cell {
        /* 1. å¼ºåˆ¶ç«–æ’æ¨¡å¼ */
        -webkit-writing-mode: vertical-rl; 
        writing-mode: vertical-rl;
        
        /* 2. ã€å…³é”®ã€‘è®©æ•°å­—ç›´ç«‹èµ·æ¥ï¼Œè€Œä¸æ˜¯èººç€ */
        text-orientation: upright; 
        
        /* 3. å­—ä½“æ§åˆ¶ */
        font-size: 12px !important;
        font-family: "Consolas", monospace; /* ç­‰å®½å­—ä½“è®©æ•°å­—å¯¹å¾—æ›´é½ */
        
        /* 4. ç´§å‡‘è¡Œé«˜ä¸å­—é—´è· */
        letter-spacing: -1px !important; /* æŠŠç«–ç€çš„æ•°å­—æ‹‰è¿‘ä¸€ç‚¹ï¼Œé˜²æ­¢å¤ªé•¿ */
        line-height: 1;
        
        /* 5. å¸ƒå±€ */
        padding: 5px 0 !important;
        display: flex !important;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: auto; /* å…è®¸é«˜åº¦è‡ªé€‚åº” */
    }


        .bqc-grid { 
            /* --- E. [ä¿®æ”¹] æ‰‹æœºä¸€è¡Œæœ€å°‘æ˜¾ç¤ºå‡ å¼ ï¼Ÿ --- */
            /* repeat(2, 1fr) = ä¸€è¡Œ 2 å¼  (å½“å‰é»˜è®¤ï¼Œæ¯”è¾ƒæ¸…æ™°) */
            /* repeat(3, 1fr) = ä¸€è¡Œ 3 å¼  (å¡ç‰Œä¼šå˜å°ï¼Œèƒ½çœ‹æ›´å¤š) */
            /* repeat(1, 1fr) = ä¸€è¡Œ 1 å¼  (å·¨å¤§ï¼Œç±»ä¼¼ç¤¾å›¢å¡) */
            grid-template-columns: repeat(3, 1fr); 
            
            /* æ‰‹æœºä¸Šé—´è·é€šå¸¸è¦æ›´å°ä¸€ç‚¹ï¼Œçœç©ºé—´ */
            gap: 10px; 
            padding: 0 10px; /* å·¦å³ç•™ç™½ä¹Ÿå‡å° */
        } 
    }

    /* --- å¡ç‰Œæ ·å¼ä¿æŒä¸å˜ --- */
    .bqc-card-item {
        overflow: visible !important;
        position: relative;
        aspect-ratio: 1860 / 2598; 
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border-radius: 10px;
        overflow: hidden;
        image-rendering: -webkit-optimize-contrast; 
    }
    .bqc-card-img { width: 100%; height: 100%; object-fit: contain; display: block; }
    
    
    .bqc-card-item:hover { transform: scale(1.035); 
        z-index: 2; 
        box-shadow: 0 0 4px 2px rgba(255, 255, 255, 0.767); }
    
    /* --- å¼¹çª—æ ·å¼ä¿æŒä¸å˜ (ç•¥) --- */
        /* =========================================
        å¼¹çª—å¤§å›¾ (3D å€¾æ–œæ•ˆæœ)
        ========================================= */
        
        /* é®ç½©å±‚ */
        .bqc-modal-overlay {
            display: none; /* é»˜è®¤éšè— */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(53, 53, 53, 0.7);
            /* ğŸ‘‡ ã€å»ºè®®æ–°å¢ã€‘å¦‚æœæ‚¨æƒ³è¦â€œç£¨ç ‚ç»ç’ƒâ€çš„æ¨¡ç³Šæ•ˆæœï¼ŒåŠ è¿™ä¸€å¥ */
            backdrop-filter: blur(5px);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            perspective: 1000px; /* 3Dé€è§†ç‚¹ */
        }

        .bqc-modal-overlay.active {
            display: flex;
        }

/* å¤§å›¾å®¹å™¨ */
    .bqc-modal-content {
        width: auto;
        
        /* [ä¿®æ”¹] é«˜åº¦é™åˆ¶ï¼šæ¡Œé¢ç«¯ä¿æŒ 80vhï¼Œä½†ä¸èƒ½å¤ªå¤§ */
        height: 80vh; 
        
        /* [æ–°å¢] ç§»åŠ¨ç«¯å®‰å…¨è·ç¦»æ ¸å¿ƒä»£ç  */
        /* æ„æ€æ˜¯ï¼šå®½åº¦æœ€å¤§åªèƒ½æ˜¯å±å¹•çš„ 85%ï¼Œé«˜åº¦æœ€å¤§ 85% */
        /* è¿™æ ·æ— è®ºå±å¹•å¤šå°ï¼Œå››å‘¨éƒ½ä¼šç•™å‡ºç©ºéš™ */
        max-width: 85vw;
        max-height: 85vh;
        
        aspect-ratio: 1860 / 2598;
        position: relative;
        transform-style: preserve-3d; 
        transition: transform 0.1s ease-out; 
        
        /* åœ†è§’è£å‰ª */
        border-radius: 12px; 
        overflow: hidden; 
        -webkit-mask-image: -webkit-radial-gradient(white, black);
        /* [ä¿®å¤] æŠŠå°æ‰‹åŠ åœ¨è¿™é‡Œï¼ */
        /* åªè¦é¼ æ ‡è¿›äº†è¿™ä¸ªæ¡†ï¼Œä¸ç®¡æ˜¯ç¢°åˆ°å…‰è¿˜æ˜¯ç¢°åˆ°å›¾ï¼Œéƒ½æ˜¯å°æ‰‹ */
        cursor: pointer; 
    }

        .bqc-modal-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            /* [ä¿®æ”¹] ä»¥å‰æ˜¯ none (ç©¿é€)ï¼Œç°åœ¨æ”¹ä¸º auto (å…è®¸ç‚¹å‡») */
            pointer-events: auto; 
            
        }

        /* å…³é—­æç¤º */
        .bqc-close-hint {
            position: absolute;
            top: 20px;
            right: 30px;
            color: #fff;
            font-size: 30px;
            cursor: pointer;
            font-weight: bold;
        }


/* === [ä¿®æ”¹] åŠ¨æ€åå…‰å±‚ (æŸ”å…‰ + é®ç½©ç‰ˆ) === */
        .bqc-card-shine {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            
            /* 1. [è§£å†³åˆ†å‰²çº¿] æ”¹ç”¨å¾„å‘æ¸å˜ (åœ†å½¢å…‰æ–‘) */
            /* è¿™ç§å…‰ä¸­é—´äº®ã€å››å‘¨æ…¢æ…¢å˜é€æ˜ï¼Œæ²¡æœ‰ä»»ä½•ç¡¬è¾¹ç¼˜ */
            background: radial-gradient(
                circle at center, 
                rgba(255, 255, 255, 0.85) 0%, 
                rgba(255, 255, 255, 0.2) 40%, 
                transparent 70%
            );
            
            /* 2. æŠŠå…‰æ–‘æ”¾å¤§ï¼Œä¿è¯ç§»åŠ¨æ—¶èƒ½è¦†ç›–å…¨èº« */
            background-size: 300% 300%;
            background-repeat: repeat;
            
            /* 3. æ··åˆæ¨¡å¼ï¼šSoft Light (æŸ”å…‰) æ¯” Overlay æ›´è‡ªç„¶ï¼Œä¸å®¹æ˜“è¿‡æ› */
            mix-blend-mode: soft-light; 
            /* å¦‚æœè§‰å¾—ä¸å¤Ÿäº®ï¼Œå¯ä»¥æ”¹å› soft-lightã€hard-lightã€overlayã€color-dodgeã€screen */
            
            /* 4. [è§£å†³åœ†è§’é—®é¢˜] é®ç½©åŸºç¡€è®¾ç½® */
            /* æˆ‘ä»¬ç¨åä¼šåœ¨ JS é‡ŒæŠŠå¡ç‰Œå›¾ç‰‡å¡«è¿›å»ï¼Œè®©å…‰åªæ˜¾ç¤ºåœ¨æœ‰åƒç´ çš„åœ°æ–¹ */
            -webkit-mask-size: contain;
            mask-size: contain;
            -webkit-mask-repeat: no-repeat;
            mask-repeat: no-repeat;
            -webkit-mask-position: center;
            mask-position: center;

            opacity: 0; 
            pointer-events: none !important; 
            z-index: 10;
            transition: opacity 0.2s; 
            
        }

        /* =========================================
        [ç¾åŒ–] ç»Ÿä¸€å¡ç‰Œé¡µé¢èƒŒæ™¯ (ä¸äººç‰©é¡µä¸€è‡´)
        ========================================= */

    /* 1. ç»™å¤–å±‚é¡µé¢ç©¿ä¸Šâ€œäººç‰©é¡µåŒæ¬¾â€çš®è‚¤ */
    #view-cards {
    background-color: #353535;
    background-image: radial-gradient(var(--bqv-dot-color) var(--bqv-dot-size), transparent var(--bqv-dot-size));
    background-size: var(--bqv-dot-gap) var(--bqv-dot-gap);
    scroll-behavior: smooth;
}

    /* 2. è®©é‡Œé¢çš„å¡ç‰Œå®¹å™¨å˜é€æ˜ (å»æ‰é‚£å—å¥‡æ€ªçš„é»‘è‰²/æ·±ç°) */
    .bqc-main-container {
        /* å¼ºåˆ¶é€æ˜ï¼Œè®©ä¸Šé¢çš„ç½‘æ ¼é€å‡ºæ¥ */
        background-color: transparent !important; 
        
        /* ç¨å¾®è°ƒæ•´ä¸€ä¸‹å†…è¾¹è·ï¼Œè®©è§†è§‰æ›´å¹³è¡¡ */
        padding-top: 0 !important;
    }

        /* =========================================
        [ç‹¬ç«‹æ§åˆ¶] å¡ç‰Œå¼¹çª—æŒ‰é’®ä½ç½®
        ========================================= */
    .bqc-nav-pos {
        /* 1. å¼ºåˆ¶å›ºå®šåœ¨å±å¹•ä¸Šï¼Œä¸å—çˆ¶å®¹å™¨å½±å“ */
        position: fixed !important; 
        
        /* 2. å‚ç›´ä½ç½®ï¼šè·ç¦»å±å¹•åº•éƒ¨å¤šå°‘åƒç´  */
        /* æƒ³å¾€ä¸Šç§»å°±æ”¹å¤§(å¦‚ 100px)ï¼Œå¾€ä¸‹ç§»å°±æ”¹å° */
        bottom: 430px; 
        
        /* 3. æ°´å¹³ä½ç½®ï¼šç»å¯¹å±…ä¸­ */
        left: 50%;
        transform: translateX(-50%);
        
        /* 4. æŒ‰é’®é—´è·ï¼šæ§åˆ¶ä¸¤ä¸ªç®­å¤´éš”å¤šè¿œ */
        /* å»ºè®®è®¾ç½®å®½ä¸€ç‚¹(å¦‚ 200px)ï¼Œé¿å…æŒ¡ä½å¡ç‰Œæ–‡å­— */
        gap: 900px; 
        
        /* 5. å±‚çº§ï¼šä¿è¯æµ®åœ¨ä¸€åˆ‡ä¹‹ä¸Š */
        z-index: 12000;
        
        /* 6. (å¯é€‰) å¦‚æœæƒ³è®©æŒ‰é’®å˜å¤§ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨è¿™é‡ŒåŠ  scale */
        /* transform: translateX(-50%) scale(1.2); */
    }

/* =========================================
   [æ ¸å¿ƒé€‚é…] ç§»åŠ¨ç«¯/ç«–å± (æ•´ä½“ç¼©æ”¾ç‰ˆ)
   ========================================= */

@media (max-width: 1000px) {
    /* === 1. [ä¿®å¤] å¡ç‰Œå¤§å›¾çš„å·¦å³æŒ‰é’® (æ‰‹æœºç‰ˆ) === */
    .bqc-nav-pos {
        /* 1. ä½ç½®è°ƒæ•´ï¼šç¨å¾®å¾€ä¸Šæä¸€ç‚¹ï¼Œæ”¾åœ¨æ‰‹æŒ‡å®¹æ˜“å¤Ÿåˆ°çš„åœ°æ–¹ */
        bottom: 30px !important;
        
        /* 2. å®½åº¦é™åˆ¶ï¼šå æ»¡å±å¹•å®½åº¦ï¼Œä½†ç•™å‡ºè¾¹è· */
        width: 100% !important;
        padding: 0 20px !important;
        
        /* 3. æ ¸å¿ƒï¼šå–æ¶ˆ 900px é—´è·ï¼Œæ”¹ä¸ºä¸¤ç«¯å¯¹é½ */
        gap: 0 !important;
        justify-content: space-between !important;
        
        /* 4. ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
        z-index: 13000 !important;
    }

    

/* 2. [è°ƒæ•´] åº•éƒ¨å¯¼èˆªæŒ‰é’® (å¤§æŒ‰é’® + ä¸¤ä¾§å¯¹é½) */
    .nav-controls:not(.bqc-nav-pos) {
        position: absolute !important;
        top: auto !important;     
        
        /* æŒ‚åœ¨æµ®çª—å±è‚¡ä¸‹é¢ */
        bottom: -250px !important; 
        
        left: 50% !important;
        transform: translateX(-50%) !important;
        
        /* ã€æ”¹è¿™é‡Œã€‘å®½åº¦è®¾ä¸º 100% (æˆ–è€…å’Œæµ®çª—ä¸€æ ·å®½)ï¼Œè®©æŒ‰é’®æ’‘åˆ°ä¸¤è¾¹ */
        width: 95% !important;   
        max-width: 960px !important; /* é™åˆ¶ä¸€ä¸‹æœ€å¤§è·ç¦»ï¼Œé˜²æ­¢iPadä¸Šå¤ªè¿œ */
        
        display: flex !important;
        
        /* ã€æ”¹è¿™é‡Œã€‘Space Between = æ’‘å¼€åˆ°ä¸¤å¤´ */
        justify-content: space-between !important; 
        
        gap: 0 !important;     
        padding: 0 10px !important;
        z-index: 12000 !important;
        pointer-events: none !important; 
    }
  
    /* 3. [è°ƒæ•´] æŒ‰é’®å˜å¤§ */
    .nav-controls:not(.bqc-nav-pos) .nav-btn-char {
        pointer-events: auto !important;
        background: rgba(30, 30, 30, 0.9) !important;
        border: 1px solid #777 !important;
        
        /* ã€æ”¹è¿™é‡Œã€‘åŠ å¤§å°ºå¯¸ï¼Œæ–¹ä¾¿æ‰‹æŒ‡ç‚¹å‡» */
        width: 150px !important;  
        height: 150px !important;
        font-size: 28px !important;
        border-radius: 50%;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    }
/* ä¸“é—¨æ§åˆ¶å¡ç‰Œæµ®çª—æŒ‰é’® */
.bqc-nav-pos .nav-btn-char {
    width: 70px !important;   /* æ¯”å¦‚å¡ç‰Œçš„æƒ³å°ä¸€ç‚¹ */
    height: 70px !important;
    font-size: 20px !important;
}

/* ä¿®æ”¹é®ç½©å±‚çš„å¯¹é½æ–¹å¼ */
    .bqc-modal-overlay {
        /* 1. åŸæ¥æ˜¯ center (å±…ä¸­)ï¼Œç°åœ¨æ”¹ä¸º flex-start (é¡¶ç«¯å¯¹é½) */
        align-items: flex-start !important;
        
        /* 2. ç»™é¡¶éƒ¨ç•™å‡ºè·ç¦» (æ¯”å¦‚ 10% çš„å±å¹•é«˜åº¦) */
        /* æ‚¨å¯ä»¥è°ƒæ•´è¿™ä¸ªå€¼ï¼šè¶Šå°è¶Šé ä¸Šï¼Œè¶Šå¤§è¶Šé ä¸‹ */
        padding-top: 3vh !important; 
    }

/* 2. [å…¨å±€ä¿®å¤] é€šç”¨é¡µé¢å®¹å™¨ï¼šæ‰‹æœºç«¯é€‚é…ç­–ç•¥ */
    /* é€»è¾‘ï¼šç»§æ‰¿ç”µè„‘ç«¯çš„é¡¶éƒ¨å¤§ç•™ç™½(40px)ï¼Œåªå‹ç¼©å·¦å³ä¸¤è¾¹ */
    .archive-container, 
    .rules-wrapper {
        /* å†™æ³•ï¼šä¸Š å³ ä¸‹ å·¦ */
        /* ä¸Š: 40px (æ­»å®ˆè¿™ä¸ªé˜²çº¿ï¼Œé˜²æ­¢ä¸Šçªœï¼) */
        /* å³: 15px (æ‰‹æœºå±å¹•çª„ï¼Œçœç©ºé—´) */
        /* ä¸‹: 20px (åº•éƒ¨ç•™ç‚¹ç©º) */
        /* å·¦: 15px (åŒå³) */
        padding: 40px 15px 20px 15px !important; 
        
        /* ç¡®ä¿å®½åº¦å æ»¡ */
        width: 100% !important;
        max-width: 100% !important;
    }

    /* 3. [ä¿®å¤] è§„åˆ™é¡µå†…éƒ¨å°èŠ‚ */
    .rule-section {
        padding: 15px !important; 
        margin-bottom: 30px !important;
    }
    
/* [ä¿®å¤] æ‰‹æœºç«¯è¿˜åŸï¼šå“ˆå°¼ç»„å…³æ‰ç€‘å¸ƒæµï¼Œæ¢å¤ 1 åˆ— */
    .society-grid, #group-HANI .society-grid {
        display: grid !important;
        grid-template-columns: 1fr !important;
        column-count: 1 !important;
    }

    /* [ä¿®å¤] æ‰‹æœºç«¯å“ˆå°¼å“ˆå°¼ä¸è¦ 3 åˆ—ï¼Œæ¢å¤æˆæ™®é€šçš„ 1åˆ—æˆ– 1 åˆ— */
    #society-card-honeyhoney .char-list > div {
        grid-template-columns: repeat(1, 1fr) !important;
        gap: 12px !important;
    }

/* ... åœ¨ @media (max-width: 1000px) å†…éƒ¨ ... */

    /* 1. [ç»ˆæä¿®å¤] æµ®çª—æœ¬ä½“ (æ¾ç»‘ç‰ˆ) */
    .char-modal-window {
        display: grid !important;
        grid-template-columns: 376px 1fr !important;
        width: 960px !important;
        min-width: 960px !important;
        height: 640px !important;
        
        /* === ã€å…³é”®ä¿®æ”¹ã€‘ === */
        /* å…¨éƒ¨å½’é›¶ï¼ŒæŠŠä½ç½®æ§åˆ¶æƒ 100% äº¤ç»™ JS çš„ transform */
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        margin: 0 !important;
        
        /* è®¾å®šåŸºç‚¹ä¸ºå·¦ä¸Šè§’ */
        transform-origin: top left !important;
        
        /* å…è®¸æŒ‰é’®æº¢å‡º */
        overflow: visible !important; 
        box-shadow: 0 10px 40px rgba(0,0,0,0.8) !important;
    }

    
    /* æ¢å¤å†…éƒ¨å¸ƒå±€ */
    .modal-left { height: 100% !important; width: 100% !important; border-right: 1px solid #333 !important; border-bottom: none !important; }
    .modal-right { overflow: hidden !important; }
    .modal-top-row { grid-template-columns: 1fr 1.2fr !important; height: 360px !important; gap: 30px !important; }
    .stats-panel { padding: 20px !important; border: 1px solid #2a2a2a00 !important; }
    .attr-slots { justify-content: flex-end !important; padding-right: 50px !important; }
    .modal-bottom-row { grid-template-columns: 1fr 150px !important; display: grid !important; padding-bottom: 0 !important; }
    .logos-area { flex-direction: column !important; height: 100% !important; margin-top: 0 !important; }
    
    /* === 3. [ä¿®å¤] å¤§å¤–å·ï¼šé˜²æ­¢å³ä¾§è¢«åˆ‡ === */
    .broken-name {
        position: absolute !important;
        
        /* æ”¾åœ¨ç«‹ç»˜çš„å·¦ä¸‹è§’ä½ç½® */
        bottom: 10px !important; 
        left: 10px !important;
        top: auto !important;
        right: auto !important;
        
        /* å­—ä½“è°ƒæ•´ */
        font-size: 60px !important;
        line-height: 0.9 !important; /* è¡Œé«˜ç´§å‡‘ç‚¹ */
        
        /* å±‚çº§ */
        z-index: 15 !important;
        opacity: 1 !important;
        
        /* === æ ¸å¿ƒé˜²åˆ‡ä»£ç  === */
        width: auto !important;
        max-width: 90% !important; /* é™åˆ¶æœ€å¤§å®½åº¦ */
        
        /* å…è®¸æ–‡å­—æŠ˜è¡Œ (ä¸‡ä¸€åå­—å¤ªé•¿) */
        white-space: normal !important; 
        word-break: break-word !important;
        
        /* å¯¹é½æ–¹å¼ */
        text-align: left !important;
    }

/* === [ä¿®æ”¹] 1. æˆ˜æ–—ç«‹ç»˜ï¼šæ¬åˆ°å³ä¸Šè§’ === */
.broken-portrait-container {
    /* ä»¥å‰æ˜¯ bottom:0, left:0... ç°åœ¨æ”¹ä¸ºï¼š */
    position: fixed !important;
    top: 0 !important;           /* é¡¶ç«¯å¯¹é½ */
    right: 0 !important;         /* å³ä¾§å¯¹é½ */
    bottom: auto !important;     /* åº•éƒ¨æ¾ç»‘ */
    left: auto !important;       /* å·¦ä¾§æ¾ç»‘ */
    
    width: 100vw !important;      /* å®½åº¦ä¸ç”¨å æ»¡ï¼Œç•™ç‚¹ç©ºé—´ç»™åå­— */
    height: 60vh !important;     /* é«˜åº¦é™åˆ¶åœ¨ä¸ŠåŠå± */
    
    /* å†…éƒ¨å¯¹é½ï¼šé ä¸Šã€é å³ */
    display: flex !important;
    align-items: flex-start !important; 
    justify-content: flex-end !important;
    
    z-index: 1005 !important;
}

.broken-portrait-img {
    width: auto !important;      /* è‡ªåŠ¨å®½åº¦ */
    height: 100% !important;     /* æ’‘æ»¡å®¹å™¨é«˜åº¦ */
    max-width: 100% !important;
    max-height: none !important;
    
    margin: 0 !important;
    /* é”šç‚¹è®¾ä¸ºå³ä¸Šï¼Œä¿è¯è„¸éœ²å‡ºæ¥ */
    object-fit: contain; 
    object-position: top right !important; 
    
}


/* === [ä¿®å¤] æ‰‹æœºç«¯å¤§å¤–å·ï¼šåªæ”¹ä½ç½®ï¼Œä¿ç•™æ¸å˜ç‰¹æ•ˆ === */
    .broken-name {
        /* 1. ä½ç½®ï¼šå›ºå®šåœ¨å·¦ä¸‹è§’ */
        position: absolute !important;
        bottom: 20px !important;   /* è·ç¦»åº•éƒ¨ */
        left: 15px !important;     /* è·ç¦»å·¦ä¾§ */
        top: auto !important; 
        right: auto !important;
        
        /* 2. å­—ä½“å¤§å° */
        font-size: 55px !important; /* æ‰‹æœºä¸Šç¨å¾®å°ä¸€ç‚¹ï¼Œå¤ªå¤§å®¹æ˜“æ¢è¡Œ */
        line-height: 1 !important;
        
        /* 3. å¸ƒå±€é™åˆ¶ */
        width: auto !important;
        max-width: 80vw !important; /* é™åˆ¶å®½åº¦ï¼Œé˜²æ­¢é¡¶åˆ°å³è¾¹çš„ç«‹ç»˜ */
        
        /* 4. å…è®¸æ¢è¡Œ (å…³é”®ï¼šé…åˆä¼ªå…ƒç´ ç»§æ‰¿) */
        white-space: normal !important; 
        word-break: break-word !important;
        text-align: left !important;
        
        /* 5. ç¡®ä¿å›¾å±‚æ˜¾ç¤º */
        z-index: 15 !important;
        opacity: 1 !important;
        
        /* ã€å…³é”®ã€‘ä¸è¦å†™ content: noneï¼Œä¹Ÿä¸è¦å†™ display: none */
    }

    /* ã€å…³é”®ä¿®å¤ã€‘è®©æ¸å˜å±‚å’Œæè¾¹å±‚ä¹Ÿä¹–ä¹–è·Ÿéšæ¢è¡Œ */
    .broken-name::before,
    .broken-name::after {
        left: 0 !important;
        top: 0 !important;
        width: 100% !important;
        height: 100% !important;
        white-space: inherit !important; /* ç»§æ‰¿æœ¬ä½“çš„æ¢è¡Œè®¾ç½® */
    }

}
/* === å¡ç‰Œè·³è½¬èœå•æ ·å¼ === */
    .jump-menu-overlay {
        display: none; /* é»˜è®¤éšè— */
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); z-index: 5000;
        justify-content: center; align-items: center;
        backdrop-filter: blur(5px);
    }
    .jump-menu-overlay.active { display: flex; }
    
    .jump-menu-content {
        background: #222; border: 2px solid #555; border-radius: 10px;
        width: 300px; padding: 20px; text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,1);
    }
    .jump-title {
        color: #fff; font-size: 18px; font-weight: bold; margin-bottom: 20px;
        border-bottom: 1px solid #444; padding-bottom: 10px;
    }
    
    .jump-btn {
        display: block; width: 100%; padding: 15px; margin-bottom: 10px;
        background: #333; color: #ccc; border-radius: 6px; cursor: pointer;
        font-weight: bold; transition: 0.2s; border-left: 5px solid transparent;
    }
    .jump-btn:hover { background: #444; color: #fff; transform: translateX(5px); }

        /* =========================================
        [ç»ˆæä¿®å¤] é¼ æ ‡ç‚¹å‡»ç©¿é€è¡¥ä¸
        ========================================= */

    /* 1. ä¿®å¤æŒ‰é’®å®¹å™¨ï¼šè®©ä¸­é—´çš„ç©ºéš™å…è®¸ç©¿é€ */
    .nav-controls, .bqc-nav-pos {
        /* å®¹å™¨æœ¬èº«å˜æˆç©ºæ°”ï¼Œä¸æŒ¡é¼ æ ‡ */
        pointer-events: none !important; 
        
        /* ç¡®ä¿è¾¹æ¡†å’ŒèƒŒæ™¯ä¹Ÿä¸æŒ¡ (è™½ç„¶ç°åœ¨æ²¡æœ‰) */
        background: transparent !important; 
    }

    /* 2. ä¿®å¤æŒ‰é’®æœ¬ä½“ï¼šæŒ‰é’®å¿…é¡»èƒ½ç‚¹ */
    .nav-btn-char {
        /* æ¢å¤æŒ‰é’®çš„ç‚¹å‡»åŠŸèƒ½ */
        pointer-events: auto !important; 
    }

    /* 3. ä¿®å¤åå…‰å±‚ï¼šç¡®ä¿å®ƒæ˜¯ç©ºæ°” */
    .bqc-card-shine {
        pointer-events: none !important; 
    }

    /* 4. ä¿®å¤å¤§å›¾å®¹å™¨ï¼šå¼ºåˆ¶æ˜¾ç¤ºå°æ‰‹ */
    /* åªè¦é¼ æ ‡åœ¨è¿™ä¸ªåŒºåŸŸå†…ï¼Œä¸ç®¡æ‘¸åˆ°è°ï¼Œéƒ½æ˜¾ç¤ºå°æ‰‹ */
    .bqc-modal-content, 
    .bqc-modal-img {
        cursor: pointer !important; 
    }


/* [ä¿®æ”¹] æ™¯è‰²é ç¸½å®¹å™¨ï¼šåªä¿ç•™é»é»ç´‹ç†ï¼Œå»æ‰åº•è‰² */
#view-scenery {
    background-image: radial-gradient(var(--bqv-dot-color) var(--bqv-dot-size), transparent var(--bqv-dot-size));
    background-size: var(--bqv-dot-gap) var(--bqv-dot-gap);

    background-color: #353535;      /* çµ¦å€‹å…¨é»‘åº•è‰²é˜²æ­¢é–ƒçˆ */
}

/* [ä¿®æ”¹] æ¯å€‹æ¿å¡Šçš„åˆ†çµ„å®¹å™¨ï¼šæ·»åŠ éæ¸¡æ•ˆæœ */
.bqv-group-section {
    position: relative; 
    width: 100%; 
    padding-bottom: 80px;
    /* é€™è£¡çš„ background-color æœƒè¢« JS å‹•æ…‹æ³¨å…¥çš„æ¼¸è®Šè¦†è“‹ */
    transition: background 0.5s ease; 
}

/* æ™¯è‰²å°ˆç”¨ Sticky Bar (å¾©ç”¨äººç‰©é é‚è¼¯) */
.bqv-sticky-bar {
    width: 100%; height: 40px;
    display: flex; align-items: center; gap: 15px;
    padding: 0 40px;
    background: linear-gradient(90deg, #121212 0%, #000 100%);
    border-top: 1px solid #333;
    border-bottom: 1px solid #000;
    border-left: 8px solid; /* é¡è‰²ç”±æ¸²æŸ“å‹•æ…‹æ³¨å…¥ */
    position: sticky; top: 0; z-index: 100;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    
}

.bqv-bar-title {
    font-size: 16px; font-weight: 900; letter-spacing: 2px;
    color: #fff; text-transform: uppercase;
}

/* åˆ†çµ„å®¹å™¨ */
.bqv-group-section {
    position: relative; width: 100%; padding-bottom: 80px;
}

/* 16:9 æµ·å ±åœ–ç‰‡ (é ­å°¾) */
.bqv-poster {
    width: 100%; aspect-ratio: 2.828 / 1;
    object-fit: cover; display: block;
}

/* 2.828 : 1 æ¯”ä¾‹çš„å®½æµ·æŠ¥ (ç”¨äºåˆ—è¡¨å¤´éƒ¨) */
.header-poster-28 {
    width: 100%;
    /* æ ¸å¿ƒï¼šé”å®šæ¯”ä¾‹ */
    aspect-ratio: 2.828 / 1; 
    /* å›¾ç‰‡å¡«å……æ–¹å¼ï¼šè£å‰ªä¸¤è¾¹ï¼Œä¿è¯å¡«æ»¡ä¸å˜å½¢ */
    object-fit: cover; 
    display: block;
    /* ç´§è´´ä¸‹æ–¹çš„æ ‡é¢˜æ ï¼Œä¸è¦ç•™ç™½ */
    margin-bottom: 0; 
    
    /* å¯é€‰ï¼šå¦‚æœä½ æƒ³è®©æµ·æŠ¥ä¹Ÿæœ‰ä¸ªå°é˜´å½± */
    position: relative;
    z-index: 1;
}

/* å…§å®¹ç´„æŸå±¤ (80% å¯¬åº¦) */
.bqv-content-wrap {
    width: 80%; margin: 0 auto; padding-top: 40px;
}

/* æ¯›ç»ç’ƒæ–‡å­—å¡ (1/3 å¯¬åº¦) */
.bqv-glass-card {
    width: 33.33%; min-width: 300px;
    background: var(--bqv-glass-bg);
    backdrop-filter: blur(var(--bqv-glass-blur));
    -webkit-backdrop-filter: blur(var(--bqv-glass-blur));
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 4px; padding: 25px;
    color: #ccc; line-height: 1.8; font-size: 14px;
    box-shadow: inset 0 0 20px rgba(255,255,255,0.05);
    margin-bottom: 50px;
    margin: 0 auto; max-width: 90%;
}

/* ç…§ç‰‡ç¶²æ ¼ */
.bqv-photo-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 40px;
}

/* å–®å¼µç…§ç‰‡æ“¬ç‰©åŒ– */
.bqv-photo-item {
    aspect-ratio: 16 / 9;
    background: #000;
    border: var(--bqv-photo-border) solid #000;
    box-shadow: var(--bqv-photo-shadow);
    transition: transform 0.3s ease;
    overflow: hidden;
    /* === [æ–°å¢] è®“é¼ æ¨™æ‡¸åœæ™‚è®Šæˆå°æ‰‹ === */
    cursor: pointer;
}

.bqv-photo-item img {
    width: 100%; height: 100%; object-fit: cover;
}

/* æ‡¸åœæ•ˆæœ */
.bqv-photo-item:hover {
    transform: scale(1.05) rotate(0deg) !important;
    z-index: 10;
}

/* æ‰‹æ©Ÿç«¯é©é… */
@media (max-width: 1000px) {
    .bqv-content-wrap { width: 90%; }
    .bqv-glass-card { width: 100%; }
    .bqv-photo-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .bqv-sticky-bar { padding: 0 20px; }
}

/* æ–‘ä¸˜æ™¯è‰²æµ®çª—é®ç½© */
.bqv-modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(85, 85, 85, 0.9);
    backdrop-filter: blur(10px);
    z-index: 15000; display: none;
    flex-direction: column; align-items: center;
}

/* å·¦ä¸Šè§’æ¿å— Logo */
.bqv-modal-logo-box {
    position: absolute; top: 20px; left: 20px;
    display: flex; align-items: center; gap: 0px;
    background: rgba(0,0,0,0.5); padding: 8px 8px;
    border-radius: 4px; border: 1px solid rgba(255,255,255,0.1);
}
.bqv-modal-logo-box img { width: 80px; height: 80px; object-fit: contain; }
.bqv-modal-logo-box span { color: #fff; font-size: 14px; font-weight: bold; letter-spacing: 1px; }

/* å…³é—­æŒ‰é’® */
.bqv-modal-close {
    position: absolute; top: 15px; right: 25px;
    font-size: 40px; color: #666; cursor: pointer; transition: 0.2s;
}
.bqv-modal-close:hover { color: #fff; }

/* å›¾ç‰‡å®¹å™¨ï¼šå æ®å±å¹•ä¸­ä¸Šæ–¹ 70% ç©ºé—´ */
.bqv-modal-content {
    width: 90%; height: 84vh; /* å±å¹•é«˜åº¦çš„ 70% */
    margin-top: 2vh; /* é¡¶éƒ¨ç•™ç™½ */
    display: flex; align-items: center; justify-content: center;
}
.bqv-modal-content img {
    max-width: 100%; max-height: 100%;
    object-fit: contain;
    border: 5px solid #000;
    box-shadow: 0 0 50px rgba(0,0,0,1);
}

/* åº•éƒ¨å±…ä¸­å¯¼èˆªæŒ‰é’® */
.bqv-modal-controls {
    margin-top: 30px;
    display: flex; gap: 80px;
    justify-content: center;
}
.bqv-ctrl {
    width: 60px !important; height: 60px !important;
    background: rgba(40, 40, 40, 0.8) !important;
    font-size: 24px !important;
}

/* === å¡ç‰Œé¡µè¡¨æ ¼ä¸“ç”¨å®¹å™¨ (ä¸å¡ç‰Œç½‘æ ¼å®½åº¦å¯¹é½) === */
.bqc-table-wrapper {
    width: 100%;
    /* ã€æ ¸å¿ƒã€‘è¿™é‡Œå¿…é¡»å’Œ .bqc-grid çš„ max-width ä¸€æ¨¡ä¸€æ · */
    max-width: 1400px; 
    
    margin: 0 auto;      /* å±…ä¸­ */
    padding: 0 20px;     /* å·¦å³ç•™ç™½ (å’Œå¡ç‰Œç½‘æ ¼ä¸€è‡´) */
    box-sizing: border-box;
    margin-bottom: 60px; /* æŠŠä¹‹å‰çš„ä¸‹è¾¹è·æ¬åˆ°è¿™é‡Œæ¥ */
}

/* æ‰‹æœºç«¯é€‚é… (ä¿æŒåŒæ­¥) */
@media (max-width: 768px) {
    .bqc-table-wrapper {
        padding: 0 10px; /* æ‰‹æœºä¸Šç•™ç™½å˜å° */
    }
}


/* 
        <div class="nav-btn" onclick="switchView('attrs', this, 'å±æ€§å—')">å±æ€§å—ğŸš§æ–½å·¥ä¸­ğŸš§</div> 
        <div class="nav-btn" onclick="switchView('gallery', this, 'æˆ˜æ–—ç”»å»Š')">æˆ˜æ–—ç”»å»ŠğŸš§æ–½å·¥ä¸­ğŸš§</div> 
        <div class="nav-btn" onclick="switchView('rules', this, 'æ–‘ä¸˜è§„åˆ™')">æ–‘ä¸˜è§„åˆ™</div> 
*/
/* ================= å‰§æƒ…å¤‡å¿˜å½• (Markdown ä¸“ç”¨) ================= */

/* 1. å¤–å±‚å®¹å™¨ï¼šæ§åˆ¶æ•´ä½“å®½åº¦ */
.story-wrapper {
    width: 100%;
    max-width: 1400px; /* é™åˆ¶æœ€å¤§å®½åº¦ï¼Œé˜²æ­¢åœ¨å¤§å±å¤ªæ•£ */
    margin: 0 auto;
    display: flex;
    gap: 40px; /* æ–‡ç« å’Œç›®å½•çš„é—´è· */
    padding: 40px;
    box-sizing: border-box;
    position: relative;
}

/* === åŠ‡æƒ…å…§å®¹å€ï¼šå¢åŠ æ¯›ç»ç’ƒèƒŒæ™¯å¡ç‰‡ === */
.story-content {
    flex: 4; 
    min-width: 0;
    color: #ddd;
    line-height: 1.8;

    /* 1. åŠé€æ˜èƒŒæ™¯ (é¡è‰²å¯æ ¹æ“šå–œå¥½å¾®èª¿ï¼Œ0.6 æ˜¯é€æ˜åº¦) */
    background: rgba(99, 99, 99, 0.6); 

    /* 2. æ ¸å¿ƒï¼šæ¯›ç»ç’ƒæ¨¡ç³Šæ•ˆæœ */
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px); /* å…¼å®¹ Safari ç€è¦½å™¨ */

    /* 3. å…§é‚Šè·ï¼šé€™æ±ºå®šäº†èƒŒæ™¯æ¯”æ–‡å­—ã€Œå¯¬å‡ºå¤šå°‘ã€ */
    /* ä¸Šä¸‹ 40pxï¼Œå·¦å³ 50px */
    padding: 40px 50px; 

    /* 4. åœ“è§’èˆ‡é‚Šæ¡†å¢åŠ è³ªæ„Ÿ */
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.1); /* æ¥µç´°çš„åŠé€æ˜é‚Šæ¡†ï¼Œæ¨¡æ“¬ç»ç’ƒé‚Šç·£ */
    
    /* 5. é™°å½±è®“å¡ç‰‡æ›´æœ‰å±¤æ¬¡æ„Ÿ */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);

    /* ç¢ºä¿åœ¨æ‰‹æ©Ÿç«¯ä¹Ÿèƒ½æ­£å¸¸é¡¯ç¤º */
    box-sizing: border-box; 
}

/* ç‚ºäº†è®“æ–‡å­—åœ¨ç»ç’ƒèƒŒæ™¯ä¸Šæ›´æ¸…æ™°ï¼Œå¯ä»¥å¾®èª¿æ¨™é¡Œé¡è‰² */
.story-content h1, .story-content h2 {
    text-shadow: 0 2px 4px rgba(0,0,0,0.5); /* çµ¦æ¨™é¡ŒåŠ é»é™°å½± */
}

/* é©é…ï¼šå¦‚æœèƒŒæ™¯å¤ªæš—ï¼Œåœ–ç‰‡å¯ä»¥ç¨å¾®åŠ ä¸€é»äº®åº¦ */
.story-content img {
    border: 0px solid rgba(255, 255, 255, 0.05);
}

/* 3. å³ä¾§ç›®å½•åŒºï¼šå›ºå®šå®½åº¦ */
.story-sidebar {
    width: 280px;
    flex-shrink: 0;
    display: block;
}

/* ================= å‰§æƒ…ç›®å½•ï¼šæ‰‹é£ç´æŒ‰é’®ç‰ˆ ================= */

.story-toc-container {
    position: sticky;
    top: 0px; 
    background: rgba(20, 20, 20, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid #444;
    border-radius: 8px;
    padding: 10px;
    max-height: 95vh;
    overflow-y: auto;
    
    /* ã€æ ¸å¿ƒã€‘éšè—æ»šåŠ¨æ¡ï¼Œä½†ä¿ç•™æ»šåŠ¨åŠŸèƒ½ */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
}
.toc-title {
    font-size: 16px; font-weight: bold; color: #fff;
    margin-bottom: 15px; padding-bottom: 10px;
    border-bottom: 1px solid #444;
}

.story-toc-container::-webkit-scrollbar {
    display: none; /* Chrome/Safari */
}

/* ç›®å½•ç»„å®¹å™¨ */
.toc-group {
    margin-bottom: 8px;
    border-radius: 4px;
    overflow: hidden;
}

/* ä¸€çº§æ ‡é¢˜æŒ‰é’® (çŸ©å½¢) */
.toc-h1-btn {
    width: 100%;
    padding: 12px 15px;
    background: #333;
    color: #aaa;
    font-size: 14px;
    font-weight: bold;
    text-align: left;
    cursor: pointer;
    border: none;
    border-left: 4px solid transparent;
    transition: all 0.3s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.toc-h1-btn:hover {
    background: #444;
    color: #fff;
}

/* ä¸€çº§æ ‡é¢˜æ¿€æ´»/é˜…è¯»ä¸­çŠ¶æ€ */
.toc-group.active .toc-h1-btn {
    background: #222;
    color: #DC143C; /* æ˜é»„è‰²é«˜äº® */
    border-left-color: #DC143C;
}

/* å±•å¼€æŒ‡ç¤ºç®­å¤´ */
.toc-h1-btn::after {
    content: 'â–¶';
    font-size: 10px;
    transition: transform 0.3s;
}
.toc-group.expanded .toc-h1-btn::after {
    transform: rotate(90deg);
}

/* æ¬¡çº§æ ‡é¢˜å®¹å™¨ - é»˜è®¤æŠ˜å  */
.toc-sub-items {
    max-height: 0;
    overflow: hidden;
    background: rgba(0, 0, 0, 0.2);
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* å±•å¼€çŠ¶æ€ */
.toc-group.expanded .toc-sub-items {
    max-height: 1000px; /* è¶³å¤Ÿå¤§çš„å€¼ä»¥å®¹çº³å­é¡¹ */
}

/* äºŒçº§/ä¸‰çº§çœŸå®è·³è½¬æ¡ */
.toc-link {
    display: block;
    padding: 10px 15px 10px 30px;
    font-size: 13px;
    color: #888;
    text-decoration: none;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    cursor: pointer;
    transition: 0.2s;
}

.toc-link:hover {
    color: #DC143C;
    background: rgba(255, 0, 0, 0.1);
}

.toc-link.level-3 {
    padding-left: 45px;
    font-size: 12px;
    opacity: 0.8;
}
/* äºŒçº§æ ‡é¢˜ç¼©è¿› */
.toc-item.level-2 { margin-left: 15px; font-size: 13px; }

/* === Markdown å†…å®¹æ ·å¼ (æ¨¡ä»¿ Notion é»‘å¤œæ¨¡å¼) === */
.story-content h1 { font-size: 2.5em; color: #fff; border-bottom: 1px solid #333; padding-bottom: 0.3em; margin-top: 1em; }
.story-content h2 { font-size: 1.8em; color: #eee; margin-top: 1.5em; border-left: 5px solid #DC143C; padding-left: 15px; }
.story-content h3 { font-size: 1.4em; color: #ddd; margin-top: 1.2em; }
.story-content p { margin-bottom: 1em; font-size: 16px; color: #dbdbdb; }
.story-content strong { color: #fff; font-weight: 900; }
.story-content blockquote { border-left: 4px solid #555; padding-left: 15px; color: #888; background: #1a1a1a; padding: 10px 15px; border-radius: 4px;}
.story-content code { background: #333; padding: 2px 5px; border-radius: 3px; color: #ff7b72; font-family: monospace; }
.story-content pre { background: #161616; padding: 15px; border-radius: 6px; overflow-x: auto; border: 1px solid #333; }

/* å‰§æƒ…é¡µè¡¨æ ¼æ ·å¼ä¿®å¤ */
.story-content table {
    width: 100%;
    border-collapse: collapse;
    margin: 24px 0;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid #444;
    font-size: 14px;
}
.story-content th {
    background: rgba(0, 0, 0, 0.3);
    color: #fff;
    font-weight: bold;
    border: 1px solid #444;
    padding: 12px;
    text-align: left;
}
.story-content td {
    border: 1px solid #444;
    padding: 10px 12px;
    color: #ccc;
}
/* æ–‘ä¸˜ç‰¹è‰²çš„ç²—ç²èƒ¶ç‰‡æ„Ÿï¼šè¡¨æ ¼å¥‡å¶è¡Œå˜è‰² */
.story-content tr:nth-child(even) {
    background: rgba(255, 255, 255, 0.02);
}

/* å›¾ç‰‡è‡ªé€‚åº”ï¼šæ‰‹æœºç”µè„‘éƒ½è‡ªåŠ¨ç¼©æ”¾ */
.story-content img {
    max-width: 100%;
    height: auto;
    border-radius: 6px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    margin: 20px 0;
    display: block;
}

/* åªæœ‰é€™å…©è¡Œå°äº†ï¼ŒäºŒç´šæ¨™é¡Œé«˜äº®æ‰æœƒé¡¯ç¤ºå‡ºä¾† */
.toc-link.active {
    color: #DC143C !important; /* é‡‘è‰² */
    background: rgba(255, 0, 0, 0.1);
    font-weight: bold;
    border-right: 3px solid #DC143C;
}

/* ä¸€ç´šæ¨™é¡Œæ¿€æ´»æ™‚çš„æ¨£å­ */
.toc-group.active .toc-h1-btn {
    color: #fff;
    background: rgba(255, 255, 255, 0.05);
    border-left-color: #DC143C;
}

/* === æ‰‹æœºç«¯é€‚é… (å…¨å®½ï¼Œéšè—ç›®å½•) === */
@media (max-width: 1000px) {
    .story-wrapper {
        flex-direction: column; /* ä¸Šä¸‹æ’åˆ— */
        padding: 10px; /* å‡å°‘ç•™ç™½ */
    }
    .story-sidebar {
        display: none; /* æ‰‹æœºå¤ªçª„ï¼Œç›´æ¥éšè—å³ä¾§ç›®å½• */
    }
.story-content {
        /* ä¿®æ”¹è¿™é‡Œï¼šåŸå…ˆå¯èƒ½æ˜¯ 30px æˆ– 40px */
        /* å»ºè®®æ”¹ä¸º 15px æˆ– 10pxï¼Œè®©æ–‡å­—å°½é‡æ’‘æ»¡åº•æ¡† */
        padding: 20px 15px !important; 
        
        width: 100% !important;
        margin: 0 auto;
        border-radius: 8px; /* åœ†è§’ä¹Ÿå¯ä»¥ç¨å¾®è°ƒå°ä¸€ç‚¹ */
    }
    
}
/* --- æ‰‹æœºç«¯ç›®å½•æ¡ (æ¯›ç»ç’ƒ) --- */
.mobile-toc-bar {
    display: none; /* é»˜è®¤éšè—ï¼Œä»…æ‰‹æœºæ˜¾ç¤º */
    position: sticky;
    top: 10px;
    left: 2.5%;
    width: 95%;
    height: 44px;
    z-index: 100;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 22px; /* å¤§åœ†è§’ */
    padding: 0 20px;
    align-items: center;
    gap: 12px;
    color: #fff;
    font-size: 14px;
    margin-bottom: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

/* --- ç›®å½•æµ®çª—æ•´ä½“èƒŒæ™¯ --- */
.mobile-toc-modal {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 2000;
}
.mobile-toc-modal.open { display: block; }



/* å¼¹çª—ä¸»ä½“ï¼šå…¨é¢æ¯›ç»ç’ƒåŒ– */
.modal-content {
    position: absolute;
    bottom: 0; left: 0; width: 100%;
    max-height: 75vh; /* ç¨å¾®é™ä½ä¸€ç‚¹é«˜åº¦ */
    /* ã€æ ¸å¿ƒä¿®æ”¹ã€‘ç»ç’ƒè´¨æ„Ÿ */
    background: rgba(25, 25, 25, 0.75); 
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    border-top-left-radius: 25px;
    border-top-right-radius: 25px;
    display: flex;
    flex-direction: column;
    box-shadow: 0 -10px 30px rgba(0,0,0,0.5);
}

/* å¤´éƒ¨æ ï¼šç˜¦èº« */
.modal-header {
    padding: 12px 20px; /* ä» 20px ç¼©å‡åˆ° 12px */
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h3 {
    font-size: 15px; /* å­—ä½“ç¨å¾®è°ƒå° */
    color: rgba(255, 255, 255, 0.8);
    margin: 0;
}

/* å‰å·æŒ‰é’®ï¼šå»èƒŒæ™¯ã€ç˜¦èº«ã€é¢œè‰²æ·¡åŒ– */
.close-btn {
    background: none !important; /* å½»åº•å»æ‰ç™½è‰²èƒŒæ™¯ */
    border: none !important;
    color: rgba(255, 255, 255, 0.5) !important; /* ç°ç™½è‰² */
    font-size: 20px !important; /* å‡å°å°ºå¯¸ */
    cursor: pointer;
    padding: 5px;
    line-height: 1;
    transition: color 0.3s;
}

.close-btn:active {
    color: #fff !important; /* ç‚¹å‡»æ—¶å˜äº® */
}

/* ç›®å½•ä¸»ä½“åŒºåŸŸ */
.mobile-toc-body {
    padding: 10px 15px 30px;
    overflow-y: auto;
}

/* --- æ ¸å¿ƒï¼šå…§å®¹è™›åŒ–å±¤ --- */
/* ç•¶ç›®éŒ„æ‰“é–‹æ™‚ï¼Œè®“åŠ‡æƒ…å…§å®¹åŒ…è£å™¨è®Šæ¨¡ç³Š */
#view-story.toc-open-blur .story-wrapper {
    filter: blur(8px) brightness(0.6); /* 8px è™›åŒ–ï¼Œ60% äº®åº¦ */
    transition: filter 0.4s ease; /* å¹³æ»‘éæ¸¡ */
    pointer-events: none; /* é˜²æ­¢åœ¨ç›®éŒ„æ‰“é–‹æ™‚é‚„èƒ½æ»¾å‹•æˆ–é»æ“ŠèƒŒæ™¯å…§å®¹ */
}

/* ç¢ºä¿æµ®çª—æœ¬èº«ä¸è¢«è™›åŒ– */
#view-story.toc-open-blur .mobile-toc-modal {
    filter: none !important;
}



.modal-content {
    z-index: 2; /* åœ¨é®ç½©ä¹‹ä¸Š */
}

/* æ‰‹æœºç«¯åª’ä½“æŸ¥è¯¢é€‚é… */
@media (max-width: 768px) {
    .mobile-toc-bar { display: flex; }
    .story-sidebar { display: none !important; } /* éšè—ç”µè„‘ä¾§è¾¹æ  */
    .story-wrapper { padding: 10px !important; }
}
/* è®© aside çœ‹èµ·æ¥åƒ Notion çš„å¤‡å¿˜å— */
.story-content aside {
    background: #252525;          /* æ·±è‰²èƒŒæ™¯ */
    border-left: 4px solid #DC143C; /* å·¦ä¾§é‡‘é»„è‰²è¾¹æ¡† */
    padding: 15px;
    margin: 20px 0;
    border-radius: 4px;
    color: #ccc;
    font-style: normal;           /* æ–œä½“åŒºåˆ«äºæ­£æ–‡ */
}

/* ================= ä¸»é¡µé—¨é¢æ ·å¼ (ä¿®æ­£ç‰ˆ) ================= */

#view-home {
    overflow: hidden !important; 
    padding: 0 !important;
/* 1. è®¾ç½®åº•å±‚æ¸å˜è‰² (ä¾‹å¦‚ä»æ·±é»‘åˆ°ä½ åŸæœ¬çš„ #353535) */
    background-color: #353535; 
    background-image: 
        /* ç¬¬ä¸€å±‚ï¼šä½ åŸæ¥çš„ç‚¹ç‚¹çº¹ç† */
        radial-gradient(var(--bqv-dot-color) var(--bqv-dot-size), transparent var(--bqv-dot-size)),
        /* ç¬¬äºŒå±‚ï¼šæ–°å¢çš„çº¿æ€§æ¸å˜ (ä»ä¸Šå¾€ä¸‹çš„æ·±è‰²è¿‡æ¸¡) */
        linear-gradient(180deg, #000000 0%, rgb(53, 53, 53) 100%);
    
    /* 2. å…³é”®ï¼šåˆ†åˆ«ä¸ºä¸¤å±‚èƒŒæ™¯è®¾ç½®å°ºå¯¸ */
    /* ç¬¬ä¸€ç»„å¯¹åº”ç‚¹ç‚¹ (13px)ï¼Œç¬¬äºŒç»„ auto å¯¹åº”æ¸å˜ (é“ºæ»¡) */
    background-size: var(--bqv-dot-gap) var(--bqv-dot-gap), auto;
    
    scroll-behavior: smooth;
}

.home-facade-container {
    position: relative;
    width: 100%;
    height: 100%;
    /* ç§»é™¤ä¹‹å‰çš„ flex å±…ä¸­ï¼Œå…¨éƒ¨æ”¹ç”¨ç»å¯¹å®šä½æ§åˆ¶å­å…ƒç´  */
}

/* 1. æœ€åº•å±‚èƒŒæ™¯ (çº¢è‰²æ–¹æ¡†) */
.home-bg-layer {
position: absolute;
    /* å®šä½åˆ°å·¦ä¸‹è§’ï¼Œå¹¶ç•™å‡º 10px çš„è¾¹è· */
    bottom: 10px; 
    left: 10px;
    
    /* è®¾å®šæ‚¨è¦æ±‚çš„å°ºå¯¸ */
    width: 10%; 
    height: 10%;
    
    /* ä¿æŒå›¾ç‰‡å†…å®¹åœ¨æ–¹æ¡†å†…å¡«å……ï¼Œä¸å› æ¯”ä¾‹å¾®å·®è€Œå˜å½¢ */
    background-size: cover;
    background-position: center;
    
    /* ä¿æŒå±‚çº§åœ¨æœ€åº•å±‚ */
    z-index: 1;
    background-attachment: scroll;
}



/* ================= ä¸»è§†è§‰æ¢¦æ ¸/ç”µè§†æ»¤é•œ ================= */

.home-main-visual {
    position: absolute;

    top: 3%; 
    left: 50%;
    transform: translateX(-50%);
    width: 57%; 
    aspect-ratio: 16 / 9;
    box-shadow: 0 0 50px rgba(0,0,0,0.9);
    overflow: hidden; /* å¿…é¡»åˆ‡æ–­æº¢å‡ºçš„æ•…éšœè¾¹ */
}

/* 1. åŸºç¡€å›¾ç‰‡ï¼šåŠ å…¥éè§„å¾‹æ€§çš„é—ªçƒä¸ç¬é—´æ¨¡ç³Š */
.home-main-visual img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: contrast(1.2) saturate(0.8) brightness(1.1);
    /* å‘¨æœŸè®¾ä¸º 3.5sï¼Œè®©é—ªçƒå’Œæ¨¡ç³Šçœ‹èµ·æ¥æ²¡é‚£ä¹ˆæœºæ¢° */
    animation: tv-complex-flicker 3.5s infinite; 
}

/* 2. æ‰«æçº¿å±‚ï¼šä¿ç•™ä½ çš„ VHS æ•ˆæœï¼Œå åŠ â€œè€ç”µè§†ç»ç’ƒâ€è´¨æ„Ÿ */
.home-main-visual::after {
    content: "";
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    
    /* ç»„åˆèƒŒæ™¯ï¼š1.æ–°å¢çš„CRTå¾„å‘æš—è§’ + 2.ä½ åŸæ¥çš„ç»†å¯†çº¿ + 3.ä½ åŸæ¥çš„æ»‘åŠ¨å¸¦ */
    background: 
        /* A. æ–°å¢ï¼šæ¨¡æ‹Ÿç»ç’ƒè¾¹ç¼˜æ‰­æ›²å’Œå‘é»‘çš„å¾„å‘æ¸å˜ */
        radial-gradient(
            circle,
            transparent 45%,
            rgba(0, 0, 0, 0.4) 80%,
            rgba(0, 0, 0, 0.9) 100%
        ),
        /* B. ä½ åŸæ¥çš„ï¼šç»†å¯†é™æ€çº¿ (ä¿®æ­£ä¸º 3px å¾ªç¯é˜²æ­¢é‡å ) */
        repeating-linear-gradient(
            0deg,
            rgba(0, 0, 0, 0.18) 0px,
            rgba(0, 0, 0, 0.18) 1px,
            transparent 1px,
            transparent 2px
        ),
        /* C. ä½ åŸæ¥çš„ï¼šæ»‘åŠ¨æ‰«æå¸¦ */
        linear-gradient(
            to bottom,
            transparent 0%,
            rgba(255, 255, 255, 0.05) 45%,
            rgba(255, 255, 255, 0.12) 50%,
            rgba(255, 255, 255, 0.05) 55%,
            transparent 100%
        );
        
    /* ä¿æŒä½ åŸæ¥çš„å°ºå¯¸è®¾å®šï¼šæš—è§’(100%)ï¼Œé™æ€çº¿(100%)ï¼Œæ»‘åŠ¨å¸¦(15%) */
    background-size: 100% 100%, 100% 100%, 100% 15%; 
    background-repeat: no-repeat, repeat, no-repeat;
    
    /* å¢åŠ ä¸€ä¸ªç»ç’ƒåå…‰æ»¤é•œ */
    filter: contrast(1.1) brightness(1.1);
    
    /* ä¿æŒä½ çš„æ»‘åŠ¨åŠ¨ç”» */
    animation: vhs-scan-move 2s linear infinite;
    pointer-events: none;
    z-index: 10;
}
/* 3. Glitch æ•…éšœå±‚ï¼šåŠ å…¥å¼ºåŠ›çš„ä½ç§»ã€åç›¸ä¸åˆ‡ç‰‡æ•ˆæœ */
.home-main-visual::before {
    content: "";
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: inherit; 
    background-image: radial-gradient(circle, rgba(134, 8, 8, 0.4) 0%, rgba(17, 116, 116, 0.4) 100%);
    mix-blend-mode: screen; 
    opacity: 0;
    z-index: 5;
    pointer-events: none;
    /* å¢åŠ ç¬é—´çˆ†å‘çš„æ•…éšœæ„Ÿ */
    animation: glitch-advanced 4s infinite; 
}
/* === åŒç¿¼èƒŒæ™¯å±‚æ ¸å¿ƒæ ·å¼ === */
.home-bg-wings-wrapper {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    display: flex;
    z-index: 1.2; /* å¤¹åœ¨åŸºç¡€èƒŒæ™¯(z:1)ä¸ä¸»è§†è§‰(z:2)ä¹‹é—´ */
    perspective: 1200px; /* 3D æ·±åº¦æ„Ÿ */
    pointer-events: none; /* å…è®¸ç‚¹å‡»ç©¿é€åˆ°åº•å±‚è§¦å‘åˆ‡æ¢ */
    transition: transform 0.1s ease-out; /* å€¾æ–œå¹³æ»‘åº¦ */
}

.home-bg-side {
    width: 50%; height: 100%;
    background-size: cover;
    background-position: center;

    /* === ã€æ–°å¢ï¼šè®Šæš—åƒæ•¸ã€‘ === */
    /* 0.5 ä»£è¡¨ 50% äº®åº¦ã€‚è‹¥è¦æ›´æš—è«‹è¨­ç‚º 0.3ï¼Œè‹¥è¦äº®ä¸€é»è«‹è¨­ç‚º 0.7 */
    filter: brightness(0.5);
    /* 10ç§’ä¸€ä¸ªå¾ªç¯çš„äº¤æ›¿å‘¼å¸ */
    /* === ã€æ–°å¢æ ¸å¿ƒã€‘ç»™å˜æ¢å¢åŠ  1.2 ç§’çš„ç¼“æ…¢è¿‡æ¸¡ï¼Œä½¿ç”¨ cubic-bezier å¢åŠ é˜»å°¼æ„Ÿ === */
    transition: transform 1.2s cubic-bezier(0.1, 0.5, 0.2, 1);
    /* ç¡®ä¿åˆå§‹çŠ¶æ€ */
    transform: scale(1);
    will-change: transform; /* æå‡æ¸²æŸ“æ€§èƒ½ */

}



/* äº¤æ›¿è¿›è¡Œï¼šå³ä¾§å»¶è¿Ÿ 5 ç§’å¼€å§‹å‘¼å¸ */
.home-bg-side.right {

}

/* === ç‚¹å‡»åŒºåŸŸå…‰æ ‡è®¾ç½® === */
/* é”å®šä¸ºæ™®é€šç®­å¤´ï¼Œå³ä½¿ç‚¹å‡»ä¹Ÿä¸å˜å°æ‰‹ */
.home-facade-container img, 
.home-bg-layer, 
.home-bg-side, 
.home-main-visual {
    cursor: default !important;
}

.home-main-visual { z-index: 2; }
.home-top-overlay { z-index: 4; }
/* ================= åŠ¨ç”»å®šä¹‰ ================= */

/* --- å¢å¼ºç‰ˆ 1ï¼šç”µè§†é—ªçƒä¸ä¸å®šæœŸæ¨¡ç³Š --- */
@keyframes tv-complex-flicker {
    0%, 30%, 34%, 80%, 84%, 100% { filter: contrast(1) saturate(1) brightness(1) blur(0px); opacity: 1; }
    12% { filter: contrast(1.2) saturate(0.7) brightness(1.3) blur(3px); opacity: 0.8; } /* ç¬é—´è¿‡æ›æ¨¡ç³Š */
    22% { filter: contrast(1.1) saturate(1.2) brightness(0.7) blur(1.5px); opacity: 0.9; } /* ç¬é—´å˜æš—æ¨¡ç³Š */
}

/* ç¡®ä¿ä½ çš„æ»‘åŠ¨åŠ¨ç”» */
@keyframes vhs-scan-move {
    from { background-position: 0 0, 0 0, 0 -100%; }
    to { background-position: 0 0, 0 0, 0 200%; }
}



/* --- å¢å¼ºç‰ˆ 3ï¼šå‰§çƒˆæ•…éšœçˆ†å‘ (ä½ç§»+åˆ‡ç‰‡+é¢œè‰²æ‰­æ›²) --- */
@keyframes glitch-advanced {
    0%, 90%, 100% { opacity: 0; transform: scale(1) translate(0); filter: none; clip-path: none; }
    91% { 
        opacity: 0.8; 
        transform: scale(1.05) translate(15px, -5px); 
        filter: hue-rotate(90deg) contrast(2); 
        clip-path: inset(30% 0 40% 0); /* ç¬é—´åˆ‡æ‰ä¸€éƒ¨åˆ† */
    }
    93% { 
        opacity: 0.6; 
        transform: scale(0.95) translate(-20px, 10px); 
        filter: invert(1) hue-rotate(-90deg);
        clip-path: inset(10% 0 80% 0); 
    }
    95% { 
        opacity: 0.9; 
        transform: scale(1.1); 
        filter: brightness(2) saturate(5);
        clip-path: inset(70% 0 5% 0);
    }
}
/* 3. è£…é¥°å±‚ (Overlay) - ä»¥æ ‡ç­¾æŒ‰é’®ä¸Šæ–¹ä¸ºåŸºå‡† */
.home-top-overlay {
    position: absolute;
    z-index: 4; /* ç¡®ä¿å®ƒå‹åœ¨ä¸»è§†è§‰å’ŒæŒ‰é’®ä¹‹ä¸Šæˆ–ä¹‹é—´ */
    
    /* --- ä½ç½®å®šä¹‰ï¼šä»¥åº•éƒ¨æŒ‰é’®ä¸ºåŸºç‚¹ --- */
    /* æŒ‰é’®å®¹å™¨ bottom æ˜¯ 40pxï¼Œé«˜åº¦çº¦ 120pxï¼Œæ‰€ä»¥è¿™é‡Œè®¾ä¸º 160px+ åˆšå¥½åœ¨æŒ‰é’®ä¸Šæ–¹ */
    bottom: 10%; 
    left: 50%;
    transform: translateX(-50%);
    
    width: 50%;
    max-width: 1200px;
    aspect-ratio: 3 / 1;
    pointer-events: none; /* é˜²æ­¢é®æŒ¡æŒ‰é’®ç‚¹å‡» */
}
.home-top-overlay img { width: 100%; height: 100%; object-fit: contain; }

/* 4. åº•éƒ¨æ ‡ç­¾æŒ‰é’®å®¹å™¨ */
.home-nav-footer {
    position: absolute;
    bottom: 40px; /* å›ºå®šåœ¨åº•éƒ¨ */
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    display: flex;
    gap: 15px;
}

/* --- åº•éƒ¨ä¾¿ç­¾æŒ‰é’® --- */
/* --- åº•éƒ¨ä¾¿ç­¾æŒ‰é’® --- */
.home-note-btn {
    /* ã€å‚æ•°åŒºã€‘æ§åˆ¶æ³›ç™½æ„Ÿ */
    --light-factor: 1.3;  /* äº®åº¦ï¼šè¶Šé«˜è¶Šäº® */
    --white-factor: 60%;  /* å†²æ·¡æ¯”ä¾‹ï¼šç™½è‰²æ··åˆçš„ç™¾åˆ†æ¯” */

    background: var(--note-color);
    
    /* ä½¿ç”¨ color-mix å°†ä¸»é¢˜è‰²ä¸ç™½è‰²æ··åˆï¼Œå®ç°â€œæ³›ç™½â€æ•ˆæœ */
    background: color-mix(in srgb, var(--note-color), white var(--white-factor));
    
    /* é…åˆäº®åº¦æ»¤é•œï¼Œè®©æ•´ä½“è§†è§‰æ›´é€šé€ */
    filter: brightness(var(--light-factor));

    width: 100px;
    height: 120px;
    padding: 15px 10px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    cursor: pointer;
    
    /* åŸºç¡€æŠ•å½± */
    box-shadow: 4px 4px 0px rgba(0,0,0,0.15);
    /* åˆå§‹æ—‹è½¬ï¼ˆç”±JSå®šä¹‰çš„å˜é‡æˆ–CSSæŒ‡å®šï¼‰ */
    transform: rotate(var(--rotate, 0deg));
    
    /* æ‰€æœ‰çš„è¿‡æ¸¡éƒ½è¦å¹³æ»‘ */
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), 
                filter 0.3s ease, 
                opacity 0.3s ease;
    
    clip-path: polygon(0 0, 100% 0, 100% 90%, 90% 100%, 0 100%);
    z-index: 5;
}


/* èµ‹äºˆä¸åŒçš„æ—‹è½¬è§’åº¦ä½“ç°éšæ„æ„Ÿ */
.home-note-btn:nth-child(odd) { --rotate: -2deg; }
.home-note-btn:nth-child(even) { --rotate: 2deg; }

/* --- ã€å…³é”®ã€‘é¼ æ ‡æ»‘åŠ¨æ—¶çš„çŠ¶æ€ä¼˜å…ˆçº§æœ€é«˜ --- */
.home-note-btn:hover {
    /* 1. å¼ºåˆ¶åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åŠ¨ç”» */
    animation: none !important; 
    
    /* 2. åº”ç”¨å‘ä¸Šçš„æ‚¬æµ®æ•ˆæœ */
    transform: translateY(-20px) scale(1.08) rotate(0deg) !important;
    
    /* 3. æ‚¬æµ®æ—¶é¢œè‰²æ¢å¤ä¸€ç‚¹ï¼Œå¢åŠ äº’åŠ¨æ„Ÿ */
    filter: brightness(1.1); 
    opacity: 1;
    z-index: 50; /* æ‚¬æµ®æ—¶ç½®äºæœ€é¡¶å±‚ */
    box-shadow: 0 15px 30px rgba(0,0,0,0.4);
}

/* é¦–ä¸ªæ ‡ç­¾çš„å¸å¼•åŠ¨ç”»ï¼šå˜å¤§å¹¶å·¦å³æ™ƒåŠ¨ */
.attention-wiggle {
    /* forwards æ”¹ä¸º infinite */
    animation: attractWiggle 2s ease-in-out infinite; 
    z-index: 20;
    filter: brightness(1.2) saturate(1.1) !important;
}

/* ä¸ºäº†è®©å¾ªç¯çœ‹èµ·æ¥ä¸é‚£ä¹ˆç´¯ï¼Œå»ºè®®æŠŠ wiggle åŠ¨ç”»ç¨å¾®è°ƒå¹³ç¼“ä¸€ç‚¹ */
@keyframes attractWiggle {
    0%, 100% { transform: scale(1.05) rotate(var(--rotate)); }
    25% { transform: scale(1.05) rotate(-5deg); }
    75% { transform: scale(1.05) rotate(5deg); }
}

.note-num { font-family: monospace; font-size: 18px; font-weight: bold; color: rgba(0,0,0,0.5); }
.note-text { font-size: 16px; font-weight: 900; color: #1a1a1a; text-align: right; }

/* æ‰‹æœºç«¯é€‚é…ï¼šä¿®æ­£åŸºå‡†ç‚¹ */
@media (max-width: 768px) {


    /* 1. æ¢å¤ä¸€æ’æ’åˆ— */
    .home-nav-footer {
        width: 90%;      /* å æ®å±å¹•ç»å¤§éƒ¨åˆ†å®½åº¦ */
        left: 50%;
        transform: translateX(-50%);
        bottom: 50px;
        display: flex;   /* æ ¸å¿ƒï¼šæ”¹å› flex å¸ƒå±€ */
        flex-direction: row; 
        justify-content: center;
        gap: 10px;        /* ç¼©å°é—´è·ï¼Œè…¾å‡ºç©ºé—´ */
        padding: 0;
    }

    /* 2. ç­‰æ¯”ä¾‹ç¼©å°æŒ‰é’® */
    .home-note-btn {
        width: 15.5%;    /* 6ä¸ªæŒ‰é’®åŠ é—´è·åˆšå¥½å æ»¡ */
        height: 65px;    /* ç¼©å°é«˜åº¦ */
        padding: 6px 4px; /* å‡å°å†…è¾¹è· */
        --light-factor: 1.2; /* æ‰‹æœºç«¯ç¨å¾®æ·±ä¸€ç‚¹ï¼Œæ›´æ¸…æ™° */
    }

    /* 3. ç¼©å°æŒ‰é’®æ–‡å­—ï¼Œé˜²æ­¢æº¢å‡º */
    .note-num { 
        font-size: 9px;   /* åºå·ç¼©å° */
    }
    .note-text { 
        font-size: 11px;  /* æ ‡ç­¾æ–‡å­—ç¼©å° */
        font-weight: 800;
        text-align: center;
        width: 100%;
    }

    /* 4. ä¿®æ”¹ä¸»è§†è§‰å’Œè¦†ç›–å±‚æ¯”ä¾‹ï¼Œé˜²æ­¢å¤ªæŒ¤ */
    .home-main-visual { 
        width: 220%; /* æ‰‹æœºç«¯å æ®ç»å¤§éƒ¨åˆ†å®½åº¦ */
        top: 0;   /* æ‰‹æœºç«¯å¾€ä¸Šæä¸€ç‚¹ */
    }
    .home-top-overlay { 
        top:55%;
        width: 150%; 
        bottom: 0px; /* æ‰‹æœºç«¯æŒ‰é’®æ’æˆä¸¤è¡Œï¼Œæ‰€ä»¥ Overlay ä¹Ÿè¦ä¸Šç§» */
    }
    /* === ã€æ ¸å¿ƒä¿®æ”¹ï¼šæ‰‹æ©Ÿç«¯éš±è—æ‰€æœ‰èƒŒæ™¯åœ–å±¤ã€‘ === */
    .home-bg-layer, 
    .home-bg-wings-wrapper {
        display: none !important; /* å¾¹åº•é—œé–‰åº•å±¤èƒŒæ™¯èˆ‡é›™ç¿¼ 3D èƒŒæ™¯ */
    }

}



/* ================= æ¸¸æˆæ€»è§ˆé¡µé¢æ ·å¼ ================= */

#view-overview {
    padding: 0 !important; /* é“ºæ»¡ */
}

/* é€šç”¨ç« èŠ‚èƒŒæ™¯ï¼šæ¸å˜æ•ˆæœ */
.ov-section {
    position: relative;
    width: 100%;
    padding-bottom: 80px;
    transition: background 0.5s ease;
}

/* 21:9 å¤´å›¾ */
.ov-header-banner {
    width: 100%;
    aspect-ratio: 2.828 / 1;
    object-fit: cover;
    display: block;
}

/* --- ç« èŠ‚ 1ï¼šæˆ˜æ–—ï¼ˆæ¨æ‹‰é—¨å…¨å®½ä¼˜åŒ–ç‰ˆï¼‰ --- */
.battle-row {
    width: 100%; /* 1. å®¹å™¨æ”¹ä¸º 100% å…¨å®½ï¼Œå–æ¶ˆä¾§è¾¹é™åˆ¶ */
    margin: 60px 0; /* å¢åŠ ä¸Šä¸‹é—´è·ï¼Œå–æ¶ˆå·¦å³ margin */
    display: flex;
    align-items: center;
    justify-content: center; /* 2. ç¡®ä¿åˆå¹¶ååœ¨å±å¹•ä¸­å¿ƒ */
    gap: 0; 
    perspective: 1000px;
    overflow: visible; /* 3. å…è®¸å›¾ç‰‡åœ¨åŠ¨ç”»å‰å¤„äºå±å¹•å¤– */
}

/* æˆ˜æ–—æˆªå›¾ä¸è§£è¯´æ¡†çš„åŸºç¡€å®½åº¦è®¾å®š (ä¿æŒ 16:9 å’Œ 1:2.5 æ¯”ä¾‹ï¼Œæ€»å®½å å±å¹• 90%) */
.battle-img-box {
    width: 57.5%; /* æˆªå›¾å  90% é‡Œçš„ 16ä»½ */
    aspect-ratio: 16 / 9;
    border: 4px solid #000;
    z-index: 1;
    transition: transform 1.0s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.8s;
    opacity: 1;
    overflow: hidden;
}

.battle-info-box {
    width: 22.5%; /* è§£è¯´å  90% é‡Œçš„ 6.4ä»½ */
    aspect-ratio: 1 / 1.35;
    z-index: 5;
    transition: transform 1.0s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.8s;
    opacity: 0;
    border: none !important;
/* æ ¸å¿ƒä¿®æ”¹ï¼šå…è®¸é˜´å½±æº¢å‡ºæ˜¾ç¤º */
    overflow: visible !important; 
}
/* --- 3. å›¾ç‰‡æ ·å¼å¾®è°ƒ --- */
.battle-img-box img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover; /* æˆªå›¾å»ºè®®é“ºæ»¡ */
    margin: 0;
    padding: 0;
}

.battle-info-box img {
    display: block;
    width: 100%;
    height: 100%;
    
    /* è§£è¯´æ¡†å›¾ç‰‡å»ºè®®ç”¨ containï¼Œä¿è¯é€æ˜ PNG çš„å½¢çŠ¶æ˜¾ç¤ºå®Œæ•´ */
    object-fit: contain; 
    
    margin: 0;
    padding: 0;

    /* ä½ çš„æ ¸å¿ƒéœ€æ±‚ï¼šä¸è§„åˆ™è½®å»“é˜´å½± */
    /* å½“å›¾ç‰‡å åœ¨æˆªå›¾ä¸Šæ—¶ï¼Œè¿™ä¸ªé˜´å½±ä¼šæŠ•å°„åœ¨æˆªå›¾ä¸Šï¼Œéå¸¸æœ‰ç«‹ä½“æ„Ÿ */
    filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.8));
}
    /* 2. ä¿®æ”¹åˆ’å…¥å‰ä½ç½®ï¼šå®ç°â€œä¾§è¾¹éœ²å‡º 24%â€çš„æ•ˆæœ */
    /* è®¡ç®—é€»è¾‘ï¼š
    - åˆ’å…¥åå·¦å³ç•™ç™½å…± 15% (å³å•è¾¹ 7.5vw)ã€‚
    - è¦è®©å…ƒç´ ä¾§è¾¹éœ²å‡º 24%ï¼Œä½ç§»é‡ = è‡ªèº«å®½åº¦çš„ 76% + ä¾§è¾¹ç•™ç™½çš„ 7.5vw
    */
.battle-row.side-left .battle-img-box { 
    transform: translateX(calc(-56% - 7.5vw)) rotate(1.5deg); 
}
.battle-row.side-left .battle-info-box { 
    transform: translateX(calc(56% + 7.5vw)) rotate(1.5deg); 
}

.battle-row.side-right .battle-img-box { 
    transform: translateX(calc(56% + 7.5vw)) rotate(-1.5deg); 
    order: 2; 
}
.battle-row.side-right .battle-info-box { 
    transform: translateX(calc(-56% - 7.5vw)) rotate(-1.5deg); 
    order: 1; 
}

/* 3. æ¿€æ´»çŠ¶æ€ï¼šå›åˆ°ä¸­å¿ƒä½ç½®å¹¶åº”ç”¨å€¾æ–œ */
.battle-row.active .battle-img-box,
.battle-row.active .battle-info-box {
    transform: translateX(0) rotate(var(--tilt, 0deg)) !important;
    opacity: 1 !important;
}

@media (max-width: 768px) {
    /* --- 1. è°ƒæ•´æ‰‹æœºç«¯æ¯ä¸€è¡Œçš„å‚ç›´é—´è· --- */
    .battle-row {
        margin: 30px 0 !important; /* å°†åŸæ¥çš„ 60px ç¼©å°ä¸º 30pxï¼Œè§£å†³é—´è·è¿‡å®½é—®é¢˜ */
        width: 100%;
        display: flex;
        justify-content: center;
        overflow: visible; /* å…è®¸ 105% çš„å®½åº¦æº¢å‡ºå±å¹•è¾¹ç¼˜ */
    }

    /* --- 2. è°ƒæ•´æˆªå›¾å®½åº¦ (å æ€»å®½ 105% é‡Œçš„ 75%) --- */
    .battle-img-box {
        width: 70% !important; 
        aspect-ratio: 16 / 9; /* ä¿æŒ 16:9 */
        border-width: 2px !important; /* æ‰‹æœºç«¯è¾¹æ¡†å‡è–„ï¼Œé˜²æ­¢è§†è§‰å¤ªé‡ */
        flex-shrink: 0; /* ç¦æ­¢è¢«å‹ç¼© */
    }

    /* --- 3. è°ƒæ•´è§£è¯´æ¡†å®½åº¦ (å æ€»å®½ 105% é‡Œçš„ 30%) --- */
    .battle-info-box {
        width: 30% !important;
        aspect-ratio: 1 / 1.35; /* ä¿æŒæ‚¨æŒ‡å®šçš„æ¯”ä¾‹ */
        flex-shrink: 0; /* ç¦æ­¢è¢«å‹ç¼© */
        opacity: 1 !important; /* æ‰‹æœºç«¯å»ºè®®ç›´æ¥æ˜¾ç¤ºï¼Œæˆ–ä¿æŒåŠ¨ç”» */
    }

    /* --- 4. ä¿®æ­£æ‰‹æœºç«¯åˆ’å…¥å‰çš„ä½ç½® (é…åˆ 105% å®½åº¦) --- */
    /* ç”±äºå®½åº¦å˜å¤§ï¼Œä½ç§»è·ç¦»ä¹Ÿéœ€è¦å¾®è°ƒï¼Œç¡®ä¿ä¾§è¾¹éœ²å‡ºæ„Ÿ */
    .battle-row.side-left .battle-img-box { transform: translateX(-15vw) rotate(1.5deg); }
    .battle-row.side-left .battle-info-box { transform: translateX(15vw); }

    .battle-row.side-right .battle-img-box { transform: translateX(15vw) rotate(-1.5deg); }
    .battle-row.side-right .battle-info-box { transform: translateX(-15vw); }

    /* æ¿€æ´»çŠ¶æ€å›åˆ° 0 */
    .battle-row.active .battle-img-box,
    .battle-row.active .battle-info-box {
        transform: translateX(0) rotate(var(--tilt, 0deg)) !important;
    }
}

/* --- è£…å¤‡é¡µé‡æ„ï¼šåŸºäºä½ æä¾›åŸºç¡€çš„å¢å¼ºç‰ˆ --- */
.equip-container { 
    width: 100%; 
    margin: 0 auto; 
    display: flex; 
    flex-direction: column; 
    /* ã€å¤§é—´è·ã€‘å•å…ƒä¸å•å…ƒï¼ˆå›¾ç‰‡ä¸å›¾ç‰‡ï¼‰ä¹‹é—´ */
    gap: 100px; 
    align-items: center;
}

/* --- è£…å¤‡é¡µï¼šæç®€é«˜çº§æ„Ÿé‡æ„ --- */
.equip-unit {
    display: flex; 
    flex-direction: column; 
    align-items: center;
    gap: 20px; width: 100%;
}

/* 1. å›¾ç‰‡ï¼šé»‘è¾¹ + é˜´å½± + æ¯”ä¾‹ */
.equip-img, .equip-row-full {
    width: 70% !important; 
    height: auto;
    aspect-ratio: 16 / 9;
    object-fit: cover;
    border-radius: 4px;
    border: 2px solid #000 !important; /* å¼ºåˆ¶é»‘è¾¹ */
    box-shadow: 0 10px 30px rgba(0,0,0,0.6) !important; /* å¼ºåˆ¶é˜´å½± */
    display: block;
}

/* 2. ç»ç’ƒæ¡†ï¼šåœ¨ä½ æä¾›çš„åŸºç¡€ä¸Šå¢åŠ æ›´é€äº®ã€å¤–å‘å…‰ */
.equip-glass-card {
    width: 50% ;
    background: rgb(54, 54, 54) !important; 
    backdrop-filter: blur(15px) saturate(150%) !important;
    border: 1px solid rgba(255, 255, 255, 0.25) !important;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.699), inset 0 0 10px rgba(255, 255, 255, 0.05) !important;
    border-radius: 8px;
    height: auto; 
    max-height: none !important;
}

.equip-card-header { 
    background: rgba(255, 255, 255, 0.836); 
    padding: 12px; text-align: center; 
    font-weight: bold; color: #1f1f1f; 
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.equip-card-body {
    padding: 25px 30px !important; 
    color: #ffffff !important; /* çº¯ç™½æ–‡å­— */
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8); /* æ–‡å­—å°é˜´å½±ç¡®ä¿æ¸…æ™° */
    font-size: 15px;
    line-height: 1.8;
}

/* --- å±æ€§å—ç¥ç§˜åŒ–ç‰¹ä¾› --- */
.attr-img-box {
    border-radius: 4px;
    border: 1px solid var(--glow-color);
    box-shadow: 0 0 12px var(--glow-color); /* é¢œè‰²å¤–å‘å…‰ */
    transition: none !important;
}
/* å˜æš—æ»¤é•œï¼šé™¤äº†1é˜¶å¤–å…¨éƒ¨å˜æš— */
.attr-darken { filter: brightness(0.15) grayscale(0.9); }
.attr-unit-mini { transform: none !important; cursor: default; }

/* æ–‘ä¸˜å¡æ¡£æ¡ˆä¸“å±å¸ƒå±€ */
.bq-card-row {
    display: flex; gap: 20px; margin-bottom: 25px;
    padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);
}
.bq-card-row:last-child { border-bottom: none; }
.bq-card-icon { width: 80px; height: 80px; flex-shrink: 0; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px; border: 1px solid rgba(255,255,255,0.2); }
.bq-card-icon img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 0 5px var(--card-color)); }
.bq-card-info { flex: 1; }
.bq-card-title { font-size: 18px; font-weight: bold; margin-bottom: 8px; color: var(--card-color); }
.bq-card-detail { font-size: 14px; opacity: 0.9; }
.bq-card-detail b { color: #feff00; }

/* --- è£…å¤‡é¡µï¼šæœ€ç»ˆå…¨å±å›¾ï¼ˆè„±ç¦»å•å…ƒé€»è¾‘ï¼‰ --- */
.equip-final-full {
    width: 70% !important;      /* å¼ºåˆ¶ 100% å®½åº¦ */

    border: none !important;     /* å½»åº•ç§»é™¤é»‘è¾¹ */
    box-shadow: none !important; /* å½»åº•ç§»é™¤é˜´å½± */
    border-radius: 0 !important; /* å½»åº•ç§»é™¤åœ†è§’ï¼Œå®ç°ç›´è§’å…¨å±æ„Ÿ */
    margin: 40px 0 0 0 !important; /* ä»…ä¿ç•™é¡¶éƒ¨é—´è·ï¼Œç¡®ä¿ä¸ä¸Šæ–¹ç»ç’ƒæ¡†éš”å¼€ */
    display: block;
    aspect-ratio: auto !important; /* å…è®¸æ ¹æ®å›¾ç‰‡åŸæ¯”ä¾‹ç¼©æ”¾ */
}
/* --- æ‰‹æœºç«¯é€‚é… --- */
@media (max-width: 768px) {
/* 1. ç»Ÿä¸€é—´è·ï¼šè£…å¤‡é¡µå’Œå¯¼æ¸¸é¡µçš„å¤§é—´è·éƒ½è®¾ä¸º 60px */
    .equip-container, .guide-container { 
        gap: 60px !important; 
    }
    .equip-img, .equip-row-full { width: 95% !important; }
    .equip-glass-card { width: 90% !important; }
    .equip-card-body { padding: 15px 20px !important; font-size: 13px; }
}

/* --- ç« èŠ‚ 3ï¼šå…¬æ­£ --- */
.justice-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    width: 90%;
    margin: 0 auto;
}
.justice-unit { display: flex; flex-direction: column; gap: 10px; }
.justice-img { width: 100%; aspect-ratio: 4 / 3; object-fit: cover; }
.justice-capsule {
    width: 100%;
    padding: 8px 15px;
    border-radius: 40px;
    border: 2px solid var(--border-color);
    background: rgba(0,0,0,0.3);
    color: #fff;
    font-size: 13px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* --- 1. ç¼©ç•¥å›¾äº¤äº’æ•ˆæœ (Hover å˜æ­£) --- */
/* ç»™å›¾ç‰‡å®¹å™¨åŠ ä¸Šé¼ æ ‡æ‰‹åŠ¿å’Œè¿‡æ¸¡åŠ¨ç”» */
.battle-row .battle-img-box {
    cursor: pointer;
    transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.3s ease;
}

/* ã€æ ¸å¿ƒéœ€æ±‚ã€‘é¼ æ ‡åˆ’è¿‡æ—¶ï¼Œå¼ºåˆ¶å˜æ­£ (rotate: 0) ä¸¦ç¨å¾®æ”¾å¤§ï¼Œå¢åŠ æµ®èµ·æ„Ÿ */
/* ä½¿ç”¨ !important è¦†ç›–åŸæœ¬å†…è”æ ·å¼ä¸­çš„æ—‹è½¬è§’åº¦ */
.battle-row .battle-img-box:hover {
    transform: rotate(0deg) scale(1.03) translateY(-5px) !important;
    box-shadow: 0 15px 30px rgba(0,0,0,0.4); /* åŠ ä¸ªé˜´å½±å¢åŠ ç«‹ä½“æ„Ÿ */
    z-index: 10; /* ç¡®ä¿æµ®åœ¨æœ€ä¸Šé¢ */
}
/* --- æˆ˜æ–—æµ®çª—æ ¸å¿ƒé‡æ„ --- */
.battle-modal {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            z-index: 20000; /* ç¡®ä¿åœ¨æœ€é¡¶å±‚ */
            background: rgba(70, 70, 70, 0.7); 
            backdrop-filter: blur(5px);
            z-index: 9999; 
            
            /* ã€æ”¹è¿™é‡Œã€‘åŸæ¥æˆ‘å†™äº† flexï¼Œç°åœ¨å¿…é¡»æ”¹å› none */
            display: none; 
            
            /* ä¸‹é¢è¿™äº›ä¿ç•™ï¼Œæ˜¯ä¸ºäº†å¼¹å‡ºæ¥çš„æ—¶å€™èƒ½å±…ä¸­ */
            justify-content: center; 
            align-items: center;     
            overflow: auto; 
            padding: 20px; 
            cursor: pointer; /* å‘Šè¯‰ç”¨æˆ·èƒŒæ™¯å¯ä»¥ç‚¹ */
}

.battle-modal.open {
    display: flex;
}

.battle-modal-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    /* è¿™é‡Œçš„å®½åº¦ç”±å›¾ç‰‡æ’‘å¼€ï¼Œä¸å†å¼ºåˆ¶ 80% å¯¼è‡´æ‹‰ä¼¸ */
    max-width: 90vw;
    /* è·ç¦»é¡¶éƒ¨ 5% */
    margin-top: 2vh; 
}

#battle-modal-img {
    /* ã€æ ¸å¿ƒä¿®å¤ã€‘å–æ¶ˆå¤–æ¡†ï¼Œé™åˆ¶å®½åº¦ï¼Œä¿æŒæ¯”ä¾‹ */
    width: auto;
    max-width: 80vw; /* ç½‘é¡µç«¯å  80% */
    max-height: 87vh;
    border: none !important; /* å½»åº•å»æ‰å¤–æ¡† */
    box-shadow: 0 10px 40px rgba(0,0,0,0.8);
    object-fit: contain;
    background: transparent;
    
}

/* æŒ‰é’®åŒºåŸŸ */
.battle-modal-nav {
    display: flex;
    gap: 60px;
    margin-top: 20px;
}

/* å¼•ç”¨ä½ æä¾›çš„ .nav-btn-char æ ·å¼ */
.nav-btn-char {
    width: 50px; height: 50px;
    background: rgba(30, 30, 30, 0.8);
    border: 1px solid #555;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    color: #888;
    font-size: 20px;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    backdrop-filter: blur(5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    user-select: none;
}
.nav-btn-char:hover {
    background: #8a8a8a;
    color: #000;
    border-color: #fff;
    transform: scale(1.15);
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
}
.nav-btn-char:active { transform: scale(0.95); }

/* --- æ‰‹æœºç«¯é€‚é… --- */
@media (max-width: 768px) {
    .battle-modal-content {
        margin-top: 0; /* æ‰‹æœºç«¯å±…ä¸­ */
    }
    #battle-modal-img {
        max-width: 95vw; /* æ‰‹æœºç«¯å‡ ä¹å æ»¡ */
    }
    .nav-btn-char {
        /* ã€æ ¸å¿ƒä¿®æ”¹ã€‘æ‰‹æœºç«¯æŒ‰é’®å˜å¤§ */
        width: 65px; 
        height: 65px;
        font-size: 24px;
    }
    .battle-modal-nav {
        gap: 60px; /* é—´è·æ‹‰å¼€æ–¹ä¾¿æ‰‹æŒ‡ç‚¹å‡» */
    }
}
/* --- æˆ˜æ–—ç« èŠ‚é¡¶éƒ¨å¼•å¯¼æ¨¡å— --- */
.ov-combat-intro-container {
    width: 100%;
    display: flex;
    justify-content: center;
    padding: 60px 0 20px 0; /* ä¸Šç•™ç©ºï¼Œä¸‹å¾®è°ƒ */
    overflow: hidden;
}

.ov-combat-intro-inner {
    /* æ ¸å¿ƒï¼šæ¡Œé¢ç«¯æ€»å®½åº¦ 80% */
    width: 80%; 
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap; /* æ— è®ºå¦‚ä½•éƒ½ä¸æ¢è¡Œ */
    gap: 40px; /* ä¸‰åˆ—ä¹‹é—´çš„é—´è· */
    justify-content: center;
}

.intro-column {
    flex: 1; /* ä¸‰åˆ—ç­‰å®½ */
    display: flex;
    flex-direction: column;
    align-items: center; /* ä¸­å¿ƒå±…ä¸­ */
    gap: 20px; /* å›¾ç‰‡å’Œèƒ¶å›Šçš„é—´è· */
    min-width: 0; /* é˜²æ­¢å†…å®¹æ’‘ç ´ flex å®¹å™¨ */
}

/* å›¾ç‰‡å¤–æ¡†ï¼šç²—ç™½æ¡† + å†…å¤–é˜´å½± */
.intro-img-box {
    width: 100%;
    aspect-ratio: 1 / 1; /* å¼ºåˆ¶æ­£æ–¹å½¢ */
    background: #222;
    border: 15px solid #fff; /* å¾ˆç²—çš„ç™½è‰²å¤–æ¡† */
    
    /* æ ¸å¿ƒï¼šå†…å¤–é˜´å½±ç»„åˆ */
    /* 0 10px 25px... æ˜¯å¤–é˜´å½±ï¼›inset... æ˜¯å†…é˜´å½± */
    box-shadow: 
        0 10px 30px rgba(0,0,0,0.5), 
        inset 0 0 15px rgba(0,0,0,0.4);
        
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}

.intro-img-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* ç™½è‰²å…¬æ­£èƒ¶å›Šç‰¹è°ƒ */
.intro-capsule {
    width: 100%;
    background: #fff !important; /* å¼ºåˆ¶ç™½è‰² */
    color: #000 !important; /* å¼ºåˆ¶é»‘å­— */
    border: none !important;
    text-align: center;
    font-weight: 900;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    text-overflow: clip; /* é˜²æ­¢å‡ºç°çœç•¥å· */
    white-space: nowrap;
}

/* --- æ‰‹æœºç«¯é€‚é… --- */
@media (max-width: 768px) {
    .ov-combat-intro-inner {
        width: 100% !important; /* æ‰‹æœºç«¯å æ»¡ 100% */
        padding: 0 10px;
        gap: 15px; /* ç¼©å°é—´è· */
    }
    
    .intro-img-box {
        border-width: 8px; /* æ‰‹æœºç«¯è¾¹æ¡†ç¨å¾®å‡è–„ï¼Œé˜²æ­¢æ¯”ä¾‹å¤±è°ƒ */
    }
    
    .intro-capsule {
        font-size: 11px !important;
        padding: 5px 2px !important;
        border-radius: 20px !important; /* ç»´æŒåœ†æ¶¦æ„Ÿ */
    }
}


/* --- å±æ€§å—å›¾é‰´ä¸“ç”¨ï¼š3x5 å¸ƒå±€ä¸é˜¶çº§é¢œè‰² --- */
.attr-grid-container {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
    padding: 15px;
}

/* é˜¶çº§èƒŒæ™¯æ·±æµ…é€»è¾‘ */
.tier-bg-1 { background: rgba(143, 143, 143, 0.719); } /* ä¸€é˜¶ï¼šææµ… */
.tier-bg-2 { background: rgba(122, 122, 122, 0.904); } /* äºŒé˜¶ï¼šç¨æ·± */
.tier-bg-3 { background: rgba(255, 255, 255, 0.13); } /* ä¸‰é˜¶ï¼šæ›´æ·± */
.tier-bg-4 { background: rgba(95, 95, 95, 0.18); box-shadow: inset 0 0 15px rgba(212, 212, 7, 0.89); } /* å››é˜¶ï¼šå¸¦å¾®å…‰ */
.tier-bg-5 { background: rgba(255, 255, 255, 0.25); box-shadow: inset 0 0 20px rgba(0, 255, 204, 0.87); } /* äº”é˜¶ï¼šæœ€æ·± */

.attr-unit-mini {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 3px;
    border-radius: 6px;
    transition: transform 0.2s;
}
.attr-unit-mini:hover { transform: scale(1.1); z-index: 5; }

/* --- è¿˜åŸï¼šæ€ç»´å¯¼å›¾ç»å…¸æ ·å¼ --- */
.mindmap-container {
    display: flex; flex-direction: column; gap: 20px; padding: 20px; color: #ccc;
}
.mm-root {
    align-self: center; background: #fff; color: #000;
    padding: 5px 20px; border-radius: 20px; font-weight: 900;
}
.mm-branches {
    display: flex; justify-content: space-around; gap: 15px;
}
.mm-branch {
    flex: 1; display: flex; flex-direction: column; gap: 10px;
    border-top: 1px solid #555; padding-top: 10px;
}
.mm-title { 
    font-weight: bold; color: #fff; margin-bottom: 5px; 
    border-left: 3px solid #666; padding-left: 8px; 
}
.mm-item { 
    font-size: 13px; line-height: 1.5; background: rgba(255,255,255,0.05); 
    padding: 10px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1);
}
/* è¿˜åŸæ˜é»„è‰²é«˜äº® */
.mm-highlight { color: #feff00; font-weight: bold; }


@media (max-width: 768px) {
    .attr-grid-container { grid-template-columns: repeat(5, 1fr); gap: 5px; padding: 5px; }
    .attr-label-box { font-size: 10px !important; }
    .mm-branches { flex-direction: column; }
}
/* --- æ–‘ä¸˜å¡å¯¼å›¾åŒ–å¸ƒå±€ --- */
.bq-mm-row {
    display: flex;
    gap: 20px;
    margin-bottom: 40px;
    padding-bottom: 20px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}
.bq-mm-row:last-child { border-bottom: none; }

/* å·¦ä¾§å¡å¤´ï¼šå›ºå®šå®½åº¦ */
.bq-mm-header {
    width: 80px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}
.bq-mm-header img {
    width: 65px;
    height: 65px;
    filter: drop-shadow(0 0 8px var(--card-color));
}
.bq-mm-tag {
    width: 100%;
    text-align: center;
    font-size: 12px;
    font-weight: bold;
    padding: 2px 0;
    border-radius: 4px;
    color: var(--text-color, #fff);
    background: var(--card-color);
}

/* å³ä¾§åˆ†æ”¯ç³»ç»Ÿ */
.bq-mm-content {
    flex: 1;
    display: flex;
    gap: 15px;
}

/* è¦†ç›–ä¹‹å‰çš„ mm-branch ç¡®ä¿ä¸‰åˆ—ç­‰å®½ */
.bq-mm-content .mm-branch {
    flex: 1;
    border-top: 1px solid var(--card-color); /* é¡¶éƒ¨çº¿æ¡é¢œè‰²è·Ÿéšå¡ç‰‡ */
    opacity: 0.9;
}

@media (max-width: 1024px) {
    .bq-mm-content { flex-direction: column; } /* å¹³æ¿æ‰‹æœºå˜ä¸ºå †å  */
}


/* ================= å¯¼æ¸¸ç« èŠ‚ä¸“ç”¨æ ·å¼ ================= */

/* ç« èŠ‚å¤§å®¹å™¨ï¼šå…¨å±å®½ */
/* --- [ä¿®æ­£] å¯¼æ¸¸é¡µå…¨å±å®¹å™¨ï¼šç§»é™¤å¹²æ‰°å¸é¡¶çš„å±æ€§ --- */
.ov-section-full {
    width: 100% !important; /* æ”¹ä¸º 100%ï¼Œä¸è¦ç”¨ vw */
    position: relative;
    left: 0 !important;      /* å½’é›¶ */
    transform: none !important; /* å¿…é¡»å½»åº•ç¦ç”¨ transform */
    overflow: visible !important; /* å¿…é¡»æ˜¯ visibleï¼Œå¸é¡¶æ‰æœ‰æ•ˆ */
}

/* --- æ˜¾æ‘†å›¾ç‰‡ï¼šå°ºå¯¸ä¸åå‘åŠ¨ç”» --- */
.show-off-img {
    position: absolute;
    width: 300px; /* ç½‘é¡µç«¯å˜å¤§2å€ */
    height: 300px;
    z-index: 50;
    pointer-events: none;
    filter: drop-shadow(0 0 20px var(--glow-color, #fff));
}

/* æ˜¾æ‘†å›¾ç‰‡å·¦ä¾§ï¼šå‘å·¦åå¼€å§‹ */
.wobble-L {
    animation: slowWobbleL 4s ease-in-out infinite;
}

/* æ˜¾æ‘†å›¾ç‰‡å³ä¾§ï¼šå‘å³åå¼€å§‹ */
.wobble-R {
    animation: slowWobbleR 4s ease-in-out infinite;
}

@keyframes slowWobbleL {
    0%, 100% { transform: rotate(-3deg); }
    50% { transform: rotate(3deg); }
}

@keyframes slowWobbleR {
    0%, 100% { transform: rotate(3deg); }
    50% { transform: rotate(-3deg); }
}
/* ç¬¬ä¸‰è¡Œä¸“ç”¨ï¼šä¸­é—´å¯¹é½å®¹å™¨ */
.show-off-center-box {
    display: flex;
    justify-content: center;
    gap: 40px; /* ä¸¤ä¸ªæ˜¾æ‘†å›¾ä¹‹é—´çš„é—´è· */
    width: 100%;
    margin-top: -20px; /* å‘ä¸Šå¾®è°ƒï¼Œä½¿å…¶é è¿‘æ–‡å­—æ¡†åº•éƒ¨ */
}



/* å¯¼æ¸¸ç« èŠ‚æ€»å®¹å™¨ - é—´è·åŒæ­¥è£…å¤‡é¡µ */
.guide-container {
    display: flex;
    flex-direction: column;
    gap: 100px; /* åŒæ­¥è£…å¤‡é¡µé—´è· */
    align-items: center;
    width: 100%;
}

/* å¯¼æ¸¸é¡µæ¯ä¸€è¡Œï¼ˆRowï¼‰å†…éƒ¨çš„é—´è·ï¼ˆå›¾ç‰‡ä¸æ–‡å­—æ¡†ä¹‹é—´ï¼‰ä¿æŒå°é—´è· */
.guide-row {
    position: relative;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px; /* è¡Œå†…å°é—´è·ï¼Œä¿æŒå’Œä½ è¦æ±‚çš„ 20px ä¸€è‡´ */
}

/* æŠ½å±‰åŒ…è£…å™¨ */
.drawer-wrapper {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 18%; /* çº¦ä¸»å›¾ 1/4 */
    aspect-ratio: 1 / 1.5;
    transition: transform 1.2s cubic-bezier(0.2, 0.8, 0.2, 1);
    
/* ã€æ ¸å¿ƒä¿®æ”¹ã€‘ */
    pointer-events: none; /* å¿…é¡»åŠ ï¼å¦åˆ™å›¾ç‰‡æ»‘å…¥åï¼Œä½ ç‚¹ä¸åˆ°ä¸‹é¢çš„æ–‡å­—å’ŒæŒ‰é’® */
}
/* åº•å±‚å›¾ï¼šç°åœ¨ä¹Ÿæµ®åœ¨ä¸Šé¢ï¼Œè®¾ä¸º 11 */
.drawer-back {
    z-index: 11 !important; 
}

/* é¡¶å±‚å›¾ï¼šè®¾ä¸º 12 */
.drawer-front {
    z-index: 12 !important; 
}
.drawer-left { left: 0; transform: translate(-100%, -50%); }
.drawer-right { right: 0; transform: translate(100%, -50%); }

/* æ¿€æ´»æŠ½å±‰ */
.guide-row.active .drawer-left,
.guide-row.active .drawer-right { transform: translate(0, -50%); }

/* ã€æ ¸å¿ƒå±‚çº§ã€‘è¯„è®ºå›¾ç‰‡æ ·å¼ */
.comment-img-bottom {
    position: absolute;
    width: 100%; height: 100%;
    z-index: 1; /* åœ¨ä¸»å›¾ä¸‹æ–¹ */
    object-fit:contain !important; /* ç¢ºä¿æ•´å¼µåœ–éƒ½èƒ½çœ‹è¦‹ï¼Œä¸è¢«è£åˆ‡ */
    animation: wobble 6s ease-in-out infinite;
}

.comment-img-top {
    position: absolute;
    width: 100%; height: 100%;
    z-index: 20; /* åœ¨ä¸»å›¾ä¸Šæ–¹ */
    object-fit: cover;
    opacity: 0;
    /* æ ¸å¿ƒä¿®æ”¹ç‚¹ï¼š */
    /* ç¬¬ä¸€ä¸ªæ•°å­— 0.8s æ˜¯â€œå˜ä¸é€æ˜â€çš„è¿‡ç¨‹è€—æ—¶ */
    /* ç¬¬äºŒä¸ªæ•°å­— 1s æ˜¯â€œç­‰å¤šä¹…æ‰å¼€å§‹å˜â€ */
    transition: opacity 0.6s ease 0.7s; /* æŠ½å±‰æ‹‰å‡ºåæ¸æ˜¾ */
}
.guide-row.active .comment-img-top { opacity: 1; }

/* ä¸»å†…å®¹å±‚çº§ */
.guide-row .equip-unit, 
.guide-row .justice-grid {
    position: relative;
    z-index: 10; /* å¤¹åœ¨ä¸­é—´ */
}

/* å°ˆé–€é‡å°ç¬¬ä¸‰è¡Œçš„æŠ½å±œåœ–ç‰‡é€²è¡Œä½ç§» */
.guide-row.row-comparison .drawer-wrapper {
    /* åŸæœ¬æ˜¯ 50%ï¼Œæ•¸å€¼è¶Šå¤§è¶Šé ä¸‹ */
    top: 50% !important; 
    
    /* å¦‚æœä½ å¸Œæœ›æ›´ç²¾ç¢ºåœ°ç§»å‹•ï¼Œä¹Ÿå¯ä»¥ç”¨ calc */
    /* top: calc(50% + 100px) !important; */
}

/* å¦‚æœä½ ä¹‹å‰æ¡ç”¨äº†å°‡ back å’Œ front æ‹†é–‹çš„æ–¹æ¡ˆï¼Œå‰‡ä½¿ç”¨é€™å€‹ï¼š */
.guide-row.row-comparison .drawer-back,
.guide-row.row-comparison .drawer-front {
    top: 65% !important;
}
/* --- å°ˆé–€å¾®èª¿ç¬¬ä¸‰è¡Œï¼ˆå°æ¯”è¡Œï¼‰çš„å·¦å³ä½ç½® --- */

/* 1. å·¦å´æŠ½å±œ (L3_back & L3_front) */
.row-comparison .drawer-left {
    /* åŸæœ¬æ˜¯ 0ã€‚å¦‚æœä½ æƒ³è®“å®ƒå¾€å³ç§»ä¸€é»ï¼ˆç¸®é€²å»ï¼‰ï¼Œå°±æ”¹æˆæ­£æ•¸ï¼ˆå¦‚ 20pxï¼‰ */
    /* å¦‚æœæƒ³è®“å®ƒå¾€å·¦ç§»ä¸€é»ï¼ˆæ›´é é‚Šï¼‰ï¼Œå°±æ”¹æˆè² æ•¸ï¼ˆå¦‚ -20pxï¼‰ */
    left: 0px !important; 
}

/* 2. å³å´æŠ½å±œ (R3_back & R3_front) */
.row-comparison .drawer-right {
    /* åŸæœ¬æ˜¯ 0ã€‚å¦‚æœä½ æƒ³è®“å®ƒå¾€å·¦ç§»ä¸€é»ï¼ˆç¸®é€²å»ï¼‰ï¼Œå°±æ”¹æˆæ­£æ•¸ï¼ˆå¦‚ 20pxï¼‰ */
    /* å¦‚æœæƒ³è®“å®ƒå¾€å³ç§»ä¸€é»ï¼ˆæ›´é é‚Šï¼‰ï¼Œå°±æ”¹æˆè² æ•¸ï¼ˆå¦‚ -20pxï¼‰ */
    right: 0px !important; 
}

/* æ˜¾æ‘†å›¾ç‰‡æ ·å¼ ( Showing-off ) */
.show-off-img {
    position: absolute;
    width: 100px; height: 100px;
    z-index: 50; /* æœ€é«˜å±‚çº§ */
    animation: wobble 4s ease-in-out infinite;
    filter: drop-shadow(0 0 15px var(--glow-color)); /* æŒ‰ç…§å›¾ç‰‡è¾¹ç¼˜å‘å…‰ */
    pointer-events: none;
}

@keyframes wobble {
    0%, 100% { transform: rotate(-1.5deg); }
    50% { transform: rotate(1.5deg); }
}

/* 1. ç¢ºä¿ç« ç¯€å®¹å™¨åº•éƒ¨æ²’æœ‰å…§é‚Šè· */
.ov-section {
    padding-bottom: 0 !important;
    
}

/* 2. ç¢ºä¿è²¼åº•åœ–ç‰‡æ²’æœ‰ä»»ä½•é‚Šè· */
.guide-final-full, .equip-final-full {
    margin-bottom: 0 !important;
    display: block; /* æ¶ˆé™¤åœ–ç‰‡ä¸‹æ–¹çš„è¡Œå…§é–“éš™ */
}

/* 3. ç¢ºä¿ä¸‹ä¸€å€‹ç« ç¯€ç·Šè²¼ä¸Šä¾† */
#ov-combat, #ov-justice {
    margin-top: 0 !important;
}
/* ============================================================
   æ‰‹æ©Ÿç«¯ (Mobile) å°éŠé ç¬¬ä¸‰è¡Œï¼šå¼·åˆ¶ä¸¦æ’ä¸”ä½” 90%
   ============================================================ */
@media (max-width: 768px) {
    
    /* 1. å¼·åˆ¶ç¶²æ ¼ç‚ºå…©åˆ—ä¸¦æ’ï¼Œå¯¬åº¦ 90% */
    #ov-guide .row-comparison .justice-grid {
        width: 90% !important; /* ä½”å±å¹• 90% */
        display: grid !important; 
        grid-template-columns: 1fr 1fr !important; /* å¼·åˆ¶å…©åˆ—ä¸¦æ’ */
        gap: 8px !important;    /* ç¸®å°ä¸­é–“é–“è·ï¼Œç¯€çœç©ºé–“ */
        margin: 0 auto !important;
    }

    /* 2. å£“ç¸®å…§éƒ¨çš„ç»ç’ƒæ¡†ç´°ç¯€ï¼Œé˜²æ­¢å…§å®¹æº¢å‡º */
    #ov-guide .row-comparison .equip-glass-card {
        width: 100% !important;
        padding: 0 !important; /* å»æ‰å¤šé¤˜é‚Šè· */
    }

    #ov-guide .row-comparison .equip-card-header {
        font-size: 11px !important; /* æ¨™é¡Œç¸®å° */
        padding: 5px !important;
    }

    /* 3. æ ¸å¿ƒå…§å®¹å£“ç¸®ï¼šè®“æ–‡å­—å’Œå¡Šè®Šå° */
    #ov-guide .row-comparison .equip-card-body {
        padding: 10px 5px !important; /* ç¸®æ¸›å…§é‚Šè· */
        font-size: 10px !important;   /* å­—é«”ç¸®å°åˆ°æ¥µé™ */
        line-height: 1.2 !important;
    }

    /* ç¸®å°æ–‡å­—èƒŒæ™¯å¡Š */
    #ov-guide .row-comparison .equip-card-body div[style*="background"] {
        padding: 4px 2px !important;
        margin: 2px 0 !important;
        font-size: 9px !important;
    }

    /* 4. å¼·åˆ¶ç¸®å°å‚ç›´ç®­é ­ï¼Œå¦å‰‡æœƒæ‹‰å¾—éå¸¸é•· */
    #ov-guide .row-comparison .flow-arrow {
        font-size: 24px !important; /* ç®­é ­å¾ 60px ç¸®å°åˆ° 24px */
        height: 30px !important; 
        line-height: 1 !important;
        margin: 2px 0 !important;
    }

    /* 5. ä¸‹æ–¹çš„å…¬æ­£è† å›Šä¹Ÿè¦åŒæ­¥è®Šå° */
    #ov-guide .row-comparison .justice-capsule {
        font-size: 9px !important;
        padding: 4px 0 !important;
        border-width: 1px !important;
        margin-top: 8px !important;
    }
}
.combat-intro-header {
    width: 70%;
    aspect-ratio: 16 / 9;
    margin: 0 auto;
    display: block;
    object-fit: cover;
    border: none !important;
    box-shadow: none !important;
}

@media (max-width: 768px) {
    .combat-intro-header {
        width: 100% !important;
    }
}
</style>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

<div id="battle-modal" class="battle-modal" onclick="closeBattleModal()">
    <div class="battle-modal-content" onclick="event.stopPropagation()">
        <img id="battle-modal-img" src="" alt="é¢„è§ˆ" onclick="closeBattleModal()" style="cursor: zoom-out;">
        
        <div class="battle-modal-nav" onclick="event.stopPropagation()">
            <button class="nav-btn-char prev" onclick="changeBattleImage(-1)">â®</button>
            <button class="nav-btn-char next" onclick="changeBattleImage(1)">â¯</button>
        </div>
    </div>
</div>


<div class="modal-overlay" id="modal">
    <div class="modal-window">
        <div class="m-stripe" id="m-stripe"></div>
        <div class="close-btn" onclick="closeModal()">Ã—</div>
        <div class="m-left">
        </div>
        <div class="m-right">
            <div class="m-time" id="m-time"></div>
            <div class="m-title" id="m-title"></div>
            <div class="m-desc" id="m-desc"></div>
        </div>
    </div>
</div>

<div class="navbar">
    <div class="nav-left-zone">
        <div class="nav-logo-box">
            <img src="images/icon/website_logo.png" alt="LOGO"> 
        </div>
        <div class="nav-title-box">
            <div class="nav-title-main">ä¸å…¬æ­£çš„å“ˆå°¼</div>
            <div class="nav-title-sub">æ–‘ä¸˜èµ„æ–™åº“</div>
        </div>
    </div>

    <div class="nav-tabs-container">
        <div class="nav-tab tab-home active" onclick="switchView('home', this)">é¦–é¡µ</div>
        <div class="nav-tab tab-overview" onclick="switchView('overview', this)">æ¸¸æˆæ€»è§ˆ</div>
        <div class="nav-tab tab-chars" onclick="switchView('chars', this)">äººç‰©æ¡£æ¡ˆ</div>
        <div class="nav-tab tab-scenery" onclick="switchView('scenery', this)">æ–‘ä¸˜æ™¯è‰²</div>
        <div class="nav-tab tab-cards" onclick="switchView('cards', this)">æ–‘ä¸˜å¡ç‰Œ</div>
        <div class="nav-tab tab-story" onclick="switchView('story', this)">å‰§æƒ…å¤‡å¿˜å½•</div>
        <div class="nav-tab tab-others" onclick="switchView('others', this)">å…¶ä»–</div>
    </div>

    <div class="nav-toggle-btn" onclick="toggleMobileMenu()">â˜°</div>
</div>

<div class="mobile-menu-overlay" id="mobileMenu">
    <div class="m-nav-item" onclick="switchView('home', null)" style="--color:var(--tab-home)"><div class="m-dot"></div>é¦–é¡µ</div>
    <div class="m-nav-item" onclick="switchView('overview', null)" style="--color:var(--tab-overview)"><div class="m-dot"></div>æ¸¸æˆæ€»è§ˆ</div>
    <div class="m-nav-item" onclick="switchView('chars', null)" style="--color:var(--tab-chars)"><div class="m-dot"></div>äººç‰©æ¡£æ¡ˆ</div>
    <div class="m-nav-item" onclick="switchView('scenery', null)" style="--color:var(--tab-scenery)"><div class="m-dot"></div>æ–‘ä¸˜æ™¯è‰²</div>
    <div class="m-nav-item" onclick="switchView('cards', null)" style="--color:var(--tab-cards)"><div class="m-dot"></div>æ–‘ä¸˜å¡ç‰Œ</div>
    <div class="m-nav-item" onclick="switchView('story', null)" style="--color:var(--tab-story)"><div class="m-dot"></div>å‰§æƒ…å¤‡å¿˜å½•</div>
    <div class="m-nav-item" onclick="switchView('others', null)" style="--color:var(--tab-others)"><div class="m-dot"></div>å…¶ä»–</div>
</div>

<div id="backToTop" class="back-to-top" onclick="scrollToTop()">
    <svg viewBox="0 0 24 24"><path d="M12 4l-8 8h6v8h4v-8h6z"/></svg>
</div>

<div class="main-view">
    
    <div id="view-home" class="view-section active">
        <div class="home-facade-container">
            <div class="home-bg-layer" style="background-image: url('images/home/bg_full.png');"></div>

            <div class="home-bg-wings-wrapper" id="home-wings">
                <div class="home-bg-side left" style="background-image: url('images/home/bg_left.png');"></div>
                <div class="home-bg-side right" style="background-image: url('images/home/bg_right.png');"></div>
            </div>

            <div class="home-main-visual" id="home-main-box">
                <img src="images/home/visual.png" alt="Main Visual" id="home-main-img">
            </div>

            <div class="home-top-overlay">
                <img src="images/home/overlay.png" alt="Top Overlay">
            </div>

            <div class="home-nav-footer">
                <div class="home-note-btn" onclick="switchView('overview', null)" style="--note-color: var(--tab-overview)">
                    <span class="note-num">01<br>å…ˆçœ‹æˆ‘ï¼</span><span class="note-text">æ¸¸æˆæ€»è§ˆ</span>
                </div>
                <div class="home-note-btn" onclick="switchView('chars', null)" style="--note-color: var(--tab-chars)">
                    <span class="note-num">02</span><span class="note-text">äººç‰©</span>
                </div>
                <div class="home-note-btn" onclick="switchView('scenery', null)" style="--note-color: var(--tab-scenery)">
                    <span class="note-num">03</span><span class="note-text">åœºæ™¯</span>
                </div>
                <div class="home-note-btn" onclick="switchView('cards', null)" style="--note-color: var(--tab-cards)">
                    <span class="note-num">04</span><span class="note-text">å¡ç‰Œ</span>
                </div>
                <div class="home-note-btn" onclick="switchView('story', null)" style="--note-color: var(--tab-story)">
                    <span class="note-num">05</span><span class="note-text">å¤‡å¿˜</span>
                </div>
                <div class="home-note-btn" onclick="switchView('others', null)" style="--note-color: var(--tab-others)">
                    <span class="note-num">06</span><span class="note-text">å…¶ä»–</span>
                </div>
            </div>
        </div>
    </div>

    <div id="view-overview" class="view-section"></div>

    <div id="view-chars" class="view-section"> 
        <div id="char-root-container" style="width: 100%; min-height: 100%;"></div>
    </div>

    <div id="view-scenery" class="view-section">
        <div id="bqv-overview-wrap"></div>
        <div id="bqv-dynamic-root"></div>
    </div>

    <div id="view-cards" class="view-section">
        <div class="bqc-main-container" id="bqcApp"></div>
    </div>

<div id="view-story" class="view-section">
    <div class="mobile-toc-bar" onclick="toggleMobileTOC(true)">
        <span class="toc-icon">â˜°</span>
        <span id="mobile-toc-current-text">æ­£æ–‡ï¼šå¼€å§‹é˜…è¯»</span>
    </div>

<div id="mobile-toc-modal" class="mobile-toc-modal" onclick="toggleMobileTOC(false)">
    
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h3>ç›®éŒ„</h3>
            <button class="close-btn" onclick="toggleMobileTOC(false)">âœ•</button>
        </div>
        <div id="mobile-toc-list" class="mobile-toc-body"></div>
    </div>
</div>
    
        <div class="story-wrapper">
            <div class="story-content markdown-body" id="story-render-area"></div>
            <div class="story-sidebar">
                <div class="story-toc-container">
                    <div class="toc-title">ç›®å½•</div>
                    <div id="story-toc-list" class="toc-list"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="view-others" class="view-section">
        <div class="rules-wrapper">
            <div class="paste-zone"><h2>å…¶ä»–è§„åˆ™</h2><p>æ­¤å¤„å†…å®¹å·²åŒæ­¥</p></div>
        </div>
    </div>

</div> ```

<div id="bqc-jump-menu" class="jump-menu-overlay" onclick="toggleBqcMenu()">
    <div class="jump-menu-content">
        <div class="jump-title">å¡ç‰Œç›®å½•</div>
        <div class="jump-list" id="bqc-jump-list"></div>
    </div>
</div>

<div id="char-jump-menu" class="jump-menu-overlay" onclick="toggleCharMenu()">
    <div class="jump-menu-content">
        <div class="jump-title">æ¡£æ¡ˆç›®å½•</div>
        <div class="jump-list" id="char-jump-list"></div>
    </div>
</div>

<div id="bqv-jump-menu" class="jump-menu-overlay" onclick="toggleBqvMenu()">
    <div class="jump-menu-content">
        <div class="jump-title">æ™¯è‰²ç´¢å¼•</div>
        <div class="jump-list" id="bqv-jump-list"></div>
    </div>
</div>






<div id="ov-jump-menu" class="jump-menu-overlay" onclick="toggleOvMenu()">
    <div class="jump-menu-content">
        <div class="jump-title">ç¸½è¦½ç« ç¯€</div>
        <div class="jump-list">
            <div class="jump-btn" onclick="scrollToOv('guide', event)" style="border-left-color: #FFD700; color: #FFD700">å¼€å§‹å§ï¼</div>
            <div class="jump-btn" onclick="scrollToOv('combat', event)" style="border-left-color: var(--tab-scenery); color: var(--tab-scenery)">æˆ˜æ–—å§ï¼</div>
            <div class="jump-btn" onclick="scrollToOv('equip', event)" style="border-left-color: var(--tab-cards); color: var(--tab-cards)">è£…å¤‡å§ï¼</div>
            <div class="jump-btn" onclick="scrollToOv('justice', event)" style="border-left-color: var(--tab-chars); color: var(--tab-chars)">ä¸å…¬æ­£å§ï¼</div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="char-modal">
    
    <div class="broken-portrait-container">
        <img id="m-battle-img" class="broken-portrait-img" src="" alt="Battle Art">
    </div>

    <div class="char-modal-window">
        
        <div id="m-big-name" class="broken-name">NICKNAME</div>

        <div class="close-btn" onclick="closeCharModal()">Ã—</div>
        
        <div class="modal-left">
            <div class="modal-portrait-placeholder" id="m-portrait-box">
                <img id="m-portrait" src="" style="width:100%; height:100%; object-fit:cover; display:none;">
                <span id="m-portrait-text" style="color:#333;">ç«‹ç»˜æš‚ç¼º</span>
            </div>
        </div>

        <div class="modal-right">
            <div class="modal-top-section">
                <div class="modal-top-row">
                    <div class="info-panel">
                        <div class="info-header">åŸºæœ¬æ¡£æ¡ˆ</div>
                        <div class="info-grid-styled">
                            <div class="info-capsule full"><span class="ic-label">å¤–å· / æœ¬å</span><span class="ic-value" id="m-name">-</span></div>
                            <div class="info-capsule"><span class="ic-label">æ€§åˆ« / å¹´é¾„</span><span class="ic-value"><span id="m-gender">-</span> / <span id="m-age">-</span></span></div>
                            <div class="info-capsule"><span class="ic-label">èŒä¸šå°è±¡</span><span class="ic-value" id="m-job">-</span></div>
                            <div class="info-capsule full"><span class="ic-label">å‡ºèº«å­¦æ ¡</span><span class="ic-value" id="m-school">-</span></div>
                            <div class="info-capsule"><span class="ic-label">æ‰€å±ç¤¾å›¢</span><span class="ic-value" id="m-society">-</span></div>
                            <div class="info-capsule"><span class="ic-label">åŠ å…¥æ—¶é—´</span><span class="ic-value" id="m-join">-</span></div>
                        </div>
                    </div>

                    <div class="stats-panel">
                        <div class="attr-slots">
                            <div class="attr-img-box" id="m-attr1"></div>
                            <div class="attr-img-box" id="m-attr2"></div>
                        </div>
                        <div class="stats-container">
                            <div class="stat-row"><div class="stat-name">ä½“åŠ›</div><div class="stat-bar-bg"><div class="stat-bar-fill" id="bar-hp"></div></div><div class="stat-num" id="val-hp">0</div></div>
                            <div class="stat-row"><div class="stat-name">ç‰©æ”»</div><div class="stat-bar-bg"><div class="stat-bar-fill" id="bar-patk"></div></div><div class="stat-num" id="val-patk">0</div></div>
                            <div class="stat-row"><div class="stat-name">ç‰©é˜²</div><div class="stat-bar-bg"><div class="stat-bar-fill" id="bar-pdef"></div></div><div class="stat-num" id="val-pdef">0</div></div>
                            <div class="stat-row"><div class="stat-name">æ³•æ”»</div><div class="stat-bar-bg"><div class="stat-bar-fill" id="bar-matk"></div></div><div class="stat-num" id="val-matk">0</div></div>
                            <div class="stat-row"><div class="stat-name">æ³•é˜²</div><div class="stat-bar-bg"><div class="stat-bar-fill" id="bar-mdef"></div></div><div class="stat-num" id="val-mdef">0</div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-bottom-row">
                <div class="bio-text-area">
                    <div class="bio-area">
                        <div id="m-bio"></div>
                    </div>
                </div>
                <div class="logos-area">
                    <div class="logo-box">
                        <img id="m-school-logo" src="" style="object-fit:contain; display:none;">
                        <span id="m-school-text">æ ¡å¾½</span>
                    </div>
                    <div class="logo-box">
                        <img id="m-society-logo" src="" style="object-fit:contain; display:none;">
                        <span id="m-society-text">ç¤¾å›¢</span>
                    </div>
                </div>
            </div>
        </div>
    <div class="nav-controls">
        <div id="btn-prev" class="nav-btn-char" onclick="navigateChar(-1)">â®</div>
        
        <div id="btn-next" class="nav-btn-char" onclick="navigateChar(1)">â¯</div>
    </div>
        </div> </div>
    </div>
</div>

<div class="bqc-modal-overlay" id="bqcModal">
    <div class="bqc-close-hint">&times;</div>
    
    <div class="bqc-modal-content" id="bqcTiltCard">
        <div id="bqcShine" class="bqc-card-shine"></div>
        <img src="" alt="Card Big" class="bqc-modal-img" id="bqcBigImg">
    </div>

    <div class="nav-controls bqc-nav-pos">
        <div id="btn-card-prev" class="nav-btn-char" onclick="navigateCard(-1)">â®</div>
        <div id="btn-card-next" class="nav-btn-char" onclick="navigateCard(1)">â¯</div>
    </div>
</div>

<div class="bqv-modal-overlay" id="bqvModal">
    <div class="bqv-modal-logo-box">
        <img id="bqv-modal-logo" src="" alt="Chapter Logo">
        <span id="bqv-modal-chapter-name"></span>
    </div>

    <div class="bqv-modal-close" onclick="closeBqvModal()">&times;</div>

    <div class="bqv-modal-content">
        <img id="bqv-modal-img" src="" alt="View Large">
    </div>

    <div class="bqv-modal-controls">
        <div class="nav-btn-char bqv-ctrl" onclick="navigateBqv(-1)">â®</div>
        <div class="nav-btn-char bqv-ctrl" onclick="navigateBqv(1)">â¯</div>
    </div>



</div>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
/* ================= å¯¼èˆªä¸äº¤äº’é€»è¾‘ ================= */

function switchView(viewId, btn) {
    // 1. éšè—æ‰€æœ‰é¡µé¢
    document.querySelectorAll('.view-section').forEach(el => {
        el.classList.remove('active');
        el.style.display = 'none';
    });

    // 2. è·å–ç›®æ ‡é¡µé¢
    const target = document.getElementById('view-' + viewId);
    if (target) {
        target.classList.add('active');
        target.style.display = 'block';

        // --- ã€æ ¸å¿ƒåŠŸèƒ½ï¼šéé¦–é¡µè§¦å‘å›é¡¶åŠ¨ç”»ã€‘ ---
        if (viewId !== 'home') {
            // å…ˆå…³é—­å¹³æ»‘æ»šåŠ¨ï¼Œç¬é—´è·³åˆ° 1500px
            target.style.scrollBehavior = 'auto';
            target.scrollTop = 2000;

            // åœ¨ä¸‹ä¸€å¸§å¼€å¯å¹³æ»‘æ»šåŠ¨ï¼Œå¹¶æ»šå›é¡¶éƒ¨
            requestAnimationFrame(() => {
                target.style.scrollBehavior = 'smooth';
                target.scrollTop = 0;
            });
        } else {
            // é¦–é¡µç›´æ¥å›é¡¶ï¼Œä¸æ’­æ”¾åŠ¨ç”»
            target.style.scrollBehavior = 'auto';
            target.scrollTop = 0;
        }
    }

    // 3. ç¦»å¼€ä¸»é¡µæ—¶çš„ 3D ç¿…è†€æ¸…ç†é€»è¾‘ [ä¿æŒä¸å˜]
    const wings = document.getElementById('home-wings');
    if (viewId !== 'home' && wings) {
        wings.style.transform = 'rotateX(0deg) rotateY(0deg)';
    }

    // 4. æ›´æ–°å¯¼èˆªæ ‡ç­¾é«˜äº® [ä¿æŒä¸å˜]
    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
    if (btn) {
        btn.classList.add('active');
    } else {
        const desktopTab = document.querySelector(`.nav-tab.tab-${viewId}`);
        if(desktopTab) desktopTab.classList.add('active');
    }

    // 5. æ‰‹æœºç«¯æ”¶èµ·èœå• [ä¿æŒä¸å˜]
    const mobileMenu = document.getElementById('mobileMenu');
    if(mobileMenu) mobileMenu.classList.remove('open');

    // è§¦å‘å…¶ä»–é¡µé¢çš„æ»šåŠ¨ç›‘å¬
    if (typeof checkScroll === 'function') checkScroll();
}
// 2. æ‰‹æœºèœå•å¼€å…³
function toggleMobileMenu() {
    const menu = document.getElementById('mobileMenu');
    menu.classList.toggle('open');
}

// 3. å›åˆ°é¡¶éƒ¨é€»è¾‘
const backToTopBtn = document.getElementById('backToTop');

function scrollToTop() {
    // æ‰¾åˆ°å½“å‰æ¿€æ´»çš„é¡µé¢
    const activeSection = document.querySelector('.view-section.active');
    if (activeSection) {
        activeSection.scrollTo({ top: 0, behavior: 'smooth' });
    }
}

// 4. ç›‘å¬æ»šåŠ¨ (æ˜¾ç¤º/éšè—å›åˆ°é¡¶éƒ¨æŒ‰é’®)
function checkScroll() {
    const activeSection = document.querySelector('.view-section.active');
    if (activeSection) {
        // å½“æ»šåŠ¨è¶…è¿‡ 300px æ—¶æ˜¾ç¤ºæŒ‰é’®
        if (activeSection.scrollTop > 300) {
            backToTopBtn.classList.add('visible');
        } else {
            backToTopBtn.classList.remove('visible');
        }
    }
}

// ç»™æ‰€æœ‰ view-section æ·»åŠ æ»šåŠ¨ç›‘å¬
document.addEventListener('DOMContentLoaded', () => {
    const sections = document.querySelectorAll('.view-section');
    sections.forEach(sec => {
        sec.addEventListener('scroll', checkScroll);
    });
});


    const modal = document.getElementById('modal');
    const mStripe = document.getElementById('m-stripe');
    const mTime = document.getElementById('m-time');
    const mTitle = document.getElementById('m-title');
    const mDesc = document.getElementById('m-desc');

/* === [ä¿®å¤] äº‹ä»¶å¡ç‚¹å‡»é€»è¾‘ï¼šè¾¹æ¡†å˜è‰² === */
document.querySelectorAll('.card').forEach(card => {
    card.addEventListener('click', () => {
        // 1. è·å–å¼¹çª—å…ƒç´ 
        const modalWin = document.querySelector('.modal-window');
        const mTime = document.getElementById('m-time');
        const mTitle = document.getElementById('m-title');
        const mDesc = document.getElementById('m-desc');
        const modal = document.getElementById('modal'); // è·å–å¤§é®ç½©å±‚

        // 2. å¡«å……å†…å®¹
        mTime.innerText = card.getAttribute('data-time');
        mTitle.innerText = card.getAttribute('data-title');
        mDesc.innerHTML = card.getAttribute('data-desc');

        // 3. ã€æ ¸å¿ƒä¿®å¤ã€‘è¾¹æ¡†é¢œè‰²åŒ¹é…é€»è¾‘
        const cl = card.classList;

        // A. å…ˆé‡ç½®ï¼šé»˜è®¤ç°è‰²ï¼Œæ¸…é™¤æ¸å˜
        modalWin.style.borderColor = '#666'; 
        modalWin.style.borderImage = 'none';
        modalWin.style.borderWidth = '4px';
        modalWin.style.borderStyle = 'solid';

        // B. åˆ¤æ–­é¢œè‰²
        if (cl.contains('bd-sb')) {
            // è‰è“ï¼šæ¸å˜è¾¹æ¡†
            modalWin.style.borderImage = 'linear-gradient(to right, #00FF7F, #FF0055) 1';
        } 
        else if (cl.contains('bd-wc')) {
            // é‡çŒ«ï¼šæ¸å˜è¾¹æ¡†
            modalWin.style.borderImage = 'linear-gradient(to right, #FFD700, #0000FF) 1';
        }
        else if (cl.contains('bd-yu')) {
            modalWin.style.borderColor = 'var(--c-yu)';
        }
        else if (cl.contains('bd-kid')) {
            modalWin.style.borderColor = 'var(--c-kid)';
        }
        else if (cl.contains('bd-hei')) {
            modalWin.style.borderColor = 'var(--c-hei)';
        }
        else if (cl.contains('bd-yan')) {
            modalWin.style.borderColor = 'var(--c-yan)';
        }
        else if (cl.contains('bd-piao')) {
            modalWin.style.borderColor = 'var(--c-piao)';
        }
        else {
            // NPC æˆ–å…¶ä»–ï¼šä¿æŒé»˜è®¤æ·±ç°
            modalWin.style.borderColor = '#666'; 
        }

        // 4. æ˜¾ç¤ºçª—å£
        modal.style.display = 'flex';
    });
});

    function closeModal() {
        modal.style.display = 'none';
    }
    
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
// =========================================================================
    // PART 3: äººç‰©æ¡£æ¡ˆé€»è¾‘ (å·²é‡å‘½åé˜²æ­¢å†²çª)
    // =========================================================================
    
    // 1. èµ„æºå­—å…¸

    // [æ–°å¢] ä¸»é¡µè§†è§‰èµ„æºå­—å…¸
    const HomeAssets = {
    bgFull: 'images/home/bg_full.png',      // æœ€åº•å±‚ 16:9 å…¨å±èƒŒæ™¯ (çº¢è‰²æ–¹æ¡†)
    mainVisual: 'images/home/visual.png',  // ä¸­é—´å±‚ 16:9 ä¸»è§†è§‰ (é»‘è‰²æ–¹æ¡†)
    topOverlay: 'images/home/overlay.png', // æœ€ä¸Šå±‚ 3:1 è£…é¥°å›¾ (çº¦85%å®½åº¦)
    bgLeft: 'images/home/bg_left.png',      // 6:9 å·¦ä¾§èƒŒæ™¯
    bgRight: 'images/home/bg_right.png',    // 6:9 å³ä¾§èƒŒæ™¯
    specialVisual: 'images/home/visual_special.png', // ç‚¹å‡»åé—ªç°çš„å›¾ç‰‡
    thirdVisual: 'images/home/visual_third.png' // ã€æ·»åŠ è¿™ä¸€è¡Œã€‘
};

        // å±æ€§å—
    const Attrs = {
        METAL: 'images/icon/UI_StatCube_iron_color_01.png', 
        WOOD: 'images/icon/UI_StatCube_wood_color_01.png', 
        WATER: 'images/icon/UI_StatCube_water_color_01.png', 
        FIRE: 'images/icon/UI_StatCube_fire_color_01.png',
        EARTH: 'images/icon/UI_StatCube_earth_color_01.png', 
        WIND: 'images/icon/UI_StatCube_wind_color_01.png', 
        THUNDER: 'images/icon/UI_StatCube_thunder_color_01.png', 
        ICE: 'images/icon/UI_StatCube_ice_color_01.png',
        CRYSTAL: 'images/icon/UI_StatCube_crystal_color_01.png', 
        SUN: 'images/icon/UI_StatCube_sun_color_01.png', 
        MOON: 'images/icon/UI_StatCube_moon_color_01.png', 
        DUST: 'images/icon/UI_StatCube_dust_color_01.png',
        STAR: 'images/icon/UI_StatCube_star_color_01.png', 
        LIGHT: 'images/icon/UI_StatCube_light_color_01.png', 
        WAVE: 'images/icon/UI_StatCube_wave_color_01.png'
    };


        // æ ¡å¾½
    const Schools = { 
        XIWAN: 'images/charData/schoolbadges/badge_xiwan.png', 
        JIANGKOU: 'images/charData/schoolbadges/badge_jiangkou.png', 
        HANI: 'images/charData/schoolbadges/badge_hani.png', 
        LINZHOU: 'images/charData/schoolbadges/badge_linzhou.png', 
        PINGXIAN: 'images/charData/schoolbadges/badge_pingxian.png', 
        JINGU: 'images/charData/schoolbadges/badge_jingu.png', 
        CHONGJIANG: 'images/charData/schoolbadges/badge_chongjiang.png', 
        ZHONGLIAO: 'images/charData/schoolbadges/badge_zhongliao.png', 
        HUAGANG: 'images/charData/schoolbadges/badge_huagang.png' 
    };


        // ç¤¾å›¢å°ç« 
    const Societies = { 
        FRIEND: 'images/charData/soclogos/logo_friend.png', 
        TOWER: 'images/charData/soclogos/logo_tower.png', 
        BAD: 'images/charData/soclogos/logo_bad.png', 
        FACTORY: 'images/charData/soclogos/logo_factory.png', 
        PLAZA: 'images/charData/soclogos/logo_plaza.png', 
        HANI: 'images/charData/soclogos/logo_hani.png', 
        STARS: 'images/charData/soclogos/logo_stars.png', 
        MAO: 'images/charData/soclogos/logo_mao.png', 
        WHITE: 'images/charData/soclogos/logo_white.png', 
        UNION: 'images/charData/soclogos/logo_union.png', 
        RADIO: 'images/charData/soclogos/logo_radio.png', 
        TUCTUC: 'images/charData/soclogos/logo_tuctuc.png', 
        SODA4: 'images/charData/soclogos/logo_soda4.png', 
        BUKLL: 'images/charData/soclogos/logo_bukll.png' 

    };


        // è§’è‰²å¤´åƒ
    const CardImages = {
        YUMU: 'images/charData/cards/card_yumu.png', 
        ZHOU: 'images/charData/cards/card_zhou.png', 
        COTTON: 'images/charData/cards/card_cotton.png', 
        SONG: 'images/charData/cards/card_song.png',
        STONE: 'images/charData/cards/card_stone.png', 
        MASTER: 'images/charData/cards/card_master.png', 
        COCO: 'images/charData/cards/card_coco.png', 
        XIAOBEI: 'images/charData/cards/card_xiaobei.png',
        HEI: 'images/charData/cards/card_hei.png', 
        HUA: 'images/charData/cards/card_hua.png', 
        BAN: 'images/charData/cards/card_ban.png', 
        HONG: 'images/charData/cards/card_hong.png',
        PIAO: 'images/charData/cards/card_piao.png', 
        CAT: 'images/charData/cards/card_cat.png', 
        DOU: 'images/charData/cards/card_dou.png',
        SB: 'images/charData/cards/card_sb.png', 
        NAO: 'images/charData/cards/card_nao.png',
        KID: 'images/charData/cards/card_kid.png', 
        XHANI: 'images/charData/cards/card_xhani.png', 
        NURSE: 'images/charData/cards/card_nurse.png', 
        DREAM: 'images/charData/cards/card_dream.png', 
        CANDY: 'images/charData/cards/card_candy.png', 
        KING: 'images/charData/cards/card_king.png', 
        WAX: 'images/charData/cards/card_wax.png', 
        PIGEON: 'images/charData/cards/card_pigeon.png',
        PIKA: 'images/charData/cards/card_pika.png', 
        DING: 'images/charData/cards/card_ding.png', 
        BUTA: 'images/charData/cards/card_buta.png',
        XDQ: 'images/charData/cards/card_xdq.png', 
        penguin: 'images/charData/cards/card_penguin.png', 
        PAO: 'images/charData/cards/card_pao.png', 
        ZHE: 'images/charData/cards/card_zhe.png', 
        TIE: 'images/charData/cards/card_tie.png', 
        BULIAN: 'images/charData/cards/card_bulian.png',
        PEACH: 'images/charData/cards/card_peach.png',
        SWEET: 'images/charData/cards/card_sweet.png',
        KFLOWER: 'images/charData/cards/card_kflower.png',
        YAN: 'images/charData/cards/card_yan.png',
        NOBODY: 'images/charData/cards/card_nobody.png',
        NOHANI: 'images/charData/cards/card_nohani.png'
    };

    
        // æˆ˜æ–—ç«‹ç»˜
    const BattleArts = {
        YUMU: 'images/charData/battle/battle_yumu.png', 
        ZHOU: 'images/charData/battle/battle_zhou.png', 
        COTTON: 'images/charData/battle/battle_cotton.png', 
        SONG: 'images/charData/battle/battle_song.png',
        STONE: 'images/charData/battle/battle_stone.png', 
        MASTER: 'images/charData/battle/battle_master.png', 
        COCO: 'images/charData/battle/battle_coco.png', 
        XIAOBEI: 'images/charData/battle/battle_xiaobei.png',
        HEI: 'images/charData/battle/battle_hei.png', 
        HUA: 'images/charData/battle/battle_hua.png', 
        BAN: 'images/charData/battle/battle_ban.png', 
        HONG: 'images/charData/battle/battle_hong.png',
        PIAO: 'images/charData/battle/battle_piao.png', 
        CAT: 'images/charData/battle/battle_cat.png', 
        DOU: 'images/charData/battle/battle_dou.png',
        SB: 'images/charData/battle/battle_sb.png', 
        NAO: 'images/charData/battle/battle_nao.png',
        KID: 'images/charData/battle/battle_kid.png', 
        XHANI: 'images/charData/battle/battle_xhani.png', 
        NURSE: 'images/charData/battle/battle_nurse.png', 
        DREAM: 'images/charData/battle/battle_dream.png', 
        CANDY: 'images/charData/battle/battle_candy.png', 
        KING: 'images/charData/battle/battle_king.png', 
        WAX: 'images/charData/battle/battle_wax.png', 
        PIGEON: 'images/charData/battle/battle_pigeon.png',
        PIKA: 'images/charData/battle/battle_pika.png', 
        DING: 'images/charData/battle/battle_ding.png', 
        BUTA: 'images/charData/battle/battle_buta.png',
        XDQ: 'images/charData/battle/battle_xdq.png', 
        penguin: 'images/charData/battle/battle_penguin.png',
        PAO: 'images/charData/battle/battle_pao.png', 
        ZHE: 'images/charData/battle/battle_zhe.png', 
        TIE: 'images/charData/battle/battle_tie.png', 
        BULIAN: 'images/charData/battle/battle_bulian.png',
        YAN: 'images/charData/battle/battle_yan.png', 
        DEFAULT: 'images/charData/battle/battle_default.png'
    };

    // æˆ˜æ–—æˆªå›¾
    const OverviewAssets = {
    banner: 'images/overview/header_banner.png', // 21:9 å¤´å›¾
    // === [æ–°å¢] å¿…é¡»è¡¥ä¸Šè¿™ä¸ªè·¯å¾„ ===
    combatHeader: 'images/overview/combat_header.png',
    // === [æ–°å¢] å¯¼æ¸¸ç« èŠ‚æ•°æ® ===
// åœ¨ OverviewAssets å¯¹è±¡å†…æ·»åŠ 
// å¯¼æ¸¸å­—å…¸ //
guide: {
    rows: [
        {
            // ç¬¬ä¸€è¡Œ
            main: { img: 'images/guide/main1.png', title: 'ç« èŠ‚æ ‡é¢˜1', desc: 'æè¿°æ–‡å­—1' },
            left:  { bottom: 'images/guide/L1_back.png', top: 'images/guide/L1_front.png' },
            right: { bottom: 'images/guide/R1_back.png', top: 'images/guide/R1_front.png' }
        },
        {
            // ç¬¬äºŒè¡Œ
            main: { img: 'images/guide/main2.png', title: 'ç« èŠ‚æ ‡é¢˜2', desc: 'æè¿°æ–‡å­—2' },
            left:  { bottom: 'images/guide/L2_back.png', top: 'images/guide/L2_front.png' },
            right: { bottom: 'images/guide/R2_back.png', top: 'images/guide/R2_front.png' }
        }
    ],
    comparison: {
        // ç¬¬ä¸‰è¡Œå¯¹æ¯”
        left:  { bottom: 'images/guide/L3_back.png', top: 'images/guide/L3_front.png' },
        right: { bottom: 'images/guide/R3_back.png', top: 'images/guide/R3_front.png' },
        showOffL: 'images/guide/star.png', 
        showOffR: 'images/guide/crown.png'
    },
    finalImg: 'images/guide/final.png'
},
    
    // æˆ˜æ–—ç« èŠ‚ï¼š16è¡Œï¼ˆç¤ºä¾‹æä¾›4ç»„å¾ªç¯é€»è¾‘ï¼‰
    // === [æ–°å¢] æˆ˜æ–—å¼•å¯¼æ¨¡å—æ•°æ® ===
    combatIntro: [
        { img: 'images/overview/intro1.png', text: 'ç‰©ç†æ”»å‡»' },
        { img: 'images/overview/intro2.png', text: 'æ³•æœ¯æ”»å‡»' },
        { img: 'images/overview/intro3.png', text: 'é‡Šæ”¾æŠ€èƒ½å¡ç‰Œ' }
    ],
    battle: [
        { img: 'images/overview/b2_combat.png', info: 'images/overview/b2_desc.png', side: 'right' },
        { img: 'images/overview/b3_combat.png', info: 'images/overview/b3_desc.png', side: 'left' },
        { img: 'images/overview/b14_combat.png', info: 'images/overview/b14_desc.png', side: 'right' },
        { img: 'images/overview/b5_combat.png', info: 'images/overview/b5_desc.png', side: 'left' },
        { img: 'images/overview/b16_combat.png', info: 'images/overview/b16_desc.png', side: 'right' },
        { img: 'images/overview/b7_combat.png', info: 'images/overview/b7_desc.png', side: 'left' },
        { img: 'images/overview/b8_combat.png', info: 'images/overview/b8_desc.png', side: 'right' },
        { img: 'images/overview/b9_combat.png', info: 'images/overview/b9_desc.png', side: 'left' },
        { img: 'images/overview/b10_combat.png', info: 'images/overview/b10_desc.png', side: 'right' },
        { img: 'images/overview/b11_combat.png', info: 'images/overview/b11_desc.png', side: 'left' },
        { img: 'images/overview/b15_combat.png', info: 'images/overview/b15_desc.png', side: 'right' },
        { img: 'images/overview/b4_combat.png', info: 'images/overview/b4_desc.png', side: 'left' },
        { img: 'images/overview/b12_combat.png', info: 'images/overview/b12_desc.png', side: 'right' },
        { img: 'images/overview/b13_combat.png', info: 'images/overview/b13_desc.png', side: 'left' },
        // ... ä½ å¯ä»¥æ ¹æ®è¿™ä¸ªæ ¼å¼å†™æ»¡16è¡Œ
    ],

    // è£…å¤‡ç« èŠ‚ï¼š4è¡Œç‰¹å®šæ’ç‰ˆ
    equip: [
        { type: 'row-img-left', img: 'images/overview/e1.png', title: 'è£…å¤‡ç³»ç»Ÿ', 
        desc: 'åˆ©ç”¨æ”¶é›†ç‰©å“æ¥å¢å¼ºè‡ªèº«æ•°å€¼ï¼Œæˆ˜æ–—ä¸­ä¸å¯æ›´æ”¹ï¼Œ<br>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…¶å¸ƒç½®åªæœ‰ç©å®¶è‡ªå·±å¯ä»¥çœ‹åˆ°çš„ï¼Œæˆ˜æ–—æ—¶ä¹Ÿéœ€è¦çŒœæµ‹æ•Œäººçš„å¸ƒç½®ï¼Œå¹¶åšç›¸åº”è°ƒæ•´' },
        { type: 'row-img-right', img: 'images/overview/e2.png', title: 'å—ç›˜', 
        desc: 'å†³å®šç©å®¶æ”»å‡»å±æ€§å’Œè‡ªèº«å„é¡¹æ•°å€¼<br>è¿™äº›æ•°å€¼å‡å–å†³äºç©å®¶å¦‚ä½•æ”¾ç½®ã€æ”¾ç½®å¤šå°‘[å±æ€§å—]ï¼Œåœ¨è‡ªå·±çš„[å—ç›˜]<br>å…·ä½“çš„æ”¾ç½®æœºåˆ¶ï¼Œæœ‰æ˜ç¡®å…¬å¼è®¡ç®—ï¼Œä½†å¿…é¡»åœ¨æ¸¸ç©ä¸­è‡ªè¡Œå®éªŒæˆ–è€…æƒ³åŠæ³•å·çœ‹åˆ«äººçš„å¸ƒç½®' },
        { type: 'row-img-right', img: 'images/overview/e3.png', title: 'å¡ç›˜', 
        desc: '[äººç‰©å¡]å†³å®šç©å®¶å„é¡¹æ•°å€¼çš„ä¸Šé™<br>[æŠ€èƒ½å¡]å†³å®šæˆ˜æ–—ä¸­å¯ä»¥é‡Šæ”¾çš„æŠ€èƒ½<br>[ç‰©å“å¡]å†³å®šæˆ˜æ–—ä¸­å„å±æ€§çš„åŠ æˆä»¥åŠå¯ä»¥ä½¿ç”¨çš„é“å…·<br>éƒ¨åˆ†å¡ç‰Œå¯ä»¥è£…å¤‡ä¸å¦ï¼Œå–å†³äº[å—ç›˜]ä¸­æ”¾ç½®çš„[å±æ€§å—æ•°é‡]' },
        { type: 'row-full', img: 'images/overview/e4_diff.png', title: 'æ€§èƒ½å·®å¼‚å¯¹æ¯”', desc: '' }
    ],

    // å…¬æ­£ç« èŠ‚ï¼š6è¡Œï¼Œæ¯è¡Œ2ä¸ªï¼Œ4:3å›¾ç‰‡
    justice: [
        { imgL: 'images/overview/j1_l.png', textL1: 'è§„åˆ™A-1', textL2: 'åæœA-1', imgR: 'images/overview/j1_r.png', textR1: 'è§„åˆ™B-1', textR2: 'åæœB-1' },
        { imgL: 'images/overview/j2_l.png', textL1: 'è§„åˆ™A-2', textL2: 'åæœA-2', imgR: 'images/overview/j2_r.png', textR1: 'è§„åˆ™B-2', textR2: 'åæœB-2' },
        // ... å†™æ»¡6è¡Œ
    ]
};



    // è§’è‰²ä¿¡æ¯
    const charData = {
        'seat_empty_01': { 
            name: '[è½®ç©º]', 
            isVacant: true,     // <--- åŠ ä¸Šè¿™ä¸€å¥ï¼Œå¼€å¯æç®€æ ·å¼ï¼
            clickable: false, // <--- ã€å…³é”®ã€‘åŠ ä¸Šè¿™å¥ï¼Œå°±å˜æˆâ€œåªå¯è¿œè§‚ä¸å¯äºµç©â€äº†
            color: '#FF1493',   // æ–‡å­—çš„é¢œè‰²
            chairs:['rose'],
            // ä¸‹é¢è¿™äº›å±æ€§å¯ä»¥ä¸å¡«ï¼Œæˆ–è€…ç•™ç©º
            nickname: '', real: '', gender: '', age: '', 
            school: '', join: '', society: '', job: '', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0 },
        'etc': { 
            name: '... ...', 
            isVacant: true,     // <--- åŠ ä¸Šè¿™ä¸€å¥ï¼Œå¼€å¯æç®€æ ·å¼ï¼
            clickable: false, // <--- ã€å…³é”®ã€‘åŠ ä¸Šè¿™å¥ï¼Œå°±å˜æˆâ€œåªå¯è¿œè§‚ä¸å¯äºµç©â€äº†
            color: '#ccc',   // æ–‡å­—çš„é¢œè‰²
            // ä¸‹é¢è¿™äº›å±æ€§å¯ä»¥ä¸å¡«ï¼Œæˆ–è€…ç•™ç©º
            nickname: '', real: '', gender: '', age: '', 
            school: '', join: '', society: '', job: '', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0 },
        'secretm': { 
            name: 'ç§˜å¯†æˆå‘˜', 
            isVacant: true,     // <--- åŠ ä¸Šè¿™ä¸€å¥ï¼Œå¼€å¯æç®€æ ·å¼ï¼
            clickable: false, // <--- ã€å…³é”®ã€‘åŠ ä¸Šè¿™å¥ï¼Œå°±å˜æˆâ€œåªå¯è¿œè§‚ä¸å¯äºµç©â€äº†
            color: '#ccc',   // æ–‡å­—çš„é¢œè‰²
            // ä¸‹é¢è¿™äº›å±æ€§å¯ä»¥ä¸å¡«ï¼Œæˆ–è€…ç•™ç©º
            nickname: '', real: '', gender: '', age: '', 
            school: '', join: '', society: '', job: '', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0 },
        'yumu': { name:'äºæ²å·', nickname:'äºæ²å·', real:'-', gender:'å¥³', age:'17', 
            school:'è¥¿æ¹¾åŒºå®éªŒä¸­å­¦', join:'S0 (AA2008)', society:'å‹è°Šç™¾è´§', job:'å¬å”¤å¸ˆ', color:'#87CEEB', 
            hp:50, patk:50, pdef:50, matk:50, mdef:50, isKing: true, chairs:['yellow'], isChairForbidden: true,
            cardImage: CardImages.YUMU, 
            portrait: 'images/charData/portraits/art_yumu.png', 
            battleArt: BattleArts.YUMU, 
            schoolLogo: Schools.XIWAN, societyLogo: Societies.FRIEND, 
            attr1: Attrs.LIGHT, attr2: '', 
            bio: '<p>è¿™æ˜¯æˆ‘å‘€~</p>æˆ‘åœ¨å‹è°Šç™¾è´§è´Ÿè´£æŠ½å¡å’Œå–å¡</p>å¯èƒ½æ—¶å¸¸åœ¨åº—é‡Œçœ‹ä¸åˆ°æˆ‘ï¼Œå› ä¸ºæˆ‘ä½å¾—å¾ˆè¿œ' },
        'zhou': { name:'å‘¨å‘¨', nickname:'å‘¨å‘¨', real:'-', gender:'å¥³', age:'17', 
            school:'æ±Ÿå£é“é“ç¬¬ä¸‰ä¸­å­¦', join:'S2 (AA2010)', society:'å‹è°Šç™¾è´§', job:'ç‰§å¸ˆ', color:'#FFC0CB', 
            hp:200, patk:200, pdef:200, matk:200, mdef:200, 
            cardImage: CardImages.ZHOU, 
            portrait: 'images/charData/portraits/art_zhou.png', 
            battleArt: BattleArts.ZHOU, 
            schoolLogo: Schools.JIANGKOU, societyLogo: Societies.FRIEND, 
            attr1: Attrs.LIGHT, attr2: '', 
            bio: '<p>åœ¨å‹è°Šç™¾è´§è´Ÿè´£ä½“åŠ›å›å¤</p>é•¿å¾—è¶…çº§æ¼‚äº®ï¼Œå¥¹çœ‹èµ·æ¥æ€»æ˜¯åœ¨å¾®ç¬‘ï¼Œä½†å…¶å®æ˜¯å˜´å”‡çš„å½¢çŠ¶å¾ˆç‰¹åˆ«' },
        'cotton': { name:'æ£‰å‘', nickname:'æ£‰å‘', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬å››å±Š', society:'å‹è°Šç™¾è´§', job:'å¨å¸ˆ', color:'#4169E1', 
            hp:100, patk:200, pdef:150, matk:100, mdef:100, 
            cardImage: CardImages.COTTON, 
            portrait: 'images/charData/portraits/art_cotton.png', 
            battleArt: BattleArts.COTTON, 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.MOON, attr2: Attrs.LIGHT, 
            bio: '<p>åœ¨å‹è°Šç™¾è´§è´Ÿè´£é›¶é£Ÿ</p>æœ‰ç‚¹å‘†å¤´å‘†è„‘ï¼Œå¸¸å¸¸ç®—ä¸å¯¹é€é¤çš„äººæ•°ï¼Œæ¯å¤©éƒ½ä¼šè¶…é¢å‡†å¤‡ï¼Œæ¯å¤©ä¹Ÿéƒ½ä¼šå·åƒ' },
        'song': { name:'æ¾æ¾', nickname:'æ¾æ¾', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S1 ç¬¬äºŒå±Š', society:'å‹è°Šç™¾è´§', job:'å•†äºº', color:'#FFA500', 
            hp:100, patk:100, pdef:100, matk:200, mdef:150, 
            cardImage: CardImages.SONG, 
            portrait: 'images/charData/portraits/art_song.png', 
            battleArt: BattleArts.SONG, 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.SUN, attr2: Attrs.LIGHT, 
            bio: '<p>åœ¨å‹è°Šç™¾è´§è´Ÿè´£å¨±ä¹</p>åŸæœ¬ä¼šç»™å­¦ç”Ÿé€æ¼«ç”»ã€ç”µå½±ï¼Œåæ¥å–æ¶ˆäº†è¿™ä¸ªä¸šåŠ¡ï¼Œå¤§å¤šæ—¶å€™è´Ÿè´£å¤œç­<br>ç™½å¤©å–œæ¬¢ç¡å¤§è§‰ï¼Œå¯æ€»è¢«æˆ‘æŠ“æ¥æ›¿ç­' },
        'buzhi': { clickable: false,
            name:'å¸ƒç»‡é¸£', nickname:'å¸ƒç»‡é¸£', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'è£ç¼',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'stone': { name:'ä¸»å¸­', nickname:'ä¸»å¸­', real:'è¢å›é˜³', gender:'ç”·', age:'17', 
            school:'æ±Ÿå£é“é“ç¬¬ä¸‰ä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'ç›¾å«', color:'#FFD700', 
            hp:155, patk:110, pdef:125, matk:55, mdef:110, isKing: true, chairs:['yellow'], 
            cardImage: CardImages.STONE, 
            portrait: 'images/charData/portraits/art_stone.png', 
            battleArt: BattleArts.STONE, 
            schoolLogo: Schools.JIANGKOU, societyLogo: Societies.TOWER, 
            attr1: Attrs.EARTH, attr2: Attrs.FIRE, 
            bio: '<p>å†·å‡å¡”çš„åˆ›ç«‹äºº é¦–å¸­</p>è´Ÿè´£ä¿å«å¡”å†…ä¸æ„¿æˆ˜æ–—çš„å­¦ç”Ÿä»¬ï¼Œ<br>åšäº‹è¿‡åˆ†è®¤çœŸè´Ÿè´£ï¼Œè®²è¯å£°éŸ³ä¹Ÿå¾ˆå¤§...' },
        'master': { name:'å°å¸ˆå‚…', nickname:'å°å¸ˆå‚…', real:'æ±Ÿæ¡‚', gender:'å¥³', age:'17', 
            school:'æ±Ÿå£é“é“ç¬¬ä¸‰ä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'é“åŒ ', color:'#9370DB', 
            hp:75, patk:125, pdef:80, matk:60, mdef:100, 
            cardImage: CardImages.MASTER, 
            portrait: 'images/charData/portraits/art_master.png', 
            battleArt: BattleArts.MASTER, 
            schoolLogo: Schools.JIANGKOU, societyLogo: Societies.TOWER, 
            attr1: Attrs.FIRE, attr2: '', 
            bio: '<p>å†·å‡å¡”çš„ä¿®ç†å·¥  æˆ˜æ–—å‘˜</p>è®²è¯å•°å•°å—¦å—¦ï¼Œä½†å¾ˆä¼šç…§é¡¾äººï¼Œæ€»æŠŠè‡ªå·±æå¾—å¾ˆç´¯' },
        'lilmaster': { clickable: false,
            name:'å°å°å¸ˆå‚…', nickname:'å°å°å¸ˆå‚…', real:'æ±Ÿæ¹˜', gender:'å¥³', age:'17', 
            school:'æ±Ÿå£é“é“ç¬¬ä¸‰ä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'å‰‘å£«', color:'#999', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOBODY, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.JIANGKOU, societyLogo: Societies.TOWER, 
            attr1: Attrs.FIRE, attr2: '', 
            bio: '' },
        'coco': { name:'å¯å¯', nickname:'å¯å¯', real:'å¾å¯', gender:'å¥³', age:'17', 
            school:'è¥¿æ¹¾åŒºå®éªŒä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'æ ¼æ–—å®¶', color:'#FF4500', 
            hp:70, patk:130, pdef:115, matk:85, mdef:95, 
            cardImage: CardImages.COCO, 
            portrait: 'images/charData/portraits/art_coco.png', 
            battleArt: BattleArts.COCO, 
            schoolLogo: Schools.XIWAN, societyLogo: Societies.TOWER, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '<p>å†·å‡å¡”çš„æˆ˜æ–—å‘˜</p>è¿åŠ¨æ˜¯å¥¹çš„é•¿é¡¹ï¼Œé«˜ä¸‰ä¹‹å‰ä¸€ç›´æ˜¯è¶³çƒé˜Ÿçš„' },
        'bai': { clickable: false,
            name:'å°ç™½', nickname:'å°ç™½', real:'', gender:'ç”·', age:'18', 
            school:'è¥¿æ¹¾åŒºå®éªŒä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'æ¸¸ä¾ ', color:'#999', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOBODY, 
            portrait: 'images/charData/portraits/art_coco.png', 
            battleArt: '', 
            schoolLogo: Schools.XIWAN, societyLogo: Societies.TOWER, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '' },
        'xiaobei': { name:'å°åŒ—', nickname:'å°åŒ—', real:'æå°æ–', gender:'å¥³', age:'18', 
            school:'å¹³ä»™å¸‚æ„šæ¡¥ä¸­å­¦', join:'S1 (AA2009)', society:'å†·å‡å¡”', job:'åˆºå®¢', color:'#40E0D0', 
            hp:100, patk:165, pdef:130, matk:65, mdef:110, isKing: false,  
            cardImage: CardImages.XIAOBEI, 
            portrait: 'images/charData/portraits/art_xiaobei.png', 
            battleArt: BattleArts.XIAOBEI, 
            schoolLogo: Schools.PINGXIAN, societyLogo: Societies.TOWER, 
            attr1: Attrs.ICE, attr2: Attrs.MOON, 
            bio: '<p>å†·å‡å¡”çš„æˆ˜æ–—å‘˜</p>å¹³æ—¶ç•™å®ˆé˜µåœ°ï¼Œä¹Ÿè´Ÿè´£ç®¡ç†èŠ±å›­ï¼Œè™½ç„¶ä¸æ€ä¹ˆçˆ±è¯´è¯ï¼Œåšäº‹å€’æ˜¯è›®æ‹¼çš„' },
        'hei': { name:'é»‘çˆ·', nickname:'é»‘çˆ·', real:'å½­ç¨‹', gender:'ç”·', age:'18', 
            school:'æ—å·å¸ˆèŒƒå¤§å­¦é™„å±é«˜çº§ä¸­å­¦', join:'S0 (AA2008)', society:'ä¸è‰¯å°‘å¹´å®«', job:'ç‹‚æˆ˜å£«', color:'#8A2BE2', 
            hp:65, patk:125, pdef:60, matk:165, mdef:60, isKing: false, chairs: [ 'cyan'], 
            cardImage: CardImages.HEI, 
            portrait: 'images/charData/portraits/art_hei.png', 
            battleArt: BattleArts.HEI, 
            schoolLogo: Schools.LINZHOU, societyLogo: Societies.BAD, 
            attr1: Attrs.MOON, attr2: Attrs.DUST, 
            bio: '<p>ä¸è‰¯å°‘å¹´å®«çš„åˆ›ç«‹äºº ç¬¬ä¸€ä»»é¦–å¸­</p>ç°åœ¨é€€ä¸‹æ¥ä¸åšé¦–å¸­äº†ï¼Œåšäº‹æ‹–æ‹–æ‹‰æ‹‰ï¼Œå¬‰çš®ç¬‘è„¸å¾ˆçƒ¦äºº' },
        'bald': { clickable: false,
            name:'å…‰å¤´', nickname:'å…‰å¤´', real:'æå¿ æµ·', gender:'ç”·', age:'17', 
            school:'æ—å·å¸ˆèŒƒå¤§å­¦é™„å±é«˜çº§ä¸­å­¦', join:'S0 (AA2008)', society:'ä¸è‰¯å°‘å¹´å®«', job:'è‹¦è¡Œåƒ§', color:'#999', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOBODY, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.LINZHOU, societyLogo: Societies.BAD, 
            attr1: Attrs.MOON, attr2: Attrs.DUST, 
            bio: '' },
        'ban': { name:'ç­é•¿', nickname:'ç­é•¿', real:'é˜®èŠ³é›¨', gender:'å¥³', age:'17', 
            school:'é‡‘è°·å¸‚é’æ¾ä¸­å­¦', join:'S2 (AA2010)', society:'ä¸è‰¯å°‘å¹´å®«', job:'çŒäºº', color:'#32CD32', 
            hp:88, patk:140, pdef:170, matk:75, mdef:115, isKing: true, chairs: [ 'green'],
            cardImage: CardImages.BAN, 
            portrait: 'images/charData/portraits/art_ban.png', 
            battleArt: BattleArts.BAN, 
            schoolLogo: Schools.JINGU, societyLogo: Societies.BAD, 
            attr1: Attrs.WOOD, attr2: Attrs.CRYSTAL, 
            bio: '<p>ä¸è‰¯å°‘å¹´å®« ç¬¬ä¸‰ä»»é¦–å¸­</p>æ€»çš„æ¥è¯´æ˜¯ä¸ªè›®å–„è‰¯çš„äººï¼Œæœ‰æ—¶å€™æä¸å¤ªæ‡‚å¥¹åœ¨æƒ³ä»€ä¹ˆï¼Œæœ‰ç‚¹çˆ±å¥‰çŒ®' },
        'hong': { name:'å°çº¢', nickname:'å°çº¢', real:'å¼ ç¬‘', gender:'å¥³', age:'18', 
            school:'ä¸­å»–å¤–å›½è¯­å­¦æ ¡', join:'S2 (AA2010)', society:'ä¸è‰¯å°‘å¹´å®«', job:'ç‹‚æˆ˜å£«', color:'#FF0000', 
            hp:105, patk:140, pdef:55, matk:30, mdef:55, 
            cardImage: CardImages.HONG, 
            portrait: 'images/charData/portraits/art_hong.png', 
            battleArt: BattleArts.HONG, 
            schoolLogo: Schools.ZHONGLIAO, societyLogo: Societies.BAD, 
            attr1: Attrs.SUN, attr2: Attrs.CRYSTAL, 
            bio: '<p>ä¸è‰¯å°‘å¹´å®«çš„æˆ˜æ–—å‘˜</p>æ€§æ ¼å¼€æœ—åˆçƒ­å¿ƒï¼Œæ˜æ˜å¾ˆç˜¦ï¼Œé¥­é‡å´å¤§å¾—æƒŠäººï¼Œå¯æƒœæ˜¯ä¸ªæ­»å¿ƒçœ¼' },
        'jiao': { clickable: false,
            name:'å¨‡å¨‡', nickname:'å¨‡å¨‡', real:'', gender:'ç”·', age:'18', 
            school:'æºªåŒ—å¤§å­¦é™„å±ä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'ç«æªæ‰‹', color:'#999', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOBODY, 
            portrait: 'images/charData/portraits/art_coco.png', 
            battleArt: '', 
            schoolLogo: Schools.XIWAN, societyLogo: Societies.TOWER, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '' },
        'piao': { name:'é£˜é£˜', nickname:'é£˜é£˜', real:'æè²', gender:'ç”·', age:'18', 
            school:'æ—å·å¸ˆèŒƒå¤§å­¦é™„å±é«˜çº§ä¸­å­¦', join:'S0 (AA2008)', society:'ç‚¼å‚', job:'åˆºå®¢', color:'#DC143C', 
            hp:80, patk:135, pdef:130, matk:90, mdef:90, isKing: false, chairs: [ 'green'],  isChairForbidden: true,
            cardImage: CardImages.PIAO, 
            portrait: 'images/charData/portraits/art_piao.png', 
            battleArt: BattleArts.PIAO, 
            schoolLogo: Schools.LINZHOU, societyLogo: Societies.FACTORY, 
            attr1: Attrs.SUN, attr2: Attrs.EARTH, 
            bio: '<p>ç‚¼å‚çš„åˆ›ç«‹äºº ç¬¬ä¸€ä»»é¦–å¸­</p><br>å‚»é€¼' },
        'hua': { name:'å°èŠ±', nickname:'å°èŠ±', real:'åˆ˜æ™“å¤', gender:'ç”·', age:'17', 
            school:'é‡‘è°·å¸‚é’æ¾ä¸­å­¦', join:'S2 (AA2010)', society:'ç‚¼å‚', job:'ç›—è´¼', color:'#FF8C00', 
            hp:50, patk:75, pdef:75, matk:65, mdef:65, 
            cardImage: CardImages.HUA, 
            portrait: 'images/charData/portraits/art_hua.png', 
            battleArt: BattleArts.HUA, 
            schoolLogo: Schools.JINGU, societyLogo: Societies.FACTORY, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '<p>ç‚¼å‚çš„æˆ˜æ–—å‘˜</p>è‡ªæ¥ç†Ÿï¼Œåšè„¸çš®ï¼Œä¸çŸ¥é“ä»–åƒä»€ä¹ˆé•¿å¤§çš„ï¼Œæ„Ÿè§‰è€å¸ˆå’Œæ ¡éœ¸éƒ½æ‹¿ä»–æ²¡åŠæ³•' },
        'wildcat': { name:'å°é‡çŒ«', nickname:'å°é‡çŒ«', real:'å°¹è‹—è‹—', gender:'å¥³', age:'18', 
            school:'å¹³ä»™å¸‚æ„šæ¡¥ä¸­å­¦', join:'S1 (AA2009)', society:'ç‚¼å‚', job:'å‰ªåˆ€æ‰‹', color: 'linear-gradient(to right, #FFD700, #0000FF)', 
            hp:150, patk:160, pdef:100, matk:100, mdef:100, isKing: false, 
            cardImage: CardImages.CAT, 
            portrait: 'images/charData/portraits/art_cat.png', 
            battleArt: BattleArts.CAT, 
            schoolLogo: Schools.PINGXIAN, societyLogo: Societies.FACTORY, 
            attr1: Attrs.CRYSTAL, attr2: Attrs.WIND, 
            bio: '<p>ç‚¼å‚ ç¬¬äºŒä»»é¦–å¸­</p>é‚‹é¢ï¼Œåšäº‹å¾ˆé©¬è™ï¼Œè¿˜å¾ˆæ‡’ï¼Œè®²è¯å¤ªç›´æ¥ï¼Œæ‰“æ¶å€’æ˜¯å¾ˆæ‹¿æ‰‹' },
        'dou': { name:'è±†å­', nickname:'è±†å­', real:'æœå©‰æœˆ', gender:'å¥³', age:'17', 
            school:'èŠ±æ¸¯å¸‚ç¬¬åä¸€ä¸­å­¦', join:'S2 (AA2010)', society:'ç‚¼å‚', job:'æ ¼æ–—å®¶', color:'#1E90FF', 
            hp:100, patk:165, pdef:150, matk:50, mdef:180, isKing: true,  
            cardImage: CardImages.DOU, 
            portrait: 'images/charData/portraits/art_dou.png', 
            battleArt: BattleArts.DOU, 
            schoolLogo: Schools.HUAGANG, societyLogo: Societies.FACTORY, 
            attr1: Attrs.WIND, attr2: Attrs.ICE, 
            bio: '<p>ç‚¼å‚ ç¬¬äºŒä»»é¦–å¸­</p>å°ä¸ªå­ï¼Œç¬¬ä¸€å°è±¡å¾ˆå†·æ¼ ï¼Œä¸è¿‡æ˜¯ä¸ªè€å®å­©å­ï¼Œä¸ªæ€§è›®åšæ¯…çš„' },
        'niuj': { clickable: false,
            name:'ç‰›å§', nickname:'ç‰›å§', real:'', gender:'ç”·', age:'18', 
            school:'èŠ±æ¸¯å¸‚ç¬¬åä¸€ä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'é›‡ä½£å…µ', color:'#999', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOBODY, 
            portrait: 'images/charData/portraits/art_coco.png', 
            battleArt: '', 
            schoolLogo: Schools.XIWAN, societyLogo: Societies.TOWER, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '' },
        'gua': { clickable: false,
            name:'ç“œä»”', nickname:'ç“œä»”', real:'', gender:'ç”·', age:'18', 
            school:'å¹³ä»™å¸‚æ„šæ¡¥ä¸­å­¦', join:'S2 (AA2010)', society:'å†·å‡å¡”', job:'é‡åŠ›æ³•å¸ˆ', color:'#999', 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOBODY, 
            portrait: 'images/charData/portraits/art_coco.png', 
            battleArt: '', 
            schoolLogo: Schools.XIWAN, societyLogo: Societies.TOWER, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '' },
        'sb': { name:'è‰è“', nickname:'è‰è“', real:'-', gender:'å¥³', age:'18', 
            school:'å†²æ±Ÿå¸‚ç¬¬äº”ä¸­å­¦', join:'S3 (AA2011)', society:'èœ‚å±±å¹¿åœº', job:'å‰ªåˆ€æ‰‹', color:'linear-gradient(to right, #00FF7F, #FF0055)', 
            hp:40, patk:60, pdef:40, matk:60, mdef:40, 
            cardImage: CardImages.SB, 
            portrait: 'images/charData/portraits/art_sb.png', 
            battleArt: BattleArts.SB, 
            schoolLogo: Schools.CHONGJIANG, societyLogo: Societies.PLAZA, 
            attr1: '', attr2: '', 
            bio: '<p>å°±æ˜¯ä½ å•Š</p>' },
        'nao': { name:'é—¹é—¹', nickname:'é—¹é—¹', real:'é¡¾å­æ¬£(18)', gender:'å¥³', age:'17', 
            school:'å†²æ±Ÿå¸‚ç¬¬äº”ä¸­å­¦', join:'S3 (AA2011)', society:'èœ‚å±±å¹¿åœº', job:'å‰‘å£«', color:'#FFA500', 
            hp:65, patk:80, pdef:45, matk:80, mdef:55, 
            cardImage: CardImages.NAO, 
            portrait: 'images/charData/portraits/art_nao.png', 
            battleArt: BattleArts.NAO, 
            schoolLogo: Schools.CHONGJIANG, societyLogo: Societies.PLAZA, 
            attr1: Attrs.WOOD, attr2: '', 
            bio: '<p>æ˜¯ä½ çš„å¥½æœ‹å‹å‘€</p>æ— æ‹˜æ— æŸï¼Œå–œæ¬¢æŠ˜è…¾ï¼Œåµåµåš·åš·ï¼Œå¼€æœ—çš„éƒ½æœ‰ç‚¹å¼‚å¸¸äº†ï¼Œæ€»èƒ½ä»åŒ…é‡Œâ€œå˜â€å‡ºå°é›¶é£Ÿ' },
        'kid': { name:'å°å­©', nickname:'å°å­©', real:'é¡¾å­æ¬£(15)', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 (AA2008)', society:'å“ˆå°¼å“ˆå°¼', job:'å¤§é­”æ³•å¸ˆ', color:'#FF1493', 
            hp:110, patk:175, pdef:80, matk:200, mdef:140, isKing: true, chairs: [ 'rose'], isChairForbidden: true,
            cardImage: CardImages.KID, 
            portrait: 'images/charData/portraits/art_kid.png', 
            battleArt: BattleArts.KID, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.STAR, attr2: Attrs.CRYSTAL, 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„åˆ›ç«‹äºº é¦–å¸­</p>å¥¹æ€»æœ‰æ–°å¥‡çš„ç‚¹å­ï¼Œå’Œå¥¹åœ¨ä¸€èµ·ä»ä¸ä¼šæ— èŠï¼Œæ˜¯ä¸ªå¿«ä¹çš„å°ç–¯å­' },
        'xhani': { name:'å“ˆå°¼', nickname:'å“ˆå°¼', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'æœªææ‹”', society:'å“ˆå°¼å“ˆå°¼', job:'æ¸¸ä¾ ', color:'#FFFF00', 
            hp:80, patk:80, pdef:80, matk:80, mdef:80,  
            cardImage: CardImages.XHANI, 
            portrait: 'images/charData/portraits/art_xhani.png', 
            battleArt: BattleArts.XHANI, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.STAR, attr2: '', 
            bio: '<p>æ²¡æœ‰åå­—çš„æ™®é€šå“ˆå°¼</p>æ–‘ä¸˜é‡Œå¤šåˆ°æ•°ä¸è¿‡æ¥ï¼Œåˆå¼±åˆåš£å¼ ï¼Œæˆå¤©å½å½å–³å–³ï¼Œä¸Šè¹¿ä¸‹è·³ï¼Œä¸çŸ¥é“ç´¯ä¸€æ ·' },
        'nurse': { name:'æ¯æ¯å¤´', nickname:'æ¯æ¯å¤´', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬äº”å±Š', society:'å“ˆå°¼å“ˆå°¼', job:'å‰‘å£«', color:'#4AB5FF',  
            hp:70, patk:190, pdef:40, matk:30, mdef:50,  
            cardImage: CardImages.NURSE, 
            portrait: 'images/charData/portraits/art_nurse.png', 
            battleArt: BattleArts.NURSE, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.WATER, attr2: '', 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„æˆ˜æ–—å‘˜</p>èƒ†å°æ€•äº‹ï¼Œç»å‰é¡¾åï¼Œæ— è®ºå¤šä¹ˆå°å¿ƒï¼Œå¥¹æ€»èƒ½æŠŠäº‹æƒ…æç ¸' },
        'dream': { name:'æ¢¦çµçµ', nickname:'æ¢¦çµçµ', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬äº”å±Š', society:'å“ˆå°¼å“ˆå°¼', job:'ç«é­”æ³•å¸ˆ', color:'#FF69B4', 
            hp:110, patk:50, pdef:60, matk:130, mdef:150, 
            cardImage: CardImages.DREAM, 
            portrait: 'images/charData/portraits/art_dream.png', 
            battleArt: BattleArts.DREAM, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.FIRE, attr2: Attrs.EARTH, 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„æˆ˜æ–—å‘˜</p>ä¸€å¤©åˆ°æ™šè¿·è¿·ç³Šç³Šçš„ï¼Œåšäº‹æ…¢åŠæ‹è‡ªå·±ä¹Ÿä¸åœ¨æ„ï¼Œåªè¦ä¸æ‰“æ‰°å¥¹ç¡è§‰ï¼Œå…¶ä»–äº‹æƒ…éƒ½ä¸ä¼šè®©å¥¹ç”Ÿæ°”' },
        'candy': { name:'æ™•æ™•ç³–', nickname:'æ™•æ™•ç³–', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S1 ç¬¬ä¸‰å±Š', society:'å“ˆå°¼å“ˆå°¼', job:'åŒåˆ€å®¢', color:'#DC143C', 
            hp:200, patk:220, pdef:100, matk:20, mdef:20, 
            cardImage: CardImages.CANDY, 
            portrait: 'images/charData/portraits/art_candy.png', 
            battleArt: BattleArts.CANDY, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.CRYSTAL, attr2: '', 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„å‰‘æœ¯æŒ‡å¯¼ ç”œç‚¹å¸ˆ</p>å¾ˆæˆç†Ÿï¼Œä¸æ€ä¹ˆå–œæ¬¢åˆ°å®¤å¤–å»ï¼Œæ•™å¯¼å‰‘æœ¯æ—¶ç‰¹åˆ«ä¸¥æ ¼ï¼Œå¾ˆçˆ±ç»™è‡ªå·±æ”¾å‡' },
        'king': { name:'èƒ½å¤§ç‹', nickname:'èƒ½å¤§ç‹', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S1 ç¬¬äºŒå±Š', society:'å“ˆå°¼å“ˆå°¼', job:'éŸ³æ³¢æ³•å¸ˆ', color:'#C0C0C0', 
            hp:200, patk:20, pdef:20, matk:220, mdef:100, 
            cardImage: CardImages.KING, 
            portrait: 'images/charData/portraits/art_king.png', 
            battleArt: BattleArts.KING, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.WAVE, attr2: Attrs.CRYSTAL, 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„æ³•æœ¯æŒ‡å¯¼ å¤±è¸ª</p>ä»é‚£ä»¥åå¥¹å¥½åƒå°±ç–¯äº†ï¼Œä¸€ç›´æ‹¿ç€å‡ æ ¹å¤©çº¿åˆ°å¤„æŒ¥èˆï¼Œå˜´é‡Œè¯´çš„ä¹Ÿæ˜¯å¬ä¸æ‡‚çš„è¯­è¨€' },
        'wax': { name:'èœ¡æ²«å­', nickname:'èœ¡æ²«å­', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬å››å±Š', society:'å“ˆå°¼å“ˆå°¼', job:'æ­»çµæ³•å¸ˆ', color:'#FFA500', 
            hp:50, patk:50, pdef:50, matk:150, mdef:150, 
            cardImage: CardImages.WAX, 
            portrait: 'images/charData/portraits/art_wax.png', 
            battleArt: BattleArts.WAX, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.WOOD, attr2: Attrs.DUST, 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„æ³•æœ¯æŒ‡å¯¼ å›­ä¸</p>å¯ä»¥è¯´æ˜¯ç›¸å½“æ­£å¸¸çš„æ€§æ ¼ï¼Œå·¥ä½œä¹Ÿå‹¤å¥‹ï¼Œæ•™äººä¹Ÿæœ‰è€å¿ƒï¼ŒçœŸå¸Œæœ›å¥¹å¹³æ—¶èƒ½å¤šå»æ”¾æ¾ç©ä¸€ç©' },
        'pigeon': { name:'ç™½é¸½æ³¥', nickname:'ç™½é¸½æ³¥', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬äº”å±Š', society:'å“ˆå°¼å“ˆå°¼', job:'é‡é”¤æˆ˜å£«', color:'#32CD32', 
            hp:80, patk:125, pdef:75, matk:45, mdef:95, 
            cardImage: CardImages.PIGEON, 
            portrait: 'images/charData/portraits/art_pigeon.png', 
            battleArt: BattleArts.PIGEON, 
            schoolLogo: Schools.HANI, societyLogo: Societies.HANI, 
            attr1: Attrs.WOOD, attr2: '', 
            bio: '<p>å“ˆå°¼å“ˆå°¼çš„æˆ˜æ–—å‘˜</p>æœ‰äº›å¤ªè®¤çœŸäº†ï¼Œæ„Ÿè§‰å¥¹æ€»æ˜¯é€¼è‡ªå·±è¿›æ­¥ï¼Œå¯¹æœ‹å‹å¾ˆå°½å¿ƒå°½åŠ›ï¼Œå¤§æ¦‚æ˜¯æœ‰ç‚¹æ€•å¯‚å¯' },
        'pika': { name:'çš®çš®å¡', nickname:'çš®çš®å¡', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬å››å±Š', society:'ä¸‰å­æ˜Ÿ', job:'é©¯å…½å¸ˆ', color:'#FFFF00', 
            hp:60, patk:90, pdef:50, matk:150, mdef:130, isKing: true,  
            cardImage: CardImages.PIKA, 
            portrait: 'images/charData/portraits/art_pika.png', 
            battleArt: BattleArts.PIKA, 
            schoolLogo: Schools.HANI, societyLogo: Societies.STARS, 
            attr1: Attrs.THUNDER, attr2: '', 
            bio: '<p>ä¸‰å­æ˜Ÿçš„åˆ›ç«‹äºº ä¸­å¿ƒä½</p>æœ‰æ—¶åœ¨å¿«ä¹å›­å…¼èŒæ•™å¯¼å¬å”¤æœ¯ï¼Œæ˜æ˜å†™æ­Œå¾ˆå¥½å¬ä½†æœ‰ç‚¹å¤ªæ‡’äº†ï¼Œçº¯å‡­å¿ƒæƒ…ï¼Œä¸å¤ªå–œæ¬¢è¢«æŸç¼š' },
        'ding': { name:'éœ²é’‰', nickname:'éœ²é’‰', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬äº”å±Š', society:'ä¸‰å­æ˜Ÿ', job:'éª‘å£«', color:'#00FFFF', 
            hp:100, patk:130, pdef:75, matk:100, mdef:80, 
            cardImage: CardImages.DING, 
            portrait: 'images/charData/portraits/art_ding.png', 
            battleArt: BattleArts.DING, 
            schoolLogo: Schools.HANI, societyLogo: Societies.STARS, 
            attr1: Attrs.ICE, attr2: '', 
            bio: '<p>ä¸‰å­æ˜Ÿçš„æˆå‘˜ å·¦è¾¹ä½</p>åˆšåŠ å…¥çš„æ–°æˆå‘˜ï¼Œæ˜¯ä¸‰å­æ˜Ÿå¤å‡ºçš„å¥‘æœºï¼Œå¥¹æ˜¯æœ€å°‘æœ‰çš„ä¼šåšå­¦ä¹ è®¡åˆ’çš„ç±»å‹ï¼Œç§åº•ä¸‹è¯ä¸å¤šï¼Œæ€»ä¸€ä¸ªäººåŸ‹å¤´åšäº‹' },
        'buta': { name:'å¸ƒæŒç±³', nickname:'å¸ƒæŒç±³', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬å››å±Š', society:'ä¸‰å­æ˜Ÿ', job:'é“åŒ ', color:'#FFB6C1', 
            hp:120, patk:70, pdef:110, matk:80, mdef:125, 
            cardImage: CardImages.BUTA, 
            portrait: 'images/charData/portraits/art_buta.png', 
            battleArt: BattleArts.BUTA, 
            schoolLogo: Schools.HANI, societyLogo: Societies.STARS, 
            attr1: Attrs.WIND, attr2: '', 
            bio: '<p>ä¸‰å­æ˜Ÿçš„æˆå‘˜ å³è¾¹ä½</p>å®Œå…¨çœ‹ä¸å‡ºæ¥å¥¹æ“…é•¿è¯´å”±ï¼Œçˆ±æ“å¿ƒï¼Œæ€»èƒ½å¯Ÿè§‰èº«è¾¹äººçš„çƒ¦æ¼ï¼Œä¼šåœ¨æš—åœ°é‡Œå·å·å¸®åŠ©å¯¹æ–¹' },
        'xdq': { name:'å°å†»é’', nickname:'å°å†»é’', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S2 ç¬¬å››å±Š', society:'æ¯›æ¯›æ¯›æ¯›æ¯›', job:'åˆºå®¢', color:'#FFD700', 
            hp:100, patk:100, pdef:100, matk:100, mdef:130, isKing: true, 
            cardImage: CardImages.XDQ, 
            portrait: 'images/charData/portraits/art_xdq.png', 
            battleArt: BattleArts.XDQ, 
            schoolLogo: Schools.HANI, societyLogo: Societies.MAO, 
            attr1: Attrs.CRYSTAL, attr2: Attrs.THUNDER, 
            bio: '<p>æ¯›æ¯›æ¯›æ¯›æ¯›çš„åˆ›ç«‹äºº ä¸»å”±</p>ä¸‰å­æ˜Ÿçš„å‰æˆå‘˜ï¼Œæœ‰æ®µæ—¶é—´æ€»è¢«äººæ¬ºè´Ÿï¼Œçœ‹ä¼¼å¼ æ‰¬ï¼Œæ€§æ ¼è’å”ï¼Œä¸è¿‡å…¶å®éå¸¸èƒ½åƒè‹¦' },
        'penguin': { name:'æ´½å‡‰', nickname:'æ´½å‡‰', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S1 ç¬¬ä¸‰å±Š', society:'æ¯›æ¯›æ¯›æ¯›æ¯›', job:'å…‰é­”æ³•å¸ˆ', color:'#FF4500', 
            hp:100, patk:100, pdef:100, matk:100, mdef:130, isKing: true, 
            cardImage: CardImages.penguin, 
            portrait: 'images/charData/portraits/art_penguin.png', 
            battleArt: BattleArts.penguin, 
            schoolLogo: Schools.HANI, societyLogo: Societies.MAO, 
            attr1: Attrs.SUN, attr2: Attrs.ICE, 
            bio: '' },
        'pao': { name:'æ³¡ç³Šæ¶‚', nickname:'æ³¡ç³Šæ¶‚', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S1 ç¬¬ä¸‰å±Š', society:'æ¯›æ¯›æ¯›æ¯›æ¯›', job:'èˆè€…', color:'#00FF7F', 
            hp:60, patk:180, pdef:130, matk:60, mdef:44, 
            cardImage: CardImages.PAO, 
            portrait: 'images/charData/portraits/art_pao.png', 
            battleArt: BattleArts.PAO, 
            schoolLogo: Schools.HANI, societyLogo: Societies.MAO, 
            attr1: Attrs.WOOD, attr2: Attrs.WIND, 
            bio: '<p>æ¯›æ¯›æ¯›æ¯›æ¯›çš„ä¸»èˆ</p>è€è¯´äº›åˆ«äººå¬ä¸æ‡‚çš„è¯ï¼Œè¿‡åˆ†è‡ªç”±ï¼Œè™½ç„¶èˆè·³çš„ä¸é”™ï¼Œè„‘å­å´æ˜¯ç¼ºæ ¹å¼¦' },
        'zhe': { name:'æŠ˜å…¬ä¸»', nickname:'æŠ˜å…¬ä¸»', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S1 ç¬¬ä¸‰å±Š', society:'æ¯›æ¯›æ¯›æ¯›æ¯›', job:'å¤§å¬å”¤å¸ˆ', color:'#DA70D6', 
            hp:70, patk:130, pdef:44, matk:130, mdef:44, 
            cardImage: CardImages.ZHE, 
            portrait: 'images/charData/portraits/art_zhe.png', 
            battleArt: BattleArts.ZHE, 
            schoolLogo: Schools.HANI, societyLogo: Societies.MAO, 
            attr1: Attrs.SUN, attr2: Attrs.CRYSTAL, 
            bio: '<p>æ¯›æ¯›æ¯›æ¯›æ¯›çš„DJ</p>å¥¹å¹³æ—¶çˆ±è£…æˆæœºå™¨äººï¼Œå‡ ä¹ä¸è¯´è¯ï¼Œå¶å°”å’Œå£°æ—¶æ‰èƒ½å¬åˆ°å¥¹çš„å£°éŸ³ï¼Œç”œç¾çš„å¾ˆ' },
        'tie': { name:'é“é”’é“›', nickname:'é“é”’é“›', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'æ¯›æ¯›æ¯›æ¯›æ¯›', job:'ç”µç£æ³•å¸ˆ', color:'#1E90FF', 
            hp:100, patk:150, pdef:120, matk:120, mdef:100, 
            cardImage: CardImages.TIE, 
            portrait: 'images/charData/portraits/art_tie.png', 
            battleArt: BattleArts.TIE, 
            schoolLogo: Schools.HANI, societyLogo: Societies.MAO, 
            attr1: Attrs.MOON, attr2: Attrs.CRYSTAL, 
            bio: '<p>æ¯›æ¯›æ¯›æ¯›æ¯›çš„DJ</p>æ›¾ç»å¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½æ˜¯ç‹¬è¡Œï¼Œä¸çŸ¥é“æ€ä¹ˆè¢«è¯´æœå…¥ä¼™çš„ï¼Œå¥¹åªæ˜¯ç©¿ç€æ¯”è¾ƒå¼ æ‰¬ï¼Œæ€§æ ¼å€’ä¸æ˜¯é‚£æ ·' },
        'bu_lian': { name:'æ­¥å¯è¿', nickname:'æ­¥å¯è¿', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'æ¯›æ¯›æ¯›æ¯›æ¯›', job:'å¤§ç¥­å¸', color:'#FFFFFF', 
            hp:125, patk:120, pdef:90, matk:170, mdef:100, isKing: true,  
            cardImage: CardImages.BULIAN, 
            portrait: 'images/charData/portraits/art_bulian.png', 
            battleArt: BattleArts.BULIAN, 
            schoolLogo: Schools.HANI, societyLogo: Societies.BUKLL, 
            attr1: Attrs.METAL, attr2: '', 
            bio: '<p>æ˜¯ä¸ªå¤©åæ­Œæ‰‹</p>ä»¥å‰æ˜¯å°èºå·çš„ä¸»å”±ï¼Œåæ¥å•é£äº†ï¼Œçƒ­å¿ƒæ­£ç›´åˆåˆ»è‹¦è®¤çœŸï¼Œæè®®äº†å“ˆå°¼æ™‹å‡çš„ç³»ç»Ÿï¼Œæ›¾ç»æ˜¯å…¨ä½“å“ˆå°¼çš„å¶åƒï¼Œæ­»å¾—ä¸æ˜ä¸ç™½çš„' },
        'totally': { clickable: false,
            name:'æ‰˜å¾—ç†', nickname:'æ‰˜å¾—ç†', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'å¼ºç›—',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.TUCTUC, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'towuni': { clickable: false,
            name:'æ‰˜æ¯‹å®', nickname:'æ‰˜æ¯‹å®', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'é‡é”¤æˆ˜å£«',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.TUCTUC, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'meizi': { clickable: false,
            name:'ç¾æ»‹', nickname:'ç¾æ»‹', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'çˆ†ç ´å¸ˆ',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'peach': { clickable: false,
            name:'æ¡ƒæ±½è‹', nickname:'æ¡ƒæ±½è‹', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'èˆ¹å¤«',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'choco': { clickable: false,
            name:'è–„è‹›åŠ›', nickname:'è–„è‹›åŠ›', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'å‚¬çœ æœ¯å¸ˆ',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'cream': { clickable: false,
            name:'å†°å¿Œå»‰', nickname:'å†°å¿Œå»‰', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'å†°é­”æ³•å¸ˆ',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'sweet': { clickable: false,
            name:'ç”œé”ˆ', nickname:'ç”œé”ˆ', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'åˆºå®¢',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'kflower': { clickable: false,
            name:'å°KèŠ±', nickname:'å°KèŠ±', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'å…‰é­”æ³•å¸ˆ',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'flyh': { clickable: false,
            name:'é£è¿ªé«˜', nickname:'é£è¿ªé«˜', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'éª‘å£«',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'moji': { clickable: false,
            name:'å°è˜‘å½', nickname:'å°è˜‘å½', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'æœ¨é­”æ³•å¸ˆ',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        '2loud': { clickable: false,
            name:'ä¸¤å“', nickname:'ä¸¤å“', real:'-', gender:'å¥³', age:'15', 
            school:'å“ˆå°¼å“ˆå°¼å¿«ä¹å›­ä¸­å­¦', join:'S0 ç¬¬ä¸€å±Š', society:'å‹è°Šç™¾è´§', job:'çƒŸé›¾æ³•å¸ˆ',color:'#999' , 
            hp:0, patk:0, pdef:0, matk:0, mdef:0, 
            cardImage: CardImages.NOHANI, 
            portrait: '', 
            battleArt: '', 
            schoolLogo: Schools.HANI, societyLogo: Societies.FRIEND, 
            attr1: Attrs.DUST, attr2: Attrs.LIGHT, 
            bio: '' },
        'yan': { name:'é—«ä½³å·§', nickname:'é—«ä½³å·§', real:'-', gender:'å¥³', age:'18', 
            school:'æ—å·å¸ˆèŒƒå¤§å­¦é™„å±é«˜çº§ä¸­å­¦', join:'S0 (AA2008)', society:'ç™½æ¥¼', job:'åŸæ¸¸è¯—äºº', color:'#FFFFFF', 
            hp:999, patk:999, pdef:999, matk:999, mdef:999, isKing: true, chairs: [ 'white'], 
            cardImage: CardImages.YAN, 
            portrait: 'images/charData/portraits/art_yan.png', 
            battleArt: BattleArts.YAN, 
            schoolLogo: Schools.LINZHOU, societyLogo: Societies.WHITE, 
            attr1: '', attr2: '', 
            bio: '<p>ä¸çŸ¥é“æ˜¯è°</p>ä¸ªå­å¾ˆå°ï¼Œç˜¦å¾—åƒè¥å…»ä¸è‰¯ï¼Œåˆ«äººè·Ÿå¥¹è¯´è¯å¥¹å°±åƒæ²¡å¬è§ä¸€æ ·ï¼Œå¦‚æœä½ æŠ“åˆ°ç¨€æœ‰çš„æ˜†è™«ï¼Œå¯ä»¥é€ç»™å¥¹' }
        
    };

    const lists = {
        
        'list-condensing-tower': ['stone', 'master', 'lilmaster','coco', 'bai','xiaobei'],
        'list-bad-kids': ['hei','bald', 'ban', 'hong','jiao'],
        'list-refinery': ['piao', 'wildcat', 'dou', 'hua','niuj','gua'],
        'list-friendly-store': ['yumu', 'zhou', 'cotton', 'song', 'buzhi'],
        'list-plaza': ['sb', 'nao'],

        'list-honey': ['kid', 'xhani',  'pigeon', 'nurse', 'dream', 'wax', 'candy', 'king','flyh','moji','2loud','etc',],
        'list-bukll': ['bu_lian'] ,
        'list-mao': ['xdq','penguin', 'pao', 'zhe', 'tie'],
        'list-stars': ['pika', 'ding', 'buta'],
        'list-radio': ['sweet','kflower','secretm'], 
        'list-tuctuc': ['totally','towuni'] ,
        'list-soda4': ['meizi','peach','choco','cream'] ,

        'list-white-building': ['yan'],
        'list-union-1': ['kid', 'yumu', 'hei', 'piao'],
        'list-union-2': ['seat_empty_01','stone','hei','ban'], 

    };

    const listToLogoMap = {
        
        'list-condensing-tower': Societies.TOWER, 
        'list-bad-kids': Societies.BAD, 
        'list-refinery': Societies.FACTORY, 
        'list-plaza': Societies.PLAZA,
        'list-friendly-store':   Societies.FRIEND, 
        'list-honey': Societies.HANI, 
        'list-stars': Societies.STARS, 
        'list-mao': Societies.MAO, 
        'list-white-building': Societies.WHITE, 
        'list-union-1': Societies.UNION, 
        'list-union-2': Societies.UNION, 
        'list-radio': Societies.RADIO, 
        'list-soda4': Societies.SODA4, 
        'list-bukll': Societies.BUKLL,
        'list-tuctuc': Societies.TUCTUC
    };

    // [æ–°å¢] â€œæ¤…å­â€å›¾æ ‡ SVG
    const chairSvg = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 2a2 2 0 0 0-2 2v7H4a1 1 0 0 0-1 1v4h1v6h2v-6h12v6h2v-6h1v-4a1 1 0 0 0-1-1h-1V4a2 2 0 0 0-2-2H7zm0 2h10v7H7V4z"/></svg>`;
// [ä¿®æ”¹] åªä¿ç•™ä¸€æ ¹æ–œæ çš„ SVG (å»æ‰äº†å¤–åœ†åœˆ)
const forbiddenSvg = `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M19.7,4.3c-0.4-0.4-1-0.4-1.4,0L4.3,18.3c-0.4,0.4-0.4,1,0,1.4s1,0.4,1.4,0L19.7,5.7C20.1,5.3,20.1,4.7,19.7,4.3z" fill="#000000"/>
</svg>`;


const charModal = document.getElementById('char-modal');
    
    function openCharModal(key) {
        // 1. å‘Šè¯‰å¯¼èˆªç³»ç»Ÿå½“å‰æ˜¯è°
        updateCurrentIndex(key); 

        // 2. è·å–æ•°æ®
        const d = charData[key];
        
        // 3. ã€æ ¸å¿ƒä¿®å¤ã€‘è¿™é‡Œå¿…é¡»åˆ†è¡Œå†™ï¼Œç»å¯¹ä¸èƒ½æ”¾åœ¨æ³¨é‡Šåé¢ï¼
        // å¡«å……åå­— (å¦‚æœæœ‰çœŸåï¼Œå°±æ˜¾ç¤º "å¤–å· (çœŸå)")
        document.getElementById('m-name').innerText = d.name + (d.real !== '-' ? ' (' + d.real + ')' : '');
        
        // 4. å¡«å……å…¶ä»–åŸºç¡€ä¿¡æ¯
        document.getElementById('m-gender').innerText = d.gender; 
        document.getElementById('m-age').innerText = d.age; 
        document.getElementById('m-school').innerText = d.school; 
        document.getElementById('m-join').innerText = d.join; 
        document.getElementById('m-society').innerText = d.society; 
        document.getElementById('m-job').innerText = d.job;

        // ... (ä¸‹é¢çš„å¤§åå­—ã€ç«‹ç»˜ã€å±æ€§å›¾ä»£ç ç»§ç»­ä¿æŒä¸å˜) ...
        
        /* === [ä¿®å¤] ç ´çª—å¤§åå­—é€»è¾‘ === */
        const bigName = document.getElementById('m-big-name');
        // ...
        const showName = d.nickname || d.name; 
        
        // 1. è®¾ç½®æ–‡å­—å†…å®¹
        bigName.innerText = showName; 
        bigName.setAttribute('data-text', showName); // åŒæ­¥ç»™ CSS ä¼ªå…ƒç´ 
        
        // 2. ã€æ ¸å¿ƒä¿®å¤ã€‘æŠŠé¢œè‰²ä¼ ç»™ CSS å˜é‡ (--char-color)
        // æ— è®ºå®ƒæ˜¯æ¸å˜è¿˜æ˜¯çº¯è‰²ï¼ŒCSS éƒ½èƒ½æ¥å¾—ä½
        bigName.style.setProperty('--char-color', d.color);
        
        // 3. æ¸…ç†æ‰ä¹‹å‰å¯èƒ½æ®‹ç•™çš„å†…è”æ ·å¼ï¼Œé˜²æ­¢å¹²æ‰° CSS
        bigName.style.background = '';
        bigName.style.webkitTextFillColor = '';
        bigName.style.color = '';
        bigName.innerText = showName; 
        // ã€è¿™ä¸€å¥å¿…é¡»åŠ ã€‘æŠŠåå­—åŒæ­¥ç»™ data-text å±æ€§ï¼ŒCSS çš„ ::before æ‰èƒ½è¯»åˆ°å­—ï¼
        bigName.setAttribute('data-text', showName);
        if(d.color.includes('gradient')) { bigName.style.background = d.color; bigName.style.webkitBackgroundClip = 'text'; bigName.style.webkitTextFillColor = 'transparent'; } else { bigName.style.color = d.color; bigName.style.background = 'none'; bigName.style.webkitTextFillColor = 'initial'; }
// ... ä¸Šé¢æ˜¯ bigName çš„ä»£ç  ...

/* === [ç»ˆæä¼˜åŒ–] æˆ˜æ–—ç«‹ç»˜ï¼šé˜²æ®‹å½± + é¢„åŠ è½½ + é˜²é”™ä½ === */
        const battleImg = document.getElementById('m-battle-img');
        
        // 1. ã€æ ¸å¿ƒã€‘ç«‹åˆ»â€œé”€æ¯â€ä¸Šä¸€å¼ å›¾
        // æ— è®ºä¸‹ä¸€å¼ æœ‰æ²¡æœ‰å›¾ï¼Œå…ˆæŠŠå½“å‰çš„å›¾è—èµ·æ¥ + æ¸…ç©ºé“¾æ¥
        // è¿™æ ·å°±ç»å¯¹ä¸ä¼šå‡ºç°â€œä¸Šä¸€ä¸ªäººçš„è„¸â€äº†
        battleImg.style.transition = 'none'; // å…³æ‰åŠ¨ç”»ï¼Œé˜²æ­¢ç¬ç§»
        battleImg.style.opacity = 0;         // ç«‹åˆ»éšèº«
        battleImg.src = '';                  // æ¸…ç©ºæ•°æ®ï¼Œé˜²æ­¢æµè§ˆå™¨ç¼“å­˜æ˜¾ç¤ºæ—§å›¾
        
        // 2. è®°å½•å½“å‰æˆ‘ä»¬è¦çœ‹çš„äººæ˜¯è° (é˜²é”™ä½æœºåˆ¶)
        // æŠŠè¿™ä¸ª key è®°åœ¨ä¸€ä¸ªå±æ€§ä¸Šã€‚ç­‰å›¾ç‰‡ä¸‹è½½å¥½äº†ï¼Œæˆ‘ä»¬è¦æ ¸å¯¹ä¸€ä¸‹â€œç°åœ¨è¦çœ‹çš„äººâ€è¿˜æ˜¯ä¸æ˜¯â€œå½“æ—¶ä¸‹è½½çš„äººâ€
        // å¦‚æœç”¨æˆ·åˆ‡å¾—é£å¿« (A -> B -> C)ï¼ŒA çš„å›¾ä¸‹è½½å¥½æ—¶ï¼Œç”¨æˆ·å·²ç»åœ¨çœ‹ C äº†ï¼Œè¿™æ—¶ A çš„å›¾å°±å¿…é¡»ä¸¢å¼ƒ
        battleImg.dataset.waitingFor = key;

        if (d.battleArt) { 
            // 3. ã€æ ¸å¿ƒã€‘åˆ›å»ºä¸€ä¸ªâ€œéšå½¢ä¸‹è½½å™¨â€åœ¨åå°å¹²æ´»
            const preloader = new Image();
            preloader.src = d.battleArt;
            
            // 4. ç›‘å¬ï¼šç­‰ä¸‹è½½å®Œäº†å†æ˜¾ç¤º
            preloader.onload = () => {
                // å®‰å…¨æ£€æŸ¥ï¼šå¦‚æœä¸‹è½½å¥½çš„æ—¶å€™ï¼Œç”¨æˆ·å·²ç»åˆ‡åˆ°åˆ«äººé‚£é‡Œå»äº†ï¼Œå°±å•¥ä¹Ÿä¸åš
                if (battleImg.dataset.waitingFor !== key) return;

                // åªæœ‰ç¡®è®¤æ˜¯å½“å‰äººç‰©ï¼Œæ‰æŠŠå›¾ç‰‡å¡«è¿›å»
                battleImg.src = d.battleArt;
                battleImg.style.display = 'block';

                // 5. æ’­æ”¾è¿›åœºåŠ¨ç”»
                // å…ˆæŠŠä½ç½®æŒªåˆ°å³è¾¹ (å‡†å¤‡å†²åˆº)
                battleImg.style.transform = 'translateX(50px)';
                
                // ç»™æµè§ˆå™¨ä¸€å¸§çš„æ—¶é—´å»æ¸²æŸ“â€œæŒªåˆ°å³è¾¹â€è¿™ä¸ªåŠ¨ä½œ
                requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                        // ç„¶åå¼€å¯â€œé€šç”µâ€ï¼Œå†²å‡ºæ¥
                        battleImg.style.transition = 'all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                        battleImg.style.opacity = 1; 
                        battleImg.style.transform = 'translateX(0)'; 
                    });
                });
            };
        } else { 
            // å¦‚æœè¿™ä¸ªäººæ²¡æœ‰ç«‹ç»˜ï¼Œå°±ä¿æŒéšè—
            battleImg.style.display = 'none'; 
        }

        // ... ä¸‹é¢æ˜¯ bio çš„ä»£ç  ...
        document.getElementById('m-bio').innerHTML = d.bio ? d.bio : 'ç®€ä»‹æš‚ç¼º';
        const setAttr = (boxId, imgSrc) => { const box = document.getElementById(boxId); if (imgSrc) { box.innerHTML = `<img src="${imgSrc}" style="width:100%; height:100%; object-fit:contain;">`; box.style.border = '1px solid rgba(255,255,255,0.2)'; box.style.background = 'rgba(255,255,255,0.08)'; } else { box.innerHTML = ''; box.style.border = 'none'; box.style.background = 'transparent'; } };
        setAttr('m-attr1', d.attr1); setAttr('m-attr2', d.attr2);
        const setLogo = (imgId, textId, src) => { const img = document.getElementById(imgId); const txt = document.getElementById(textId); if(src) { img.src = src; img.style.display = 'block'; if(txt) txt.style.display = 'none'; } else { img.style.display = 'none'; if(txt) txt.style.display = 'block'; } };
        setLogo('m-school-logo', 'm-school-text', d.schoolLogo); setLogo('m-society-logo', 'm-society-text', d.societyLogo);
        /* === [ä¼˜åŒ–] å·¦ä¾§ç«‹ç»˜ï¼šé¢„åŠ è½½ + æ— ç¼åˆ‡æ¢ === */

        // 1. è·å–å›¾ç‰‡æ ‡ç­¾æœ¬èº«ï¼Œè€Œä¸æ˜¯å¤–é¢çš„ç›’å­
        const pImg = document.getElementById('m-portrait');
        const pText = document.getElementById('m-portrait-text');
        
        if (d.portrait) {
            // A. å¦‚æœæœ‰å›¾ï¼š
            
            // å…ˆç»™å›¾ç‰‡åŠ ä¸ªâ€œæ­£åœ¨åŠ è½½â€çš„æ ·å¼ï¼ˆå˜æš—/æ¨¡ç³Šï¼‰ï¼Œå‘Šè¯‰ç”¨æˆ·â€œæˆ‘è¦å˜èº«äº†â€
            // (å‰ææ˜¯ä½ CSSé‡ŒåŠ äº† #m-portrait.loading { opacity: 0.5; ... })
            pImg.classList.add('loading');

            // æ ¸å¿ƒé­”æ³•ï¼šåœ¨åå°å·å·åˆ›å»ºä¸€ä¸ªéšå½¢å›¾ç‰‡å»ä¸‹è½½
            const loader = new Image();
            loader.src = d.portrait;

            // ç›‘å¬ï¼šç­‰åå°é‚£ä¸ªéšå½¢å›¾ç‰‡çœŸçš„ä¸‹è½½å¥½äº†...
            loader.onload = () => {
                // ...å†æŠŠå±å¹•ä¸Šçš„å›¾ç‰‡æ¢æˆæ–°çš„ï¼ˆå› ä¸ºå·²ç»ä¸‹è½½åœ¨å†…å­˜é‡Œäº†ï¼Œæ‰€ä»¥æ˜¯ç¬é—´åˆ‡æ¢ï¼‰
                pImg.src = d.portrait;
                
                // ç¡®ä¿æ˜¾ç¤ºå›¾ç‰‡ï¼Œéšè—æ–‡å­—
                pImg.style.display = 'block';
                if(pText) pText.style.display = 'none';

                // ç§»é™¤â€œæ­£åœ¨åŠ è½½â€æ ·å¼ï¼Œè®©å›¾ç‰‡æ¸…æ™°åœ°æ˜¾ç¤ºå‡ºæ¥
                // åŠ ä¸ªå¾®å°çš„å»¶æ—¶ï¼Œè®©è¿‡æ¸¡åŠ¨ç”»æ›´é¡ºæ»‘
                setTimeout(() => {
                    pImg.classList.remove('loading');
                }, 50);
            };

            // é˜²å¾¡ï¼šä¸‡ä¸€å›¾ç‰‡é“¾æ¥åäº†ï¼Œå°±æ˜¾ç¤ºæ–‡å­—
            loader.onerror = () => {
                pImg.style.display = 'none';
                if(pText) pText.style.display = 'block';
                pImg.classList.remove('loading');
            }

        } else {
            // B. å¦‚æœæ²¡å›¾ï¼šç›´æ¥éšè—å›¾ç‰‡ï¼Œæ˜¾ç¤ºâ€œç«‹ç»˜å ä½â€æ–‡å­—
            pImg.style.display = 'none';
            if(pText) pText.style.display = 'block';
            pImg.classList.remove('loading');
        }
        
        const win = document.querySelector('.char-modal-window');
        if(d.color.includes('gradient')) { win.style.borderImage = d.color + ' 1'; win.style.borderWidth = '4px'; win.style.borderColor = 'transparent'; } else { win.style.borderColor = d.color; win.style.borderImage = 'none'; win.style.borderWidth = '4px'; }
        const updateBar = (id, val) => { document.getElementById('val-' + id).innerText = val; let p = val === 999 ? 100 : Math.min((val / 255) * 100, 100); const bar = document.getElementById('bar-' + id); bar.style.width = p + '%'; bar.style.background = d.color.includes('gradient') ? d.color : d.color; };
        updateBar('hp', d.hp); updateBar('patk', d.patk); updateBar('pdef', d.pdef); updateBar('matk', d.matk); updateBar('mdef', d.mdef);
        charModal.style.display = 'flex';
    }
    function closeCharModal() { charModal.style.display = 'none'; }
/* =========================================================
        [æ–°å¢ä¿®å¤] ç›‘å¬äººç‰©å¼¹çª—èƒŒæ™¯ç‚¹å‡»
        åŠŸèƒ½ï¼šç‚¹å‡»é»‘è‰²é®ç½©å±‚ (char-modal) æ—¶ï¼Œå…³é—­äººç‰©å¼¹çª—
       ========================================================= */
    // 1. è·å–äººç‰©å¼¹çª—å…ƒç´  (ç¡®ä¿å˜é‡åä¸€è‡´)
    const charModalEl = document.getElementById('char-modal');

    // 2. æ·»åŠ ç‚¹å‡»ç›‘å¬å™¨
    charModalEl.addEventListener('click', (e) => {
        // å¦‚æœç‚¹å‡»çš„ç›®æ ‡æ­£æ˜¯é®ç½©å±‚è‡ªå·±ï¼ˆè€Œä¸æ˜¯é‡Œé¢çš„å†…å®¹ï¼‰
        if (e.target === charModalEl) {
            closeCharModal();
        }
    });

// =========================================================================
    // PART 4: äººç‰©å¯¼èˆªç³»ç»Ÿ (æ–°å¢åŠŸèƒ½)
    // =========================================================================

    // 1. å…¨å±€å˜é‡ï¼šå­˜å‚¨â€œæ’­æ”¾åˆ—è¡¨â€å’Œâ€œå½“å‰ç´¢å¼•â€
    let globalCharPlaylist = [];
    let currentCharIndex = -1;

    // 2. åˆå§‹åŒ–æ’­æ”¾åˆ—è¡¨ (å…¨è‡ªåŠ¨)
    // åŠŸèƒ½ï¼šæŠŠ lists é‡Œçš„æ‰€æœ‰äººæŠ“å‡ºæ¥ï¼Œæ’æˆä¸€é˜Ÿï¼Œå¹¶å»é‡
    function initPlaylist() {
        const uniqueSet = new Set(); // ç”¨ Set è‡ªåŠ¨å»é‡
        
        // éå† lists é‡Œçš„æ¯ä¸€ä¸ªç¤¾å›¢åˆ—è¡¨
        for (const key in lists) {
            const groupList = lists[key];
            groupList.forEach(charId => {
                // åªæœ‰ charData é‡ŒçœŸå®å­˜åœ¨çš„äººæ‰åŠ è¿›å» (é˜²æ­¢ç©ºå ä½ç¬¦æŠ¥é”™)
                if (charData[charId]) {
                    uniqueSet.add(charId);
                }
            });
        }
        
        // è½¬å›æ•°ç»„ï¼Œè¿™å°±å¾—åˆ°äº†ä¸€ä¸ªå¹²å‡€çš„ã€æŒ‰é¡ºåºçš„åå•
        globalCharPlaylist = Array.from(uniqueSet);
        console.log("äººç‰©å¯¼èˆªåˆ—è¡¨å·²ç”Ÿæˆ:", globalCharPlaylist);
    }

    // 3. é¡µé¢åŠ è½½æ—¶ï¼Œå…ˆç”Ÿæˆä¸€æ¬¡åå•
    // æ”¾åœ¨ setTimeout é‡Œç¡®ä¿ data å·²ç»åŠ è½½
    setTimeout(initPlaylist, 100);

    // 4. æ”¹é€  openCharModal (è®°å½•å½“å‰æ˜¯è°)
    // ã€é‡è¦ã€‘è¯·æ‰¾åˆ°åŸæœ‰çš„ openCharModal å‡½æ•°ï¼Œåœ¨ç¬¬ä¸€è¡ŒåŠ å…¥ä¸‹é¢è¿™å¥ï¼š
    /* const d = charData[key]; 
       updateCurrentIndex(key); // <--- åŠ è¿™ä¸€å¥ï¼
    */

    // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°å½“å‰ç´¢å¼•
    function updateCurrentIndex(key) {
        // å¦‚æœåˆ—è¡¨è¿˜æ²¡ç”Ÿæˆï¼ˆæå°‘æ•°æƒ…å†µï¼‰ï¼Œä¸´æ—¶ç”Ÿæˆä¸€ä¸‹
        if (globalCharPlaylist.length === 0) initPlaylist();
        
        // æ‰¾åˆ°è¿™ä¸ªäººåœ¨åˆ—è¡¨é‡Œçš„ä½ç½®
        currentCharIndex = globalCharPlaylist.indexOf(key);
    }

// === [ä¿®æ­£ç‰ˆ] å¯¼èˆªåˆ‡æ¢ï¼šè‡ªåŠ¨è·³è¿‡ clickable: false çš„è§’è‰² ===
function navigateChar(direction) {
    if (globalCharPlaylist.length === 0) return;
    if (currentCharIndex === -1) return;

    let searchIndex = currentCharIndex;
    let foundId = null;

    // å¾ªç¯æŸ¥æ‰¾ï¼šæœ€å¤šæ‰¾ä¸€åœˆ (é˜²æ­¢å…¨å‘˜ä¸å¯ç‚¹å¯¼è‡´æ­»å¾ªç¯)
    for (let i = 0; i < globalCharPlaylist.length; i++) {
        // 1. æŒªåŠ¨ä¸€æ­¥
        searchIndex += direction;

        // 2. å¤„ç†é¦–å°¾å¾ªç¯
        if (searchIndex >= globalCharPlaylist.length) searchIndex = 0;
        if (searchIndex < 0) searchIndex = globalCharPlaylist.length - 1;

        // 3. æ£€æŸ¥è¿™ä¸ªäººèƒ½ä¸èƒ½çœ‹
        const id = globalCharPlaylist[searchIndex];
        const d = charData[id];

        // åªæœ‰å½“ d å­˜åœ¨ï¼Œä¸”æ²¡æœ‰è¢«æ˜¾å¼æ ‡è®°ä¸ºâ€œä¸å¯ç‚¹â€æ—¶ï¼Œæ‰é€‰ä¸­ä»–
        // (ä¹Ÿå°±æ˜¯è¯´ï¼šclickable ä¸º true æˆ–è€… undefined æ—¶éƒ½å¯ä»¥çœ‹)
        // (å¦‚æœ clickable: falseï¼Œå¾ªç¯ä¼šç»§ç»­ï¼Œç›´æ¥è·³è¿‡è¿™ä¸ªäºº)
        if (d && d.clickable !== false) {
            foundId = id;
            break; // æ‰¾åˆ°äº†ï¼åœæ­¢å¯»æ‰¾
        }
    }

    // å¦‚æœæ‰¾åˆ°äº†åˆæ³•çš„ä¸‹ä¸€ä¸ªäººï¼Œæ‰æ‰“å¼€å¼¹çª—
    if (foundId) {
        openCharModal(foundId, direction);
    }
}
    
// =========================================
    // PART 5: é”®ç›˜äº‹ä»¶ç›‘å¬ (å¯¼èˆª + ESCå…³é—­)
    // =========================================
    
    document.addEventListener('keydown', function(event) {
        const charModal = document.getElementById('char-modal');
        const cardModal = document.getElementById('bqcModal');
        const bigImg = document.getElementById('bqcBigImg'); // è·å–å¤§å›¾å…ƒç´ 

        // === [æ–°å¢] ESC é”®å…³é—­é€»è¾‘ ===
        if (event.key === 'Escape') {
            // 1. å¦‚æœäººç‰©çª—å¼€ç€ -> å…³æ‰
            if (charModal && charModal.style.display === 'flex') {
                closeCharModal();
            }
            // 2. å¦‚æœå¡ç‰Œçª—å¼€ç€ -> å…³æ‰
            if (cardModal && cardModal.classList.contains('active')) {
                cardModal.classList.remove('active');
                if(bigImg) bigImg.src = ''; // æ¸…ç©ºå›¾ç‰‡
            }
            return; // å…³æ‰åå°±ä¸æ‰§è¡Œåé¢çš„å·¦å³åˆ‡æ¢äº†
        }

        // === åŸæœ‰çš„å·¦å³åˆ‡æ¢é€»è¾‘ ===
        
        // A. äººç‰©æ¨¡å¼
        if (charModal && charModal.style.display === 'flex') {
            if (event.key === 'ArrowLeft') {
                navigateChar(-1); triggerBtnAnim('btn-prev');
            } else if (event.key === 'ArrowRight') {
                navigateChar(1); triggerBtnAnim('btn-next');
            }
        }
        
        // B. å¡ç‰Œæ¨¡å¼
        else if (cardModal && cardModal.classList.contains('active')) {
            if (event.key === 'ArrowLeft') {
                navigateCard(-1); triggerBtnAnim('btn-card-prev');
            } else if (event.key === 'ArrowRight') {
                navigateCard(1); triggerBtnAnim('btn-card-next');
            }
        }
    });

// =========================================
    // [æ–°å¢] ç‰©ç†æŒ‰é”®åé¦ˆç³»ç»Ÿ (Press & Release)
    // =========================================

    // 1. å®šä¹‰ä¸€ä¸ªé€šç”¨çš„é«˜äº®å‡½æ•°
    function setupButtonFeedback() {
        // æ‰¾åˆ°æ‰€æœ‰çš„åœ†å½¢å¯¼èˆªæŒ‰é’® (äººç‰©é¡µ + å¡ç‰Œé¡µ)
        const allBtns = document.querySelectorAll('.nav-btn-char');

        allBtns.forEach(btn => {
            // --- æ‰‹æœºç«¯é€»è¾‘ (è§¦æ‘¸) ---
            
            // æ‰‹æŒ‡æŒ‰ä¸‹ -> äº®
            btn.addEventListener('touchstart', function(e) {
                // ä¸é˜»æ­¢å†’æ³¡ï¼Œä¿è¯ onclick èƒ½è§¦å‘è·³è½¬
                btn.classList.add('is-active');
            }, { passive: true });

            // æ‰‹æŒ‡æ¾å¼€/ç§»å¼€/è¢«æ‰“æ–­ -> ç­
            const endHighlight = () => {
                // ç¨å¾®ç»™ä¸€ç‚¹ç‚¹å»¶è¿Ÿ(50ms)ï¼Œé˜²æ­¢ç‚¹å‡»å¤ªå¿«çœ‹ä¸æ¸…é—ªçƒ
                setTimeout(() => {
                    btn.classList.remove('is-active');
                }, 50);
            };

            btn.addEventListener('touchend', endHighlight);
            btn.addEventListener('touchcancel', endHighlight);
            
            
            // --- ç”µè„‘ç«¯é€»è¾‘ (é¼ æ ‡) ---
            
            // é¼ æ ‡æŒ‰ä¸‹ -> äº®
            btn.addEventListener('mousedown', function() {
                btn.classList.add('is-active');
            });
            
            // é¼ æ ‡æ¾å¼€/ç§»å¼€ -> ç­
            btn.addEventListener('mouseup', () => btn.classList.remove('is-active'));
            btn.addEventListener('mouseleave', () => btn.classList.remove('is-active'));
        });
    }

    // 2. é¡µé¢åŠ è½½å®Œï¼Œç«‹åˆ»ç»™æ‰€æœ‰æŒ‰é’®è£…ä¸Šè¿™ä¸ªç³»ç»Ÿ
    // æ”¾åœ¨ setTimeout é‡Œç¡®ä¿ HTML å·²ç»æ¸²æŸ“å®Œäº†
    setTimeout(setupButtonFeedback, 500);

    // 3. ä¸ºäº†å…¼å®¹åŸæ¥çš„é”®ç›˜é€»è¾‘ï¼Œä¿ç•™ triggerBtnAnim ä½†æ”¹å†™å®ƒ
    // (ç»™é”®ç›˜ç”¨çš„ï¼Œè¿˜æ˜¯ä¿æŒå®šæ—¶è‡ªåŠ¨ç­ï¼Œå› ä¸ºé”®ç›˜æ²¡æœ‰ touchstart)
    function triggerBtnAnim(btnId) {
        const btn = document.getElementById(btnId);
        if (!btn) return;
        btn.classList.add('is-active');
        setTimeout(() => { btn.classList.remove('is-active'); }, 150);
    }

    
// =========================================================================
    // PART 6: æ–‘ä¸˜å¡ç‰Œç³»ç»Ÿ (BQC) æ ¸å¿ƒé€»è¾‘ - ç§»æ¤ç‰ˆ
    // =========================================================================

// =========================================================================
    // PART 6.1: è§„åˆ™é¡µè‡ªåŠ¨åŒ– (å›¾æ ‡å­—å…¸ & è¡¨æ ¼ç”Ÿæˆ)
    // =========================================================================

    // 1. [æ ¸å¿ƒ] å¡ç‰Œå›¾æ ‡å­—å…¸ (ä»¥ååœ¨ä»»ä½•åœ°æ–¹å¼•ç”¨å›¾æ ‡ï¼Œå°±ç”¨ RuleIcons.RW è¿™ç§æ ¼å¼)
    const RuleIcons = {
        RW: 'images/BQcards/icons/cards_categories/UI_Card_Person_01.png',  // äººç‰©å¡ (Ren Wu)
        JN: 'images/BQcards/icons/cards_categories/UI_Card_Skill_01.png',   // æŠ€èƒ½å¡ (Ji Neng)
        WP: 'images/BQcards/icons/cards_categories/UI_Card_Item_01.png',    // ç‰©å“å¡ (Wu Pin)
        JK: 'images/BQcards/icons/cards_categories/UI_Card_Medal_01.png'    // çºªå¿µå¡ (Ji Nian / Jie Ke)
    };

    // 2. è¡¨æ ¼å†…å®¹é…ç½® (æŠŠåŸæ¥ HTML é‡Œçš„å­—æ¬åˆ°è¿™é‡Œ)
    const ruleTableData = [
        {
            key: 'RW', name: 'äººç‰©å¡', color: '#2f5fff',
            c1: 'å‡»æ€ / èµ äºˆ',
            c2: 'è·å–å±æ€§å— / é€šè®¯',
            c3: 'æ°¸ä¹…', c3Class: '', // c3Classç”¨äºæ§åˆ¶é¢œè‰² (æ¯”å¦‚ warn)
            c4: 'ä¸å¯', c4Class: 'no',
            c5: 'å¯',   c5Class: 'yes'
        },
        {
            key: 'JN', name: 'æŠ€èƒ½å¡', color: '#ff3422',
            c1: 'å•†åº—æŠ½å– / äº¤æ˜“',
            c2: 'é‡Šæ”¾å¼ºåŠ›æˆ˜æ–—æ‹›å¼',
            c3: 'ä¸€æ¬¡æ€§', c3Class: 'warn',
            c4: 'å¯',    c4Class: 'yes',
            c5: 'å¯',    c5Class: 'yes'
        },
        {
            key: 'WP', name: 'ç‰©å“å¡', color: '#23c75a',
            c1: 'æ¢ç´¢ / å•†åº—',
            c2: 'åŠ æˆ / æ¢å¤ / å¬å”¤æ€ªç‰©',
            c3: 'ä¸€æ¬¡æ€§', c3Class: 'warn',
            c4: 'ä¸å¯',  c4Class: 'no',
            c5: 'å¯',    c5Class: 'yes'
        },
        {
            key: 'JK', name: 'çºªå¿µå¡', color: '#eeff00',
            c1: 'å‡»æ€ / ç‰¹å®šäººç‰© / æ¢ç´¢',
            c2: 'é›†é½ç›´æ¥è·èƒœ', 
            c3: 'æ°¸ä¹…', c3Class: '',
            c4: 'ä¸å¯', c4Class: 'no',
            c5: 'å¯',   c5Class: 'yes',
            isHidden: false // [æ ‡è®°] è¿™æ˜¯ä¸€ä¸ªéšè—è§„åˆ™
        }
    ];

// 3. æ¸²æŸ“è§„åˆ™è¡¨æ ¼å‡½æ•°
    function renderRuleTable() {
        const container = document.getElementById('rule-table-body');
        if (!container) return;

        let html = '';

        ruleTableData.forEach(row => {
            // åˆ¤æ–­æ˜¯å¦æ˜¯éšè—è§„åˆ™ï¼ŒåŠ ä¸Šå¯¹åº”çš„ class
            const rowClass = row.isHidden ? 'card-row hidden-rule-style' : 'card-row';
            const stampHtml = row.isHidden ? '<div class="hidden-stamp">éšè—</div>' : '';
            const c2Style = row.c2Style ? `style="${row.c2Style}"` : '';

            // å¼•ç”¨å­—å…¸é‡Œçš„å›¾æ ‡ï¼šRuleIcons[row.key]
            const iconSrc = RuleIcons[row.key];

            html += `
            <div class="${rowClass}">
                ${stampHtml}
                <div class="col-icon-fixed">
                    <div class="card-type-unit">
                        <div class="card-img-box">
                            <img src="${iconSrc}" alt="${row.name}">
                        </div>
                        <div class="card-label-box" style="--tag-bg: ${row.color};">${row.name}</div>
                    </div>
                </div>
                <div class="col-data-flex">
                    <div class="cell-common c-1">${row.c1}</div>
                    <div class="cell-common c-2" ${c2Style}>${row.c2}</div>
                    <div class="cell-common c-3 ${row.c3Class}">${row.c3}</div>
                    <div class="cell-common c-4 ${row.c4Class}">${row.c4}</div>
                    <div class="cell-common c-5 ${row.c5Class}">${row.c5}</div>
                </div>
            </div>
            `;
        });

        container.innerHTML = html;
    }



    // 1. æ•°æ®å­—å…¸
    const bqCardData = {
        "RW": [ "RW-A01a-PGa", "RW-A01a-QSa", "RW-A01a-QSb", "RW-A02a-PGa", "RW-A03a-PGa", "RW-B04a-QSa", "RW-B05a-PGa", "RW-C11a-PGa", "RW-C11a-QGa", "RW-C12a-PGa", "RW-C12a-PGb", "RW-C12a-QGa", "RW-C12a-QSa", "RW-C12a-QSb", "RW-D01a-QSb", "RW-D15a-QSa", "RW-D21a-QSa", "RW-D22a-QSa", "RW-D23a-QSa", "RW-D25a-QSa", "RW-D32a-QSa", "RW-D33a-QSc", "RW-D34a-QSa", "RW-D39a-QSb", "RW-D39a-QSc", "RW-D47a-QSa", "RW-D47a-QSd", "RW-D48a-QSa", "RW-D48a-QSb", "RW-D95a-QSb", "RW-DE08a-PGa", "RW-DE08a-QGa", "RW-DE08a-QSa", "RW-DF02a-PGa", "RW-DF02b-PGa", "RW-DF05b-PGa", "RW-DF05b-QGa", "RW-E05a-PGa", "RW-E05a-QGa", "RW-E07a-PGa", "RW-E07a-QGa", "RW-E07a-QSa", "RW-K02a-PGa", "RW-W02a-PGa" ],
        "JN": [ "JN-C011a-PGa", "JN-C012a-PGa", "JN-C013a-PGa", "JN-C014a-PGa", "JN-C015a-PGa", "JN-C016a-PGa", "JN-C017a-PGa", "JN-C018a-PGa", "JN-C019a-PGa", "JN-C020a-PGa", "JN-C021a-PGa", "JN-C022a-PGa", "JN-C023a-PGa", "JN-C024a-PGa", "JN-C025a-PGa", "JN-C026a-PGa", "JN-C027a-PGa", "JN-C028a-PGa", "JN-C029a-PGa", "JN-C030a-PGa", "JN-C031a-PGa", "JN-C032a-PGa", "JN-C033a-PGa", "JN-C034a-PGa", "JN-C035a-PGa", "JN-C036a-PGa", "JN-C037a-PGa", "JN-C038a-PGa", "JN-C039a-PGa", "JN-C040a-PGa", "JN-C041a-PGa" ],
        "WP": [ "WP-A009a-PGa", "WP-C021a-PGa", "WP-C022a-PGa", "WP-C023a-PGa", "WP-C024a-PGa", "WP-C025a-PGa", "WP-C026a-PGa", "WP-C027a-PGa", "WP-C028a-PGa", "WP-C029a-PGa", "WP-C030a-PGa", "WP-C031a-PGa", "WP-C032a-PGa", "WP-C033a-PGa", "WP-C034a-PGa", "WP-C035a-PGa", "WP-C036a-PGa", "WP-C037a-PGa", "WP-C038a-PGa", "WP-C039a-PGa", "WP-C040a-PGa", "WP-X001a-PGa", "WP-X002a-PGa", "WP-X003a-PGa", "WP-X004a-PGa", "WP-X005a-PGa", "WP-X011a-PGa", "WP-X012a-PGa", "WP-X024a-PGa", "WP-X046a-PGa", "WP-Y021a-PGa", "WP-Y022a-PGa", "WP-Y023a-PGa", "WP-Y024a-PGa", "WP-Y025a-PGa", "WP-Y026a-PGa", "WP-Y027a-PGa", "WP-Y064a-PGa", "WP-Y065a-PGa", "WP-Y104a-PGa" ],
        "JK": [ "JK-011a-QSa", "JK-012a-QSa", "JK-013a-QSa", "JK-014a-QSa", "JK-015a-QSa", "JK-016a-QSa", "JK-017a-QSa", "JK-031a-QSa", "JK-032a-QSa", "JK-033a-QSa", "JK-034a-QSa", "JK-035a-QSa", "JK-071a-QSa", "JK-072a-QSa", "JK-073a-QSa", "JK-074a-QSa", "JK-075a-QSa", "JK-076a-QSa" ]
    };

    // 2. é…ç½®
    const bqCategories = [
        { key: 'RW', name: 'äººç‰©å¡', logo: RuleIcons.RW , color: '#2f5fff' ,poster: ''},
        { key: 'JN', name: 'æŠ€èƒ½å¡', logo: RuleIcons.JN , color: '#ff3422' ,poster: ''},
        { key: 'WP', name: 'ç‰©å“å¡', logo: RuleIcons.WP , color: '#23c75a' ,poster: ''},
        { key: 'JK', name: 'çºªå¿µå¡', logo: RuleIcons.JK , color: '#eeff00' ,poster: ''}
    ];
    const bqBasePath = 'images/BQcards/cards_front/';

// 3. æ¸²æŸ“å‡½æ•° (ä¿®å¤ç‰ˆï¼šä¼ å…¥ event é˜»æ­¢å†’æ³¡)
    function renderBqCards() {
        const container = document.getElementById('bqcApp');
        const jumpListEl = document.getElementById('bqc-jump-list');
        if(!container) return; 
        
// === ã€æ–°å¢ã€‘åœ¨æœ€é¡¶éƒ¨åŠ å…¥å¡ç‰Œé¡µçš„å¤§å¤´å›¾ ===
    // è¯·æ›¿æ¢ src ä¸ºä½ çš„çœŸå®å›¾ç‰‡è·¯å¾„
    let htmlContent = `<img src="images/headers/page_header_card.png" class="header-poster-28" style="margin-bottom: 30px;">`;
    let jumpMenuHtml = ''; 
// 2. ã€æ–°å¢ã€‘åœ¨è¿™é‡Œæ’å…¥è§„åˆ™è¡¨æ ¼ (æ¬è¿è¿‡æ¥çš„)
    // ä½¿ç”¨ archive-block ç¡®ä¿å®½åº¦å’Œé¡µè¾¹è·ä¸é¡µé¢å…¶ä»–å†…å®¹ä¸€è‡´
    htmlContent += `<div class="archive-block" style="margin-bottom: 60px;">`;
    
    // 2.1 è¡¨å¤´ (ç›´æ¥å¤åˆ¶ HTML ç»“æ„)
    htmlContent += `
        <div class="card-table-header">
            <div class="col-icon-fixed">å¡ç‰Œç§ç±»</div>
            <div class="col-data-flex">
                <div class="cell-common c-1">è·å–æ–¹å¼</div>
                <div class="cell-common c-2">åŠŸèƒ½/ç”¨é€”</div>
                <div class="cell-common c-3">æ¬¡æ•°</div>
                <div class="cell-common c-4">å„æ–­</div>
                <div class="cell-common c-5">äº¤æ¢</div>
            </div>
        </div>
    `;

    // 2.2 è¡¨æ ¼å†…å®¹ (éå† ruleTableData ç”Ÿæˆ)
    ruleTableData.forEach(row => {
        const rowClass = row.isHidden ? 'card-row hidden-rule-style' : 'card-row';
        const stampHtml = row.isHidden ? '<div class="hidden-stamp">éšè—</div>' : '';
        const c2Style = row.c2Style ? `style="${row.c2Style}"` : '';
        
        // è·å–å›¾æ ‡ (ç¡®ä¿ RuleIcons å­˜åœ¨)
        const iconSrc = RuleIcons[row.key] || '';

// === [ä¿®æ”¹] åŠ äº† onclick è·³è½¬äº‹ä»¶ï¼ŒåŠ äº† cursor æ‰‹å‹é¼ æ ‡ ===
    htmlContent += `
    <div class="${rowClass}" 
        onclick="jumpToCardCategory('${row.key}')" 
        style="cursor: pointer;">
        ${stampHtml}
            <div class="col-icon-fixed">
                <div class="card-type-unit">
                    <div class="card-img-box">
                        <img src="${iconSrc}" alt="${row.name}">
                    </div>
                    <div class="card-label-box" style="--tag-bg: ${row.color};">${row.name}</div>
                </div>
            </div>
            <div class="col-data-flex">
                <div class="cell-common c-1">${row.c1}</div>
                <div class="cell-common c-2" ${c2Style}>${row.c2}</div>
                <div class="cell-common c-3 ${row.c3Class}">${row.c3}</div>
                <div class="cell-common c-4 ${row.c4Class}">${row.c4}</div>
                <div class="cell-common c-5 ${row.c5Class}">${row.c5}</div>
            </div>
        </div>`;
    });

    htmlContent += `</div>`; // é—­åˆ archive-block å®¹å™¨
        bqCategories.forEach(cat => {
            const fileList = bqCardData[cat.key];
            if (!fileList) return;
            
// --- 1. è¨ˆç®—èƒŒæ™¯æ¼¸è®Š (æŠ“å–ç•¶å‰å¡ç‰Œåˆ†é¡çš„å°è±¡è‰² cat.color) ---å¡ç‰ŒèƒŒæ™¯æ¸å˜
            const sectionBg = `linear-gradient(180deg, ${cat.color}11 0%, rgba(26,26,26,0) 100%)`;
// ç”Ÿæˆæµ·æŠ¥ä»£ç 
        const posterHtml = cat.poster ? `<img src="${cat.poster}" class="header-poster-28">` : '';

        htmlContent += `
            <div class="bqc-group-section" id="bqc-group-${cat.key}" style="background: ${sectionBg};">
                
                <div class="bqc-chapter-bar" 
                    id="cat-anchor-${cat.key}"
                    onclick="toggleBqcMenu()" 
                    style="border-left-color: ${cat.color}; cursor: pointer;">
                    <img src="${cat.logo}" class="bqc-bar-logo" alt="${cat.key}" onerror="this.style.display='none'">
                    <span class="bqc-bar-title" style="color:${cat.color}">${cat.name} â–¾</span>
                </div>

                ${posterHtml}

                <div class="bqc-grid" style="margin-top: 0;">`;
        
        // ç”Ÿæˆèœå•é¡¹ (ä¸å˜)
        jumpMenuHtml += `
            <div class="jump-btn" 
                onclick="scrollToCat('${cat.key}', event)"
                style="border-left-color: ${cat.color};"> 
                <img src="${cat.logo}" class="jump-icon">
                <span class="jump-text" style="color:${cat.color}">${cat.name}</span>
            </div>`;

        // ç”Ÿæˆå¡ç‰‡ (ä¸å˜)
        fileList.forEach(fileName => {
            const imgSrc = `${bqBasePath}${fileName}.png`; 
            htmlContent += `
                <div class="bqc-card-item" onclick="openBqcModal('${imgSrc}')">
                    <img src="${imgSrc}" class="bqc-card-img" loading="lazy" alt="${fileName}">
                </div>`;
        });
        htmlContent += `</div></div>`;
    });
    
    container.innerHTML = htmlContent;
    if(jumpListEl) jumpListEl.innerHTML = jumpMenuHtml;
}

    // åˆ‡æ¢å¡ç‰Œå‡½æ•° (ä¿®å¤PNG)
    function navigateCard(dir) {
        if (globalCardPlaylist.length === 0) return;

        let newIndex = currentCardIndex + dir;
        if (newIndex >= globalCardPlaylist.length) newIndex = 0;
        if (newIndex < 0) newIndex = globalCardPlaylist.length - 1;

        const nextFile = globalCardPlaylist[newIndex];
        
        // ğŸ‘‡ è¿™é‡Œä¹Ÿæ”¹å›äº† .png
        const nextSrc = bqBasePath + nextFile + '.png';
        
        openBqcModal(nextSrc);
    }

// =========================================
    // [ä¿®æ­£ç‰ˆ] èœå•äº¤äº’ä¸è·³è½¬é€»è¾‘
    // =========================================
    
    // 1. å¼€å…³èœå• (ç‚¹å‡»æ ‡é¢˜æ è§¦å‘)
    function toggleBqcMenu() {
        const menu = document.getElementById('bqc-jump-menu');
        if(menu) menu.classList.toggle('active');
    }

    // =========================================
    // [ç»ˆæä¿®æ­£ V3] èœå•è·³è½¬ (ç½‘æ ¼é”šç‚¹å®šä½æ³•)
    // =========================================

    function scrollToCat(key, event) {
        // 1. é˜»æ­¢ç‚¹å‡»ç©¿é€ + å…³é—­èœå•
        if (event) event.stopPropagation();
        const menu = document.getElementById('bqc-jump-menu');
        if(menu) menu.classList.remove('active');
        
        // 2. æ‰¾åˆ°æ»šåŠ¨å®¹å™¨
        const container = document.getElementById('view-cards');
        
        // 3. æ‰¾åˆ°ç›®æ ‡æ ‡é¢˜ (Header)
        const header = document.getElementById(`cat-anchor-${key}`);
        
        if (container && header) {
            // === ã€æ ¸å¿ƒä¿®æ”¹ã€‘ ===
            // ä¸è¦æ‰¾ Header çš„ä½ç½® (å› ä¸ºå®ƒä¼šå¸é¡¶ä¹±è·‘)
            // è¦æ‰¾ Header ä¸‹é¢ç´§æŒ¨ç€çš„é‚£ä¸ª "å¡ç‰Œç½‘æ ¼ (Grid)" çš„ä½ç½®
            // Grid å¾ˆè€å®ï¼Œæ°¸è¿œä¸ä¼šå¸é¡¶
            
            const grid = header.nextElementSibling; // è·å–æ ‡é¢˜ä¸‹é¢çš„ div
            
            if (grid) {
                // A. ç®—å‡º Grid è·ç¦»å®¹å™¨é¡¶éƒ¨çš„çœŸå®è·ç¦»
                // (Gridé¡¶éƒ¨ - å®¹å™¨é¡¶éƒ¨) + å½“å‰å·²æ»šåŠ¨çš„è·ç¦»
                const gridTop = grid.getBoundingClientRect().top;
                const containerTop = container.getBoundingClientRect().top;
                const currentScroll = container.scrollTop;
                
                // B. ç®—å‡º Header çš„é«˜åº¦ (åŒ…å« padding)
                // æ¯”å¦‚å®ƒæ˜¯ 60px é«˜
                const headerHeight = header.offsetHeight;
                
                // C. è®¡ç®—æœ€ç»ˆåæ ‡
                // ç›®æ ‡ä½ç½® = ç½‘æ ¼çš„ä½ç½® - æ ‡é¢˜çš„é«˜åº¦ - ä¸€ç‚¹ç‚¹ç¼éš™(20px)
                // è¿™æ ·æ»šè¿‡å»åï¼Œæ ‡é¢˜æ­£å¥½å‹åœ¨ç½‘æ ¼ä¸Šé¢ï¼Œå®Œç¾éœ²å‡º
                const finalPos = currentScroll + (gridTop - containerTop) - headerHeight - 20;

                // D. æ‰§è¡Œæ»šåŠ¨
                container.scrollTo({
                    top: finalPos,
                    behavior: "smooth"
                });
            } else {
                // ä¸‡ä¸€ï¼ˆè™½ç„¶ä¸å¯èƒ½ï¼‰æ‰¾ä¸åˆ° Gridï¼Œå°±åªå¥½å‹‰å¼ºæ»šåˆ° Header
                // è¿™æ˜¯ä¿åº•é€»è¾‘
                const headerTop = header.getBoundingClientRect().top - container.getBoundingClientRect().top;
                container.scrollTo({ top: container.scrollTop + headerTop, behavior: "smooth" });
            }
        }
    }
    
    // 2. å¼€å…³èœå• (ç‚¹å‡»æ ‡é¢˜æ è§¦å‘) - ä¿æŒä¸å˜
    function toggleBqcMenu() {
        const menu = document.getElementById('bqc-jump-menu');
        if(menu) menu.classList.toggle('active');
    }

    // 4. äº¤äº’é€»è¾‘ (3D + åå…‰ + é®ç½©)
    const bqcModal = document.getElementById('bqcModal');
    const tiltCard = document.getElementById('bqcTiltCard');
    const bigImg = document.getElementById('bqcBigImg');

    function openBqcModal(src) {
        bigImg.src = src;
        bqcModal.classList.add('active');
        // é‡ç½®
        tiltCard.style.transform = `perspective(2000px) rotateX(0deg) rotateY(0deg)`;
        
        // è®¾ç½®é®ç½©
        const shineLayer = document.getElementById('bqcShine');
        if(shineLayer) {
            shineLayer.style.webkitMaskImage = `url('${src}')`;
            shineLayer.style.maskImage = `url('${src}')`;
        }
    }

    // å…³é—­é€»è¾‘
    bqcModal.addEventListener('click', function(e) {
        if (e.target === bqcModal || e.target.classList.contains('bqc-close-hint') || e.target === bigImg) {
            bqcModal.classList.remove('active');
            bigImg.src = '';
        }
    });



// ==============================================================
    // [æ–°å¢] ç§»åŠ¨ç«¯ 3D è§¦æ‘¸æ”¯æŒ (ä¸å½±å“ç”µè„‘ç«¯)
    // ==============================================================

// ==============================================================
    // [ä¿®æ­£ç‰ˆ] ç§»åŠ¨ç«¯ 3D è§¦æ‘¸ (é«˜çµæ•åº¦ + èŒƒå›´é”å®š)
    // ==============================================================


    // =========================================
    // [æ–°å¢] å¡ç‰Œåˆ‡æ¢ç³»ç»Ÿ (ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ )
    // =========================================

    // 1. ç”Ÿæˆå¡ç‰Œæ’­æ”¾åˆ—è¡¨ (æŠŠæ‰€æœ‰å¡ç‰Œæ‹æ‰æˆä¸€ä¸ªå¤§æ•°ç»„)
    let globalCardPlaylist = [];
    let currentCardIndex = 0;

    function initCardPlaylist() {
        globalCardPlaylist = [];
        // æŒ‰ RW, JN, WP, JK çš„é¡ºåºæŠŠå¡ç‰Œåå­—åŠ è¿›å»
        bqCategories.forEach(cat => {
            const list = bqCardData[cat.key];
            if(list) globalCardPlaylist.push(...list);
        });
        console.log("å¡ç‰Œæ’­æ”¾åˆ—è¡¨ç”Ÿæˆ:", globalCardPlaylist.length, "å¼ ");
    }
    // ç«‹å³åˆå§‹åŒ–
    initCardPlaylist();

    // 2. æ”¹é€ æ‰“å¼€å¼¹çª—å‡½æ•° (è®°å½•å½“å‰æ˜¯å“ªä¸€å¼ )
    // è¯·ä¿ç•™ä½ ä¹‹å‰çš„ openBqcModal é€»è¾‘ï¼Œè¿™é‡Œä¸»è¦æ˜¯å¢åŠ ç´¢å¼•æŸ¥æ‰¾
    const oldOpenBqcModal = openBqcModal; // å¤‡ä»½ä¸€ä¸‹æ—§å¼•ç”¨é˜²æ­¢æ­»å¾ªç¯(è™½ç„¶åé¢æ²¡ç”¨åˆ°)
    
    // è¦†ç›–æ—§å‡½æ•°
    openBqcModal = function(src) {
        // A. æ‰§è¡ŒåŸæœ‰çš„æ˜¾ç¤ºé€»è¾‘ (æ˜¾ç¤ºå›¾ç‰‡ã€3Då¤ä½ã€é®ç½©ç­‰)
        bigImg.src = src;
        bqcModal.classList.add('active');
        tiltCard.style.transform = `perspective(2000px) rotateX(0deg) rotateY(0deg)`;
        const shineLayer = document.getElementById('bqcShine');
        if(shineLayer) {
            shineLayer.style.webkitMaskImage = `url('${src}')`;
            shineLayer.style.maskImage = `url('${src}')`;
        }

        // B. [æ–°å¢] ç®—å‡ºå½“å‰æ˜¯ç¬¬å‡ å¼ 
        // src æ˜¯ "images/.../RW-xxx.png"ï¼Œæˆ‘ä»¬éœ€è¦æå–å‡º "RW-xxx"
        const filename = src.substring(src.lastIndexOf('/') + 1).replace('.png', '');
        currentCardIndex = globalCardPlaylist.indexOf(filename);
    }

    // 3. åˆ‡æ¢å‡½æ•° (ç”±æŒ‰é’®è°ƒç”¨)
    function navigateCard(dir) {
        if (globalCardPlaylist.length === 0) return;

        // è®¡ç®—æ–°ç´¢å¼• (å¾ªç¯æ’­æ”¾)
        let newIndex = currentCardIndex + dir;
        if (newIndex >= globalCardPlaylist.length) newIndex = 0;
        if (newIndex < 0) newIndex = globalCardPlaylist.length - 1;

        // è·å–æ–°æ–‡ä»¶å
        const nextFile = globalCardPlaylist[newIndex];
        
        // æ‹¼å‡‘å®Œæ•´è·¯å¾„ (bqBasePath ä¹‹å‰å·²ç»å®šä¹‰è¿‡äº†)
        const nextSrc = bqBasePath + nextFile + '.png';
        
        // æ‰“å¼€æ–°å¡ç‰Œ
        openBqcModal(nextSrc);
    }

    // 5. å¯åŠ¨
    renderBqCards();

// =========================================
// [ä¿®æ”¹ç‰ˆ] æµ®çª—å®šä½ï¼šæ²‰åº•é å·¦ + ç•™å‡ºæŒ‰é’®ç©ºé—´
// =========================================
function fitModalToMobile() {
    const modalWin = document.querySelector('.char-modal-window');
    if (!modalWin) return;

    const screenW = window.innerWidth;
    const screenH = window.innerHeight;
    const baseWidth = 960; 
    
// === 1. ç”µè„‘ç«¯ ( > 1000px ) ===
    // å¿…é¡»ä¸¥æ ¼è¿˜åŸ CSS é‡Œçš„ left: 5% è®¾å®š
    if (screenW > 1000) {
        modalWin.style.transformOrigin = 'center center';
        
        // ã€æ ¸å¿ƒä¿®å¤ã€‘è¿˜åŸå› 5%ï¼Œè€Œä¸æ˜¯ 50%
        modalWin.style.left = '5%'; 
        modalWin.style.top = '50%';
        
        // è¿˜åŸ CSS é‡Œçš„å‚ç›´å±…ä¸­ + 0.9å€ç¼©æ”¾
        modalWin.style.transform = 'translateY(-50%) scale(0.9)';
        
        // æ¸…ç†æ‰‹æœºç«¯å¯èƒ½ç•™ä¸‹çš„è¾¹è·æ ·å¼
        modalWin.style.margin = '0';
        return;
    }

    // 2. æ‰‹æœºç«¯ï¼šå·¦ä¸‹è§’å¯¹é½
    
    // A. è®¡ç®—ç¼©æ”¾æ¯”ä¾‹ (ä¿æŒä¸¤è¾¹ç•™éš™)
    // ç¨å¾®æ”¹å°ä¸€ç‚¹ç³»æ•° (æ¯”å¦‚ -30)ï¼Œè®©å¼¹çª—æ›´è¿·ä½ ä¸€ç‚¹ï¼Œç»™ä¸Šé¢ç•™ç©ºé—´
    const targetScale = (screenW - 30) / baseWidth;
    
    // B. è®¡ç®—æ°´å¹³ä½ç½® (xOffset)ï¼šé å·¦ï¼Œç•™ 15px ç¼éš™
    const xOffset = 15;
    
    // C. è®¡ç®—å‚ç›´ä½ç½® (yOffset)ï¼šæ²‰åº•
    // å…¬å¼ï¼šå±å¹•é«˜åº¦ - (å¼¹çª—çœŸå®é«˜åº¦) - (åº•éƒ¨é¢„ç•™ç»™æŒ‰é’®çš„ç©ºé—´)
    // æ‚¨çš„æŒ‰é’® bottom æ˜¯ -150pxï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç•™è‡³å°‘ 160px çš„ç©ºé—´é˜²æ­¢æŒ‰é’®è¢«åˆ‡
    const modalBaseHeight = 640;
    const buttonSpace = 160; // ã€å…³é”®ã€‘ç»™åº•éƒ¨æŒ‚ç€çš„æŒ‰é’®ç•™å‡ºçš„å®‰å…¨è·ç¦»
    
    // è®¡ç®—æœ€ç»ˆ Y åæ ‡
    let yOffset = screenH - (modalBaseHeight * targetScale) - buttonSpace;

    // é˜²æ­¢å¤ªé ä¸Š (å¦‚æœå±å¹•ç‰¹åˆ«çŸ®ï¼Œå°±é¡¶æ ¼æ˜¾ç¤º)
    if (yOffset < 60) yOffset = 60; 

    // D. åº”ç”¨å˜æ¢
    // è®¾å®šåŸºç‚¹ä¸ºã€å·¦ä¸Šè§’ã€‘ï¼Œè¿™æ · translate çš„è®¡ç®—æœ€ç›´è§‚
    modalWin.style.transformOrigin = 'top left';
    modalWin.style.transform = `translate(${xOffset}px, ${yOffset}px) scale(${targetScale})`;
    
    // E. å½’é›¶åŸºç¡€åæ ‡
    modalWin.style.left = '0';
    modalWin.style.top = '0';
    modalWin.style.margin = '0';
}

    // ç›‘å¬ï¼šç”±ä»¥ä¸‹æƒ…å†µè§¦å‘ç¼©æ”¾è®¡ç®—
    // A. çª—å£å¤§å°æ”¹å˜æ—¶ (æ—‹è½¬å±å¹•)
    window.addEventListener('resize', fitModalToMobile);
    
    // B. æ‰“å¼€äººç‰©å¼¹çª—æ—¶ (æŒ‚è½½åˆ°åŸæ¥çš„ openCharModal å‡½æ•°é‡Œ)
    // è¯·æ‚¨æ‰‹åŠ¨å» openCharModal å‡½æ•°çš„ã€æœ€åä¸€è¡Œã€‘ï¼ŒåŠ ä¸Š fitModalToMobile(); 
    // æˆ–è€…ç”¨ä¸‹é¢çš„ä»£ç è‡ªåŠ¨æŒ‚è½½ï¼š
    const _originalOpenChar = openCharModal;
    openCharModal = function(key) {
        _originalOpenChar(key); // æ‰§è¡ŒåŸæ¥çš„é€»è¾‘
        setTimeout(fitModalToMobile, 0); // ç«‹åˆ»æ‰§è¡Œç¼©æ”¾
    };

// ==============================================================
    // [ç»ˆæç¨³å®šç‰ˆ] 3D äº¤äº’ (å¸¦é˜²æŠ– + æŒ‰é’®å±è”½)
    // ==============================================================

    // å…¨å±€çŠ¶æ€
    let touchStartX = 0;
    let touchStartY = 0;
    let isTouching = false;

    // --- 1. è§¦æ‘¸å¼€å§‹ ---
    document.addEventListener('touchstart', function(e) {
        if (!bqcModal.classList.contains('active')) return;
        
        // ã€å±è”½æœºåˆ¶ã€‘å¦‚æœç‚¹çš„æ˜¯æŒ‰é’®ï¼Œç›´æ¥å¿½ç•¥ï¼Œä¸å¼€å¯ 3D æ¨¡å¼
        if (e.target.closest('.nav-btn-char') || e.target.closest('.nav-controls')) {
            isTouching = false;
            return;
        }

        const touch = e.touches[0];
        touchStartX = touch.clientX;
        touchStartY = touch.clientY;
        isTouching = true;
    }, { passive: false });

    // --- 2. è§¦æ‘¸ç§»åŠ¨ (æ‰‹æœºç«¯) ---
    document.addEventListener('touchmove', function(e) {
        // å¦‚æœæ²¡æ¿€æ´»ï¼Œæˆ–è€…åˆšæ‰ç‚¹çš„æ˜¯æŒ‰é’®ï¼Œå°±å•¥ä¹Ÿä¸å¹²
        if (!bqcModal.classList.contains('active') || !isTouching) return;
        if(e.cancelable) e.preventDefault(); 

        // ã€å±è”½æœºåˆ¶ã€‘å†æ¬¡æ£€æŸ¥ï¼šå¦‚æœæ‰‹æŒ‡åˆ’åˆ°äº†æŒ‰é’®ä¸Šï¼Œç«‹åˆ»åœæ­¢æ—‹è½¬
        if (e.target.closest('.nav-btn-char')) return;

        const tiltCard = document.getElementById('bqcTiltCard');
        const shineLayer = document.getElementById('bqcShine');
        const touch = e.touches[0];

        const deltaX = touch.clientX - touchStartX;
        const deltaY = touch.clientY - touchStartY;

        // ã€é˜²æŠ–æœºåˆ¶ã€‘å¦‚æœç§»åŠ¨è·ç¦»å°äº 3px (æ‰‹æŠ–)ï¼Œç›´æ¥å¿½ç•¥
        if (Math.abs(deltaX) < 3 && Math.abs(deltaY) < 3) return;

        // å‚æ•°é…ç½®
        const speed = 0.2; 
        const maxAngle = 20; 

        // è®¡ç®—è§’åº¦ (ä¸‹æ²‰æ¨¡å¼)
        let tiltX = deltaY * speed * -1; 
        let tiltY = deltaX * speed;      

        tiltX = Math.max(-maxAngle, Math.min(maxAngle, tiltX));
        tiltY = Math.max(-maxAngle, Math.min(maxAngle, tiltY));
        
        // åº”ç”¨å˜æ¢
        tiltCard.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg) scale(1.02)`;

        // åå…‰
        if(shineLayer) {
            const shineSpeed = 1.5; 
            const shineX = 50 + (deltaX * speed * shineSpeed);
            const shineY = 50 + (deltaY * speed * shineSpeed);
            shineLayer.style.backgroundPosition = `${shineX}% ${shineY}%`;
            
            const dist = Math.hypot(deltaX, deltaY);
            shineLayer.style.opacity = Math.min(dist / 200, 0.6); 
        }
    }, { passive: false });

    // --- 3. é¼ æ ‡ç§»åŠ¨ (ç”µè„‘ç«¯) ---
    document.addEventListener('mousemove', function(e) {
        if (!bqcModal.classList.contains('active')) return;

        // ã€å±è”½æœºåˆ¶ã€‘å¦‚æœé¼ æ ‡æ‚¬åœåœ¨æŒ‰é’®ä¸Šï¼Œä¸è§¦å‘å€¾æ–œ
        if (e.target.closest('.nav-btn-char') || e.target.closest('.nav-controls')) return;

        const tiltCard = document.getElementById('bqcTiltCard');
        const shineLayer = document.getElementById('bqcShine');
        
        const width = window.innerWidth;
        const height = window.innerHeight;
        
        const xPos = (e.clientX / width) - 0.5;
        const yPos = (e.clientY / height) - 0.5;

        const rotationLimit = 12; 
        const shineFactor = 20; 
        const shineRange = rotationLimit * shineFactor; 

        // è®¡ç®—è§’åº¦ (ä¸‹æ²‰æ¨¡å¼)
        const tiltX = yPos * -rotationLimit; 
        const tiltY = xPos * rotationLimit;  
        
        tiltCard.style.transform = `perspective(1000px) rotateX(${tiltX}deg) rotateY(${tiltY}deg) scale(1.02)`;

        const shineX = 50 + (xPos * shineRange); 
        const shineY = 50 + (yPos * shineRange); 

        if(shineLayer) {
            shineLayer.style.backgroundPosition = `${shineX}% ${shineY}%`;
            const dist = Math.hypot(xPos, yPos); 
            shineLayer.style.opacity = Math.min(dist * 1.5, 0.6);
        }
    });

    // --- 4. è§¦æ‘¸ç»“æŸ ---
    document.addEventListener('touchend', function(e) {
        if (!bqcModal.classList.contains('active')) return;
        isTouching = false;
        // ... (ä¿æŒä¹‹å‰çš„å›æ­£åŠ¨ç”»ä»£ç ) ...
        const tiltCard = document.getElementById('bqcTiltCard');
        const shineLayer = document.getElementById('bqcShine');
        tiltCard.style.transition = 'transform 0.6s cubic-bezier(0.23, 1, 0.32, 1)'; 
        tiltCard.style.transform = `perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)`;
        if(shineLayer) {
            shineLayer.style.transition = 'opacity 0.6s ease';
            shineLayer.style.opacity = 0;
        }
    });

/* =========================================================================
   PART 7: äººç‰©æ¡£æ¡ˆé¡µ è‡ªåŠ¨åŒ–æ„å»ºä¸å¯¼èˆªç³»ç»Ÿ (æ–°å¢)
   ========================================================================= */

// 1. é…ç½®æ•°æ®ï¼šå°†åŸæ¥åˆ†æ•£çš„ HTML ç»“æ„æ•´ç†æˆæ•°æ®
//    type: 'header' ç”Ÿæˆæ‰æ ‡é¢˜æ 
//    type: 'grid'   ç”Ÿæˆç¤¾å›¢ç½‘æ ¼
const charPageConfig = [
    // === ç¬¬ä¸€éƒ¨åˆ†ï¼šå­¦ç”Ÿç¤¾å›¢ ===
    { 
        type: 'header', 
        title: 'å­¦ç”Ÿç¤¾å›¢', 
        key: 'STUDENT', 
        color: '#4169E1' ,// çš‡å®¶è“
        poster: '' // <--- æ–°å¢
    },
    { 
        type: 'grid', 
        list: [
            { id: 'list-condensing-tower', name: 'å†·å‡å¡”', logo: Societies.TOWER },
            { id: 'list-bad-kids', name: 'ä¸è‰¯å°‘å¹´å®«', logo: Societies.BAD },
            { id: 'list-refinery', name: 'ç‚¼å‚', logo: Societies.FACTORY },
            { id: 'list-friendly-store', name: 'å‹è°Šç™¾è´§', logo: Societies.FRIEND },
            { id: 'list-plaza', name: 'èœ‚å±±å¹¿åœº', logo: Societies.PLAZA }
        ]
    },

    // === ç¬¬äºŒéƒ¨åˆ†ï¼šå“ˆå°¼ç¤¾å›¢ ===
    { 
        type: 'header', 
        title: 'å“ˆå°¼ç¤¾å›¢', 
        key: 'HANI', 
        color: '#FF1493', // æ·±ç²‰è‰²
        poster: ''
    },
    { 
        type: 'grid', 
        list: [
            { id: 'list-honey', name: 'å“ˆå°¼å“ˆå°¼', logo: Societies.HANI },
            { id: 'list-bukll', name: 'æ­¥å¯è¿è¿', logo: Societies.BUKLL },
            { id: 'list-mao', name: 'æ¯›æ¯›æ¯›æ¯›æ¯›', logo: Societies.MAO },
            { id: 'list-stars', name: 'ä¸‰å­æ˜Ÿ', logo: Societies.STARS },
            { id: 'list-radio', name: 'èœ‚å±±å¹¿æ’­ç¤¾', logo: Societies.RADIO },
            { id: 'list-soda4', name: 'è‹æ‰“å››', logo: Societies.SODA4 },
            { id: 'list-tuctuc', name: 'æ‰˜æ‰˜é£è½¦å…š', logo: Societies.TUCTUC }
            
            
        ]
    },

    // === ç¬¬ä¸‰éƒ¨åˆ†ï¼šç®¡ç†ç¤¾å›¢ ===
    { 
        type: 'header', 
        title: 'ç®¡ç†ç¤¾å›¢', 
        key: 'ADMIN', 
        color: '#ffffff' // é“¶ç°è‰²
    },
    { 
        type: 'grid', 
        list: [
            { id: 'list-white-building', name: 'ç™½æ¥¼', logo: Societies.WHITE },
            { id: 'list-union-1', name: 'ç¤¾è”ç»„ (ç¬¬ä¸€å±Š)', logo: Societies.UNION },
            { id: 'list-union-2', name: 'ç¤¾è”ç»„ (ç¬¬äºŒå±Š)', logo: Societies.UNION }
        ]
    }
];

// 2. æ¸²æŸ“ä¸»å‡½æ•°
// 3. JS é€»è¾‘é‡å†™ (ä¿®å¤ Logo æ¢å›åœ†ç‚¹)
// === [ä¿®å¤å®Œæ•´ç‰ˆ] æ¸²æŸ“ä¸»å‡½æ•° ===
function renderCharPage() {
    const root = document.getElementById('char-root-container');
    const menuList = document.getElementById('char-jump-list');
    if (!root || !menuList) return;

// === ã€æ–°å¢ã€‘åœ¨æœ€é¡¶éƒ¨åŠ å…¥äººç‰©é¡µçš„å¤§å¤´å›¾ ===
    // è¯·æ›¿æ¢ src ä¸ºä½ çš„çœŸå®å›¾ç‰‡è·¯å¾„
    let htmlStructure = `<img src="images/headers/page_header_char.png" class="header-poster-28" style="margin-bottom: 0px;">`;
    let menuHtml = '';

    // 1. éå†é…ç½®
    charPageConfig.forEach((item, index) => {
        
        // ==========================
        // æƒ…å†µ A: é‡åˆ°æ ‡é¢˜ (Header)
        // ==========================
        if (item.type === 'header') {
            
            // å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªï¼Œå…ˆé—­åˆä¸Šä¸€ä¸ªåˆ†ç»„çš„ </div>
            if (index > 0) {
                htmlStructure += `</div>`; 
            }
            
            // è®¡ç®—èƒŒæ™¯æ¸å˜
            const sectionBg = `linear-gradient(180deg, color-mix(in srgb, ${item.color}, transparent 90%) 0%, rgba(26,26,26,0) 100%)`;
            
            // å¼€å¯æ–°åˆ†ç»„å®¹å™¨
            htmlStructure += `<div class="char-group-section" id="group-${item.key}" style="background: ${sectionBg};">`;

            // 1. å…ˆæ”¾æ ‡é¢˜æ  (Sticky Bar)
            htmlStructure += `
                <div class="char-sticky-bar" 
                    id="char-anchor-${item.key}"
                    onclick="toggleCharMenu()"
                    style="border-left-color: ${item.color};">
                    <div style="width:12px; height:12px; background:${item.color}; border-radius:50%; box-shadow: 0 0 5px ${item.color};"></div>
                    <span class="char-bar-title">${item.title} â–¾</span>
                </div>
            `;
            
            // 2. å†æ”¾æµ·æŠ¥ (Poster) - ç´§è´´æ ‡é¢˜æ ä¸‹æ–¹
            if (item.poster) {
                htmlStructure += `<img src="${item.poster}" class="header-poster-28" alt="${item.title}">`;
            }

            
            // ç”Ÿæˆèœå•é¡¹
            menuHtml += `
                <div class="jump-btn" 
                    onclick="scrollToCharCat('${item.key}', event)"
                    style="border-left-color: ${item.color}; text-align:left; display:flex; align-items:center; gap:10px;">
                    <div style="width:10px; height:10px; background:${item.color}; border-radius:50%;"></div>
                    <span style="color:#fff; font-weight:bold;">${item.title}</span>
                </div>
            `;
        }

        // ==========================
        // æƒ…å†µ B: é‡åˆ°ç½‘æ ¼ (Grid)  <--- ä½ ä¹‹å‰æ¼æ‰äº†è¿™ä¸€å¤§æ®µï¼
        // ==========================
        if (item.type === 'grid') {
            // style="padding-top: 0;" æ˜¯ä¸ºäº†è®©ç½‘æ ¼ç´§è´´ä¸Šé¢çš„æµ·æŠ¥ï¼Œä¸è¦æœ‰ç¼éš™
            htmlStructure += `<div class="archive-block" style="padding-top: 0;"><div class="society-grid">`;
            
            item.list.forEach(soc => {
                // å“ˆå°¼ç¤¾å›¢ç‰¹æ®Š ID å¤„ç†
                const haniId = (soc.id === 'list-honey') ? 'id="society-card-honeyhoney"' : '';
                
                htmlStructure += `
                    <div class="society-card" ${haniId}>
                        <div class="society-header">
                            <div class="society-logo"><img src="${soc.logo}" style="width:100%; height:100%; object-fit:contain;"></div>
                            <div class="society-name">${soc.name}</div>
                        </div>
                        <div class="char-list">
                            <div id="${soc.id}"></div>
                        </div>
                    </div>
                `;
            });

            htmlStructure += `</div></div>`; 
        }
    });

    // å¾ªç¯ç»“æŸï¼Œé—­åˆæœ€åä¸€ä¸ªåˆ†ç»„çš„ div
    htmlStructure += `</div>`;

    // 2. å°†ç”Ÿæˆçš„ HTML æ³¨å…¥é¡µé¢
    root.innerHTML = htmlStructure;
    menuList.innerHTML = menuHtml;

    // 3. å¼€å§‹å¡«å……å…·ä½“çš„äººç‰©å¡ç‰‡
    fillCharLists();
}

// === [å‡çº§ç‰ˆ] å¡«å……äººç‰©å¡ç‰‡ï¼šæ”¯æŒç‚¹å‡»é” (clickable) ===
// === [æœ€çµ‚æ•´åˆç‰ˆ] å¡«å……äººç‰©å¡ç‰‡ï¼šåŒ…å«ç¦æ­¢å¸­ä½ã€å³å´æ¤…å­ã€é»æ“Šé–ã€ç€‘å¸ƒæµé©é… ===
// === [ä¿®å¾©æ•´åˆç‰ˆ] å¡«å……äººç‰©å¡ç‰‡ï¼šæ”¯æŒéš±è—å½©æ¢ã€ç¦æ­¢åœ–æ¨™ã€é»æ“Šé– ===
function fillCharLists() {
    for (const [id, keys] of Object.entries(lists)) {
        const container = document.getElementById(id);
        if (!container) continue;

        container.innerHTML = '';

        keys.forEach(key => {
            const d = charData[key];
            if (!d) return;

            const card = document.createElement('div');
            const kingClass = d.isKing === true ? ' is-king' : '';
            card.className = 'char-card' + kingClass;

            // --- 1. é¡è‰²èˆ‡é‚Šæ¡†è™•ç† (è§£æ±ºæ¥µç°¡æ¨¡å¼ä¸é¡¯ç¤ºå½©æ¢) ---
            const dColor = d.color || '#666'; // é˜²éŒ¯ï¼šå¦‚æœæ²’è¨­é¡è‰²å‰‡é»˜èªç°è‰²
            
            if (d.isVacant) {
                // ã€æ ¸å¿ƒä¿®æ”¹ã€‘æ¥µç°¡æ¨¡å¼ï¼šå¾¹åº•å»æ‰å·¦å´é‚Šæ¡†ç·š
                card.style.borderLeft = 'none';
                card.style.setProperty('--hover-color', 'transparent');
            } else {
                // æ­£å¸¸æ¨¡å¼ï¼šè¨­ç½®å½©æ¢
                let hoverColor = dColor;
                if (dColor.includes('gradient')) {
                    const match = dColor.match(/#[a-fA-F0-9]{6}/);
                    if (match) hoverColor = match[0];
                    card.style.borderImage = dColor + ' 1';
                    card.style.borderLeftWidth = '6px';
                    card.style.borderLeftStyle = 'solid';
                } else {
                    card.style.borderLeftColor = dColor;
                }
                card.style.setProperty('--hover-color', hoverColor);
            }

            // --- 2. é»æ“Šèˆ‡äº¤äº’æ§åˆ¶ ---
            const canClick = d.clickable !== false;
            if (canClick) {
                card.onclick = () => openCharModal(key);
                card.style.cursor = 'pointer';
            } else {
                card.onclick = null;
                card.style.cursor = 'default';
                card.style.setProperty('--hover-color', 'transparent');
                card.style.transition = 'none';
                card.style.pointerEvents = 'none'; // ç¦æ­¢æ‡¸æµ®ç‰¹æ•ˆ
            }

            // --- 3. ç”Ÿæˆæ¤…å­èˆ‡ç¦æ­¢åœ–æ¨™ (æ–œæ§“ç‰ˆ) ---
            const chairsList = d.chairs || [];
            let chairsHtml = '';
            chairsList.forEach(color => {
                const isForbidden = d.isChairForbidden === true;
                const forbiddenMark = isForbidden ? `<div class="forbidden-mark">${forbiddenSvg}</div>` : '';
                chairsHtml += `
                    <div class="chair-icon chair-${color}" style="position: relative;">
                        ${chairSvg}
                        ${forbiddenMark}
                    </div>`;
            });

            // --- 4. ç”Ÿæˆå¡ç‰‡ HTML å…§å®¹ ---
            if (d.isVacant) {
                // [æ¨£å¼ A] æš«ç¼ºå¸­ä½
                card.innerHTML = `
                    <div class="chair-container">${chairsHtml}</div>
                    <div class="char-card-info" style="width: 100%; align-items: center; justify-content: center; text-align: center; padding: 0;">
                        <div class="cc-nickname" style="font-size: 20px; letter-spacing: 2px; opacity: 0.7; ${dColor.includes('gradient') ? 'background:'+dColor+';-webkit-background-clip:text;color:transparent' : 'color:'+dColor}">
                            ${d.name}
                        </div>
                    </div>
                `;
            } else {
                // [æ¨£å¼ B] æ­£å¸¸äººç‰©å¡
                card.innerHTML = `
                    <div class="crown-badge">â™›</div>
                    <div class="chair-container">${chairsHtml}</div>
                    <div class="char-card-img">
                        <img src="${d.cardImage || ''}" onerror="this.style.display='none'">
                    </div>
                    <div class="char-card-info">
                        <div class="cc-names">
                            <span class="cc-nickname" style="${dColor.includes('gradient') ? 'background:'+dColor+';-webkit-background-clip:text;color:transparent' : 'color:'+dColor}">${d.name}</span>
                            <span class="cc-realname">${d.real !== '-' ? d.real : ''}</span>
                        </div>
                        <div class="cc-job">${d.job}</div>
                        <div class="cc-school">${d.school}</div>
                    </div>`;
            }
            container.appendChild(card);
        });
    }
}

// 4. èœå•äº¤äº’é€»è¾‘
function toggleCharMenu() {
    const menu = document.getElementById('char-jump-menu');
    if(menu) menu.classList.toggle('active');
}

// === [ç»ˆæä¿®æ­£] èœå•è·³è½¬é€»è¾‘ ===
function scrollToCharCat(key, event) {
    // 1. é˜»æ­¢ç‚¹å‡»ç©¿é€
    if (event) event.stopPropagation();
    
    // 2. å…³é—­èœå•
    toggleCharMenu();
    
    const container = document.getElementById('view-chars'); // æ»šåŠ¨å®¹å™¨
    
    // ã€æ ¸å¿ƒä¿®æ”¹ç‚¹ã€‘
    // ä»¥å‰æˆ‘ä»¬æ‰¾çš„æ˜¯ `char-anchor-${key}` (é‚£ä¸ªä¼šåŠ¨çš„æ ‡é¢˜æ )
    // ç°åœ¨æˆ‘ä»¬æ‰¾ `group-${key}` (é‚£ä¸€æ•´å—çš„çˆ¶å®¹å™¨)
    const targetGroup = document.getElementById(`group-${key}`);
    
    if (container && targetGroup) {
        // 3. è®¡ç®—ä½ç½®
        // offsetTop æ˜¯æŒ‡ï¼šè¿™ä¸ªåˆ†ç»„å®¹å™¨çš„é¡¶éƒ¨ï¼Œè·ç¦»çˆ¶å®¹å™¨é¡¶éƒ¨çš„è·ç¦»
        // è¿™å°±æ˜¯æœ€åŸå§‹ã€æœ€çœŸå®çš„ç‰©ç†ä½ç½®ï¼Œä¸å— sticky è§†è§‰æ¬ºéª—å½±å“
        let targetPos = targetGroup.offsetTop;

        // ã€å¾®è°ƒã€‘
        // å¦‚æœå®¹å™¨æœ‰ padding-top (æ¯”å¦‚ 40px)ï¼Œç›´æ¥æ»šåˆ° 0 å¯èƒ½ä¼šè§‰å¾—å¤ªé ä¸Š
        // æˆ–è€…å› ä¸º sticky bar æœ‰é«˜åº¦ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›ç¨å¾®å¾€ä¸Šå¤šæ»šä¸€ç‚¹ç‚¹æˆ–è€…æ­£å¥½å¯¹é½
        // è¿™é‡Œä¸åšå‡æ³•ï¼Œé€šå¸¸ç›´æ¥æ»šåˆ° offsetTop å°±æ˜¯â€œç²¾å‡†å¯¹å…¶é¡¶éƒ¨â€
        // å¦‚æœä½ è§‰å¾—å¤ªé¡¶äº†ï¼Œå¯ä»¥å†™: targetPos - 20;
        
        // 4. æ‰§è¡Œæ»šåŠ¨
        container.scrollTo({
            top: targetPos, 
            behavior: "smooth"
        });
    }
}

// 5. åˆå§‹åŒ–
// é¡µé¢åŠ è½½å®Œåæ‰§è¡Œ


// ã€æ³¨æ„ã€‘å¦‚æœä½ åŸæ¥çš„ä»£ç é‡Œæœ‰ `for (const [id, keys] of Object.entries(lists))` è¿™ä¸€æ®µè‡ªåŠ¨æ‰§è¡Œçš„ä»£ç ï¼Œ
// è¯·å°†å…¶æ³¨é‡Šæ‰æˆ–åˆ é™¤ï¼Œå› ä¸ºç°åœ¨ç”± `renderCharPage` -> `fillCharLists` ç»Ÿä¸€æ¥ç®¡äº†ã€‚

/* === [ä¿®æ­£] ç‚¹å‡»ç©ºç™½å¤„å…³é—­é¡¶éƒ¨å¯¼èˆªèœå• === */
document.addEventListener('click', function(event) {
    const navMenu = document.getElementById('nav-menu');
    // ã€å…³é”®ä¿®æ­£ã€‘ï¼šç±»åå¿…é¡»ä¸ HTML ä¸­çš„ nav-toggle-btn ä¿æŒä¸€è‡´
    const navToggle = document.querySelector('.nav-toggle-btn');

    if (!navMenu || !navMenu.classList.contains('open')) return;

    // å¦‚æœç‚¹å‡»çš„ç›®æ ‡ä¸æ˜¯èœå•å†…éƒ¨ï¼Œä¸”ä¸æ˜¯é‚£ä¸ªæ±‰å ¡æŒ‰é’®ï¼Œå°±å…³é—­
    if (!navMenu.contains(event.target) && !navToggle.contains(event.target)) {
        navMenu.classList.remove('open');
        // å¦‚æœä½ æœ‰é®ç½©å±‚ï¼Œè®°å¾—åœ¨è¿™é‡Œä¹ŸæŠŠé®ç½©å±‚å»æ‰
    }
});


// --- 1. æ–‘ä¸˜æ™¯è‰²æ•¸æ“šå­—å…¸ ---æ™¯è‰²ä¸»é¢˜è‰²
const bqViewData = {
    overview: { poster: "images/BQviews/posters/0-1.png" },
    chapters: [
        {
            id: 1, title: "ç‚¼å‚", color: "#daf08e",
            bio: "ç…‰å» æ˜¯æ–‘ä¸˜ä¸–ç•Œä¸­æœ€ç‚ºç¹å¿™çš„è³‡æºåŠ å·¥å€ã€‚é€™è£¡çµ‚æ—¥è¢«æš—ç´…è‰²çš„ç…™é›²ç± ç½©ï¼Œå·¨å¤§çš„é‹¼éµç…™å›ªçŸ—ç«‹åœ¨è’æ¼ ä¹‹ä¸­ã€‚å­¸ç”Ÿå€‘åœ¨é€™è£¡æ”¶é›†ä¸¦è™•ç†æ®˜ç•™çš„æ•¸æ“šåˆ‡ç‰‡ï¼Œæ˜¯ç²å–é«˜éšå±¬æ€§å¡Šçš„é‡è¦åœ°é»ã€‚é›–ç„¶ç’°å¢ƒæƒ¡åŠ£ï¼Œä½†é€™è£¡å»æœ‰ä¸€ç¨®å·¥æ¥­å»¢åœŸç‰¹æœ‰çš„æ®˜ç¼ºç¾æ„Ÿã€‚",
            photos: 15 ,// è‡ªå‹•ç”Ÿæˆ 01-12 çš„ç·¨è™Ÿ
            logo: Societies.FACTORY,
        },
        {
            id: 2, title: "å†·å‡å¡”", color: "#f3c14a",
            bio: "å†·å‡å¡”æ˜¯èº²é¿æ²™æš´èˆ‡é¨·äº‚çš„é¿é¢¨æ¸¯ã€‚å·¨å¤§çš„é‡‘å±¬å¡”èº«å…§éƒ¨æ¡ç”¨äº†ç‰¹æ®Šçš„å†·å»çµæ§‹ï¼Œæ°£æº«å§‹çµ‚ä¿æŒåœ¨å®œäººçš„22åº¦ã€‚å¡”å…§çš„è¿´å»Šç›¤æ—‹è€Œä¸Šï¼Œæ¯ä¸€å±¤éƒ½å±…ä½è‘—å°‹æ±‚å’Œå¹³çš„å­¸ç”Ÿã€‚å¾å¡”é ‚æœ›å»ï¼Œå¯ä»¥ä¿¯ç°æ•´å€‹æ–‘ä¸˜çš„é»ƒæ˜æ™¯è§€ã€‚",
            photos: 12,
            logo: Societies.TOWER,
        
        },
        {
            id: 3, title: "å†²æ±Ÿå¸‚ç¬¬äº”ä¸­å­¦", color: "#345ca1",
            bio: "è¢«å®Œæ•´è¤‡è£½é€²æ–‘ä¸˜çš„æ ¡å€ã€‚é€™è£¡ä¿ç•™äº†ç¾å¯¦ä¸–ç•Œä¸­äº”ä¸­çš„æ‰€æœ‰ç´°ç¯€ï¼šæ–‘é§çš„æ•™å­¸æ¨“ã€çˆ¬æ»¿è—¤è”“çš„ç±ƒçƒå ´ã€ä»¥åŠæ°¸é åœç•™åœ¨æ”¾å­¸å‰äº”åˆ†é˜çš„æ›é˜ã€‚é€™è£¡æ˜¯å­¸ç”Ÿå€‘æƒ…æ„Ÿçš„å¯„è¨—ä¹‹åœ°ï¼Œä¹Ÿæ˜¯å¤šå ´é—œéµè¡çªçš„çˆ†ç™¼é»ã€‚",
            photos: 12,
            logo: Schools.CHONGJIANG,
        },
        {
            id: 4, title: "èœ‚å±±å¹¿åœº", color: "#eb9653",
            bio: "æ–‘ä¸˜æœ€å¤§çš„äº¤æ˜“èˆ‡é›†æœƒä¸­å¿ƒã€‚å·¨å¤§çš„åœ“å½¢å»£å ´ä¸­å¿ƒçŸ—ç«‹è‘—å“ˆå°¼çš„é›•åƒï¼Œå‘¨åœéå¸ƒè‘—å‹èª¼ç™¾è²¨çš„è‡ªå‹•è²©è³£æ©Ÿã€‚é€™è£¡æ˜¯å„ç¨®æƒ…å ±æµè½‰çš„ä¸­å¿ƒï¼Œä¹Ÿæ˜¯æ‰€æœ‰äººé€²å…¥æ–‘ä¸˜çš„ç¬¬ä¸€ç«™ã€‚",
            photos: 15,
            logo: Societies.PLAZA,
        }
    ]
};

// --- 2. æ¸²æŸ“å‡½æ•¸ ---
function renderBqScenery() {
    const overviewRoot = document.getElementById('bqv-overview-wrap');
    const dynamicRoot = document.getElementById('bqv-dynamic-root');
    
    const jumpList = document.getElementById('bqv-jump-list');
    
    
    if(!dynamicRoot) return;

    // A. æ¸²æŸ“ç¸½è¦½ (ç„¡ç« ç¯€æ¬„ï¼Œ16:9æµ·å ±)
    overviewRoot.innerHTML = `<img src="${bqViewData.overview.poster}" class="bqv-poster" alt="Overview">`;

    let html = '';
    let menuHtml = '';

    // B. éæ­·æ¸²æŸ“ 4 å€‹æ¿å¡Š
    bqViewData.chapters.forEach(ch => {
        // æ¸²æŸ“å°èˆªèœå–®
        menuHtml += `<div class="jump-btn" onclick="scrollToBqvCat('${ch.id}', event)" style="border-left-color: ${ch.color}; text-align:left; padding-left:20px;">
            <span style="color:${ch.color}">${ch.title}</span>
        </div>`;


// æ³¨æ„ï¼štransparent 85% å¤§çº¦ç­‰äº hex çš„ 22 (çº¦13%ä¸é€æ˜åº¦)
const sectionBg = `linear-gradient(180deg, color-mix(in srgb, ${ch.color}, transparent 30%) 0%, rgba(26,26,26,0) 100%)`;
        // --- 2. ä¿®æ”¹ï¼šåœ¨ div æ¨™ç±¤è£¡æ³¨å…¥é€™å€‹ style="background: ..." ---
        html += `
        <div class="bqv-group-section" id="bqv-group-${ch.id}" style="background: ${sectionBg};">
            
            <div class="bqv-sticky-bar" onclick="toggleBqvMenu()" style="border-left-color: ${ch.color}">
                <div style="width:12px; height:12px; background:${ch.color}; border-radius:50%; margin-right:10px;"></div>
                <span class="bqv-bar-title" style="color:#fff">${ch.title} â–¾</span>
            </div>
            

            <img src="images/BQviews/posters/${ch.id}-1.png" class="bqv-poster">

            <div class="bqv-content-wrap">
                <div class="bqv-glass-card">${ch.bio}</div>

                <div class="bqv-photo-grid">`;
                
                // å¾ªç’°ç”Ÿæˆ 12 å¼µç…§ç‰‡
                for(let i=1; i<=ch.photos; i++) {
                    const num = i < 10 ? '0'+i : i;
                    // è¨ˆç®—éš¨æ©Ÿå‚¾æ–œ (ä»¥ç´¢å¼•ç‚ºç¨®å­ä¿è­‰æ¸²æŸ“çµæœä¸€è‡´)
                    const tiltLimit = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--bqv-tilt-limit')) || 5;
                    const seed = (ch.id * 100) + i;
                    const tilt = ((Math.sin(seed) * tiltLimit)).toFixed(2);
                    
// === [ä¿®æ­£ç‰ˆ] åŠ ä¸Š onclick é»æ“Šäº‹ä»¶ ===
html += `
<div class="bqv-photo-item" 
    style="transform: rotate(${tilt}deg)" 
    onclick="openBqvModal(${ch.id}, ${i})">
    <img src="images/BQviews/photographs/${ch.id}-${num}.png" loading="lazy">
</div>`;
                }

        html += `</div></div>
        </div>`;
    });

    dynamicRoot.innerHTML = html;
    jumpList.innerHTML = menuHtml;
}

// --- 3. äº¤äº’å‡½æ•¸ ---
function toggleBqvMenu() {
    const menu = document.getElementById('bqv-jump-menu');
    menu.classList.toggle('active');
}

function scrollToBqvCat(id, e) {
    if(e) e.stopPropagation();
    toggleBqvMenu();
    const target = document.getElementById(`bqv-group-${id}`);
    const container = document.getElementById('view-scenery');
    if(container && target) {
        container.scrollTo({ top: target.offsetTop, behavior: "smooth" });
    }
}

// å•Ÿå‹•æ¸²æŸ“
setTimeout(renderBqScenery, 300);

// --- æ™¯è‰²æµ®çª—å…¨å±€çŠ¶æ€ ---
let bqvCurrentChapter = null;
let bqvCurrentIndex = 1;

// ä¿®æ”¹ä¹‹å‰çš„æ¸²æŸ“å‡½æ•°ï¼Œåœ¨ç…§ç‰‡ç”Ÿæˆæ—¶ç»‘å®šç‚¹å‡»äº‹ä»¶
// è¯·æ‰¾åˆ°ä¹‹å‰ renderBqScenery é‡Œçš„ç…§ç‰‡å¾ªç¯ï¼Œæ”¹ä¸ºï¼š
/*
    html += `
    <div class="bqv-photo-item" style="transform: rotate(${tilt}deg)" onclick="openBqvModal(${ch.id}, ${i})">
        <img src="images/BQviews/photographs/${ch.id}-${num}.png" loading="lazy">
    </div>`;
*/

function openBqvModal(chapterId, index) {
    bqvCurrentChapter = bqViewData.chapters.find(c => c.id === chapterId);
    bqvCurrentIndex = index;
    
    updateBqvModalContent();
    document.getElementById('bqvModal').style.display = 'flex';
}

function updateBqvModalContent() {
    const num = bqvCurrentIndex < 10 ? '0' + bqvCurrentIndex : bqvCurrentIndex;
    const imgSrc = `images/BQviews/photographs/${bqvCurrentChapter.id}-${num}.png`;
    
    // æ›´æ–°å¤§å›¾
    document.getElementById('bqv-modal-img').src = imgSrc;
    // æ›´æ–°å·¦ä¸Šè§’ Logo å’Œ åå­—
    document.getElementById('bqv-modal-logo').src = bqvCurrentChapter.logo || '';

}

function navigateBqv(dir) {
    if (!bqvCurrentChapter) return;
    
    bqvCurrentIndex += dir;
    
    // å¾ªç¯é€»è¾‘ï¼š1-12 å¾ªç¯
    if (bqvCurrentIndex > bqvCurrentChapter.photos) bqvCurrentIndex = 1;
    if (bqvCurrentIndex < 1) bqvCurrentIndex = bqvCurrentChapter.photos;
    
    updateBqvModalContent();
}

function closeBqvModal() {
    document.getElementById('bqvModal').style.display = 'none';
    document.getElementById('bqv-modal-img').src = '';
}

// éšæœºå€¾æ–œé€»è¾‘ï¼šä½¿ç”¨ Math.sin é…åˆç§å­ï¼Œä¿è¯æ¯æ¬¡åˆ·æ–°å€¾æ–œè§’åº¦ä¸€è‡´ä½†ä¸å•è°ƒ
function generatePhotos(chId) {
    let pte = '';
    const limit = 2; // å¯è°ƒé™åˆ¶åº¦æ•°
    for(let i=1; i<=12; i++) {
        const num = i < 10 ? '0'+i : i;
        const tilt = (Math.sin(chId * 10 + i) * limit).toFixed(2);
        pte += `
        <div class="bqv-photo-item" style="transform: rotate(${tilt}deg)" onclick="openBqvModal(${chId}, ${i})">
            <img src="images/BQviews/photographs/${chId}-${num}.png">
        </div>`;
    }
    return pte;
}

// --- [æ ¸å¿ƒä¿®å¤] é”®ç›˜æ”¯æŒï¼šEsc é€€å‡º & å·¦å³é”®ç¿»é¡µ ---
document.addEventListener('keydown', function(e) {
    const bqvModal = document.getElementById('bqvModal');
    if (bqvModal.style.display === 'flex') {
        if (e.key === 'Escape') closeBqvModal();
        if (e.key === 'ArrowLeft') navigateBqv(-1);
        if (e.key === 'ArrowRight') navigateBqv(1);
    }
});

// ä¿®æ”¹ç‚¹å‡»é®ç½©å±‚å…³é—­çš„é€»è¾‘
document.getElementById('bqvModal').addEventListener('click', function(e) {
    // é€»è¾‘ï¼šå¦‚æœç‚¹çš„æ˜¯é®ç½©å±‚æœ¬ä½“ (this)
    // æˆ–è€…ç‚¹çš„æ˜¯åŒ…è£¹å›¾ç‰‡çš„é‚£ä¸ªé€æ˜ç›’å­å®¹å™¨ (classList.contains('bqv-modal-content'))
    // å°±å…³é—­æµ®çª—ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ç‚¹å‡»å›¾ç‰‡ä»¥å¤–çš„ä»»ä½•â€œé˜´å½±/ç©ºç™½â€åŒºåŸŸéƒ½èƒ½å…³é—­ã€‚
    if (e.target === this || e.target.classList.contains('bqv-modal-content')) {
        closeBqvModal();
    }
});
// === [æ–°å¢] å¡ç‰Œè¡¨æ ¼ä¸“ç”¨è·³è½¬ (åªæ»šåŠ¨ï¼Œä¸å¼¹èœå•) ===
function jumpToCardCategory(key) {
    // æ‰¾åˆ°å¯¹åº”çš„åˆ†ç±»åŒºå— (id="bqc-group-RW" ç­‰)
    const target = document.getElementById(`bqc-group-${key}`);
    if (target) {
        // å¹³æ»‘æ»šåŠ¨åˆ°è¯¥ä½ç½®
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}

/* ================= å‰§æƒ…å¤‡å¿˜å½• (Markdown + Mermaid ä¿®å¤ç‰ˆ) ================= */



// 2. é…ç½® Marked æ‹¦æˆªå™¨ (å…³é”®ä¿®å¤ï¼)
const renderer = new marked.Renderer();
// é‡å†™ä»£ç å—çš„è§£æé€»è¾‘
renderer.code = function(code, language) {
    // å¦‚æœè¯­è¨€æ ‡è®°æ˜¯ 'mermaid'
    if (language === 'mermaid') {
        // ç›´æ¥è¿”å› divï¼Œé‡Œé¢çš„ code ä¸åšä»»ä½•è½¬ä¹‰å¤„ç†ï¼
        return '<div class="mermaid">' + code + '</div>';
    }
    // å…¶ä»–è¯­è¨€ï¼ˆå¦‚ js, cssï¼‰ç…§å¸¸é«˜äº®æˆ–åŒ…è£¹
    return '<pre><code class="language-' + language + '">' + code + '</code></pre>';
};

// 3. åœ¨è¿™é‡Œç²˜è´´ä½ çš„ Notion å†…å®¹
//![å°å­©çš„æ’å›¾](images/story/photo01.png)ã€æ’å…¥å›¾ç‰‡çš„æ ¼å¼ã€‘
const notionContent = `

`;

// 4. æ¸²æŸ“å‡½æ•°
function renderStory() {
    const container = document.getElementById('story-render-area');
    const tocContainer = document.getElementById('story-toc-list');
    
    if(!container) return;

    // A. è§£æ Markdown (ä¼ å…¥æˆ‘ä»¬å†™å¥½çš„ renderer)
    // è¿™æ · Mermaid ä»£ç å—å°±ä¼šè¢«â€œç‰¹èµ¦â€ï¼Œä¸ä¼šè¢«è½¬ä¹‰æˆä¹±ç 
    let html = marked.parse(notionContent, { renderer: renderer });
    
    container.innerHTML = html;

    // B. è®© Mermaid é‡æ–°å¯»æ‰¾å¹¶ç”»å›¾
    // åŠ ä¸ªå°å»¶æ—¶ï¼Œç¡®ä¿ DOM å·²ç»å®Œå…¨å¡è¿›å»äº†


    // C. ç”Ÿæˆç›®å½•
    generateTOC(container, tocContainer);
}

/* ================= å‰§æƒ…ç›®å½•ï¼šç‹¬å å±•å¼€ + ç²¾å‡†æœ«çº§é«˜äº®ç‰ˆ ================= */

/**
 * æ ¸å¿ƒé€»è¾‘è¯´æ˜ï¼š
 * 1. ç»“æ„åŒ–æ ‡é¢˜ï¼šå°† H2/H3 è‡ªåŠ¨å½’ç±»åˆ°æ‰€å±çš„ H1 ä¸‹ã€‚
 * 2. ç‹¬å å¼ç‚¹å‡»ï¼šç‚¹å‡»ä¸€çº§æ ‡é¢˜ä¼šå¼ºè¡Œå…³é—­å…¶ä»–å·²å±•å¼€çš„ç« èŠ‚ã€‚
 * 3. ç‹¬å å¼æ»šåŠ¨ï¼šæ»šåŠ¨åˆ°æŸä¸ªå­æ ‡é¢˜æ—¶ï¼Œçˆ¶ç« èŠ‚è‡ªåŠ¨å±•å¼€ï¼ŒåŒæ—¶å…³é—­å…¶ä»–ç« èŠ‚ã€‚
 * 4. æœ«çº§é«˜äº®ï¼šä¼˜å…ˆç»™ H2/H3 åŠ  .active ç±»ï¼Œå®ç°æœ€å°çº§åˆ«é«˜äº®ã€‚
 */

/* ================= å‰§æƒ…ç›®å½•ï¼šç‹¬å å±•å¼€ + ç²¾å‡†æœ«çº§é«˜äº® (ä¿®æ­£ç‰ˆ) ================= */

/* ================= åŠ‡æƒ…ç›®éŒ„ï¼šç¨ä½”å±•é–‹ + ç²¾æº–æœ«ç´šé«˜äº® (çµ‚æ¥µä¿®æ­£ç‰ˆ) ================= */

// åˆ‡æ¢æ‰‹æœºç›®å½•æ˜¾ç¤º
// ä¿®æ”¹å¾Œçš„åˆ‡æ›å‡½æ•¸
function toggleMobileTOC(show) {
    const modal = document.getElementById('mobile-toc-modal');
    if (modal) {
        if (show) {
            modal.classList.add('open');
        } else {
            modal.classList.remove('open');
        }
    }
}

function generateTOC(contentRoot, listRoot) {
    const scrollContainer = document.getElementById('view-story');
    const mobileListRoot = document.getElementById('mobile-toc-list');
    const mobileText = document.getElementById('mobile-toc-current-text');
    
    if(!listRoot || !contentRoot || !scrollContainer) return;
    
    listRoot.innerHTML = '';
    if(mobileListRoot) mobileListRoot.innerHTML = '';
    
    const allHeaders = Array.from(contentRoot.querySelectorAll('h1, h2, h3'));
    const groups = [];
    allHeaders.forEach((header, index) => {
        const id = 'story-ref-' + index;
        header.id = id;
        if (header.tagName === 'H1') {
            const subs = [];
            for (let j = index + 1; j < allHeaders.length; j++) {
                if (allHeaders[j].tagName === 'H1') break;
                subs.push(allHeaders[j]);
            }
            groups.push({ header, subs, index });
        }
    });

    // æ¸²æŸ“å‡½æ•°ï¼šåŒæ—¶å¤„ç† PC å’Œ æ‰‹æœºç‰ˆ
    function createTOCItems(targetList, isMobile = false) {
        groups.forEach(group => {
            const groupEl = document.createElement('div');
            groupEl.className = 'toc-group';
            groupEl.id = (isMobile ? 'm-' : '') + 'toc-group-' + group.index;

            const btn = document.createElement('button');
            btn.className = 'toc-h1-btn';
            btn.innerText = group.header.innerText;

            btn.onclick = (e) => {
                e.stopPropagation();
                if (group.subs.length === 0) {
                    scrollContainer.scrollTo({ top: group.header.offsetTop - 20, behavior: 'smooth' });
                    if(isMobile) toggleMobileTOC(false);
                } else {
                    const isOpen = groupEl.classList.contains('expanded');
                    document.querySelectorAll(isMobile ? '.mobile-toc-body .toc-group' : '.story-sidebar .toc-group').forEach(g => g.classList.remove('expanded'));
                    if (!isOpen) groupEl.classList.add('expanded');
                }
            };

            const subItemsDiv = document.createElement('div');
            subItemsDiv.className = 'toc-sub-items';

            group.subs.forEach(sub => {
                const link = document.createElement('a');
                link.className = `toc-link ${sub.tagName === 'H3' ? 'level-3' : 'level-2'}`;
                link.innerText = sub.innerText;
                link.dataset.targetId = sub.id; 
                link.onclick = (e) => {
                    e.preventDefault();
                    scrollContainer.scrollTo({ top: sub.offsetTop - 20, behavior: 'smooth' });
                    if(isMobile) toggleMobileTOC(false); // ç‚¹å‡»åå…³é—­
                };
                subItemsDiv.appendChild(link);
            });

            groupEl.appendChild(btn);
            if (group.subs.length > 0) groupEl.appendChild(subItemsDiv);
            targetList.appendChild(groupEl);
        });
    }

    createTOCItems(listRoot, false); // æ¸²æŸ“ PC ç‰ˆ
    if(mobileListRoot) createTOCItems(mobileListRoot, true); // æ¸²æŸ“æ‰‹æœºç‰ˆ

    // 4. é«˜äº®åŒæ­¥é€»è¾‘
    scrollContainer.onscroll = () => {
        let currentActive = null;
        const containerRect = scrollContainer.getBoundingClientRect();

        for (let i = 0; i < allHeaders.length; i++) {
            const rect = allHeaders[i].getBoundingClientRect();
            if (rect.top - containerRect.top < 150) {
                currentActive = allHeaders[i];
            } else { break; }
        }

        if (currentActive) {
            // æ›´æ–°æ‰‹æœºç«¯ Bar çš„æ–‡å­—
            if(mobileText) mobileText.innerText = currentActive.innerText;

            // æ¸…ç†æ—§çŠ¶æ€
            document.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
            document.querySelectorAll('.toc-group').forEach(g => g.classList.remove('active'));

            // å¤„ç†æ‰€æœ‰ç›®å½•çš„é«˜äº®ä¸æ‰‹é£ç´åŒæ­¥
            const activeIds = [currentActive.id];
            
            // é«˜äº®å°ç« èŠ‚
            const links = document.querySelectorAll(`.toc-link[data-target-id="${currentActive.id}"]`);
            links.forEach(l => {
                l.classList.add('active');
                const pG = l.closest('.toc-group');
                if(pG) {
                    pG.classList.add('active');
                    // åªæœ‰å½“å®ƒä¸å¤„äºå±•å¼€çŠ¶æ€æ—¶æ‰è‡ªåŠ¨å±•å¼€ï¼ˆæ‰‹é£ç´ï¼‰
                    if(!pG.classList.contains('expanded')) {
                        // æ‰¾åˆ°è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰ group
                        const root = pG.parentNode;
                        root.querySelectorAll('.toc-group').forEach(g => g.classList.remove('expanded'));
                        pG.classList.add('expanded');
                    }
                }
            });

            // å¦‚æœæ˜¯ H1 æ ‡é¢˜
            if (currentActive.tagName === 'H1') {
                const gIdx = currentActive.id.split('-').pop();
                const pcG = document.getElementById('toc-group-' + gIdx);
                const mobG = document.getElementById('m-toc-group-' + gIdx);
                [pcG, mobG].forEach(tg => {
                    if(tg) {
                        tg.classList.add('active');
                        tg.parentNode.querySelectorAll('.toc-group').forEach(g => g.classList.remove('expanded'));
                        tg.classList.add('expanded');
                    }
                });
            }
        }
        if(typeof checkScroll === 'function') checkScroll();
    };
}
/* === [æ–°å¢æ•´åˆ] å°èˆªæ¬„å…¨å±€é»æ“Šé‚è¼¯ === */
document.querySelector('.navbar').addEventListener('click', function(e) {
    if (e.target.closest('.nav-toggle-btn')) return; // å¦‚æœé»çš„æ˜¯æ¼¢å ¡ï¼Œä¸å›æ»¾

    const activeSection = document.querySelector('.view-section.active');
    if (activeSection) {
        activeSection.scrollTo({ top: 0, behavior: 'smooth' });
    }
});

/* === [æ–°å¢æ•´åˆ] é»æ“Šç©ºç™½è™•é—œé–‰èœå–® === */
document.addEventListener('click', function(event) {
    const mobileMenu = document.getElementById('mobileMenu');
    const navToggle = document.querySelector('.nav-toggle-btn');
    if (!mobileMenu || !mobileMenu.classList.contains('open')) return;
    if (!mobileMenu.contains(event.target) && !navToggle.contains(event.target)) {
        mobileMenu.classList.remove('open');
    }
});

// 1. é–‹é—œç¸½è¦½èœå–®
function toggleOvMenu() {
    const menu = document.getElementById('ov-jump-menu');
    if (menu) menu.classList.toggle('active');
}

// 2. èœå–®è·³è½‰é‚è¼¯
function scrollToOv(key, event) {
    if (event) event.stopPropagation();
    toggleOvMenu();
    
    const container = document.getElementById('view-overview');
    const target = document.getElementById(`ov-${key}`); // å°æ‡‰ renderOverview è£¡çš„ ID
    
    if (container && target) {
        container.scrollTo({
            top: target.offsetTop,
            behavior: "smooth"
        });
    }
}

function renderOverview() {
    const root = document.getElementById('view-overview');
    if (!root) return;

    let html = `<img src="${OverviewAssets.banner}" class="ov-header-banner">`;

    // å¯¼æ¸¸ç« èŠ‚å¼€å§‹
    const guideColor = 'var(--tab-overview)';
    const guideBg = `linear-gradient(180deg, color-mix(in srgb, ${guideColor}, transparent 90%) 0%, rgba(26,26,26,0) 100%)`;
    
    html += `<div class="ov-section ov-section-full" id="ov-guide" style="background: ${guideBg}; margin-top: 0;">
        <div class="bqc-chapter-bar" onclick="toggleOvMenu()" style="border-left-color: ${guideColor}; margin-top: 0 !important;">
            <div style="width:12px; height:12px; background:${guideColor}; border-radius:50%; box-shadow: 0 0 5px ${guideColor};"></div>
            <span class="bqc-bar-title" style="color:#fff">å¼€å§‹å§ï¼ â–¾</span>
        </div>
        <div class="guide-container">`;

    // è¾…åŠ©ï¼šç”ŸæˆæŠ½å±‰HTML
    const makeDrawer = (side, data) => `
<div class="drawer-wrapper drawer-back drawer-${side}">
        <img src="${data.bottom}" class="comment-img-bottom">
    </div>
    <div class="drawer-wrapper drawer-front drawer-${side}">
        <img src="${data.top}" class="comment-img-top">
    </div>
`;

    // 1. æ¸²æŸ“å‰ä¸¤è¡Œ
    OverviewAssets.guide.rows.forEach(row => {
        html += `
        <div class="guide-row" data-animate="guide">
            ${makeDrawer('left', row.left)}
            <div class="equip-unit">
                <img src="${row.main.img}" class="equip-img">
                <div class="equip-glass-card">
                    <div class="equip-card-header">${row.main.title}</div>
                    <div class="equip-card-body">${row.main.desc}</div>
                </div>
            </div>
            ${makeDrawer('right', row.right)}
        </div>`;
    });

// 2. æ¸²æŸ“ç¬¬ä¸‰è¡Œå¯¹æ¯” (å·²åˆ é™¤æ˜¾æ‘†å›¾)
const comp = OverviewAssets.guide.comparison;
html += `
<div class="guide-row row-comparison" data-animate="guide"> ${makeDrawer('left', comp.left)}
    <div class="justice-grid" style="width:70%;">
            <div class="justice-unit" style="position:relative;">
                <div class="equip-glass-card" style="width:100% !important;">
                    <div class="equip-card-header">å‘Šè¯‰ä½ åªèƒ½è¦è¿™ä¹ˆç©</div>
                    <div class="equip-card-body" style="text-align:center; padding: 40px 20px !important;">
                        <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px;">åŠ å…¥ç¤¾å›¢ä¸€èµ·æˆ˜æ–—</div>
                        <div class="flow-arrow" style="font-size:60px; line-height:1;">â†“</div>
                        <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px;">æ”¶é›†[æ ¡å¾½å¡]</div>
                        <div class="flow-arrow" style="font-size:60px; line-height:1;">â†“</div>
                        <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px; border:1px solid gold;">æ‰€æœ‰äººä¸€èµ·è·èƒœç¦»å¼€</div>
                    </div>
                </div>
                <div class="justice-capsule" style="--border-color: #3f72ff; margin-top:20px; text-align:center;">å‹è°Šã€åˆä½œã€å…±èµ¢</div>
            </div>
            <div class="justice-unit" style="position:relative;">
                <div class="equip-glass-card" style="width:100% !important;">
                    <div class="equip-card-header">å…¶å®è¿˜å¯ä»¥è¿™ä¹ˆç©</div>
                    <div class="equip-card-body" style="text-align:center; padding: 40px 20px !important;">
                        <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px;">ä¸€ä¸ªäººå•æ‰“ç‹¬æ–—</div>
                        <div class="flow-arrow" style="font-size:60px; line-height:1;">â†“</div>
                        <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px;">æŠ¢å¤º[??å¡]</div>
                        <div class="flow-arrow" style="font-size:60px; line-height:1;">â†“</div>
                        <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px; border:1px solid #FF00FF;">åªæœ‰è‡ªå·±è·èƒœç¦»å¼€</div>
                    </div>
                </div>
                <div class="justice-capsule" style="--border-color: #ff258b; margin-top:20px; text-align:center;">å­¤ç‹¬ã€æ å¤ºã€å”¯ä¸€</div>
            </div>
        </div>
        ${makeDrawer('right', comp.right)}
    </div>`;

    // 3. å…¨å®½å°¾å›¾
    html += `<img src="${OverviewAssets.guide.finalImg}" class="equip-final-full" style="margin-top:50px;">`;
    html += `</div></div>`; // é—­åˆ guide-container å’Œ ov-section

    // --- 1. æˆ°é¬¥ç« ç¯€ (è—è‰²) ---
// --- 1. æˆ°é¬¥ç« ç¯€ (è—è‰²) ---
    const combatColor = 'var(--tab-scenery)';
    const combatBg = `linear-gradient(180deg, color-mix(in srgb, ${combatColor}, transparent 90%) 0%, rgba(26,26,26,0) 100%)`;
    
    html += `
    <div class="ov-section" id="ov-combat" style="background: ${combatBg}; margin-top: 0;">
        <div class="bqc-chapter-bar" onclick="toggleOvMenu()" style="border-left-color: ${combatColor}; margin-top: 0 !important;">
            <div style="width:12px; height:12px; background:${combatColor}; border-radius:50%; box-shadow: 0 0 5px ${combatColor};"></div>
            <span class="bqc-bar-title" style="color:#fff">æˆ˜æ–—å§ï¼ â–¾</span>
        </div>
        
        <img src="${OverviewAssets.combatHeader}" class="combat-intro-header">`;

    // æ¥ä¸‹æ¥æ˜¯ä¸‰åˆ—å¼•å¯¼æ¨¡å—æ¸²æŸ“...
    // ==========================================
    // === [æ–°å¢] é¡¶éƒ¨ä¸‰åˆ—å¼•å¯¼æ¨¡å—æ¸²æŸ“ ===
    // ==========================================
    html += `
    <div class="ov-combat-intro-container">
        <div class="ov-combat-intro-inner">`;

    OverviewAssets.combatIntro.forEach(item => {
        html += `
            <div class="intro-column">
                <div class="intro-img-box">
                    <img src="${item.img}">
                </div>
                <div class="justice-capsule intro-capsule">${item.text}</div>
            </div>`;
    });

    html += `   </div>
    </div>`;
    
    OverviewAssets.battle.forEach((row) => {
        const side = row.side === 'left' ? 'side-left' : 'side-right';
        const tilt = row.side === 'left' ? '1.5deg' : '-1.5deg';
        html += `
        <div class="battle-row ${side}" data-animate="battle" style="--tilt: ${tilt}">
            <div class="battle-img-box"><img src="${row.img}"></div>
            <div class="battle-info-box"><img src="${row.info}"></div>
        </div>`;
    });
    html += `</div>`;

// --- 2. è£…å¤‡ç« èŠ‚ (ID ç¡®ä¿è·³è½¬å¯ç”¨) ---
// --- å®šä¹‰å›¾æ ‡èµ„æº ---


    // --- 2. è£…å¤‡ç« èŠ‚ ---
    const equipColor = 'var(--tab-cards)';
    const equipBg = `linear-gradient(180deg, color-mix(in srgb, ${equipColor}, transparent 90%) 0%, rgba(26,26,26,0) 100%)`;
    
    html += `
    <div class="ov-section" id="ov-equip" style="background: ${equipBg}; margin-top: 60px;">
        <div class="bqc-chapter-bar" onclick="toggleOvMenu()" style="border-left-color: ${equipColor}">
            <div style="width:12px; height:12px; background:${equipColor}; border-radius:50%; box-shadow: 0 0 5px ${equipColor};"></div>
            <span class="bqc-bar-title" style="color:#fff">è£…å¤‡å§ï¼ â–¾</span>
        </div>
        <div class="equip-container">`;

// 1. å®šä¹‰å¡ç‰Œæ•°æ®
    const RuleIcons = {
        RW: 'images/BQcards/icons/cards_categories/UI_Card_Person_01.png',
        JN: 'images/BQcards/icons/cards_categories/UI_Card_Skill_01.png',
        WP: 'images/BQcards/icons/cards_categories/UI_Card_Item_01.png',
        JK: 'images/BQcards/icons/cards_categories/UI_Card_Medal_01.png'
    };

    const CardColors = {
        RW: '#2f5fff', JN: '#ff3422', WP: '#23c75a', JK: '#eeff00'
    };

// å…§éƒ¨è¼”åŠ©ï¼šæ¸²æŸ“å±¬æ€§å¡Šï¼ˆå·²ä¿®æ­£ ??? æ–‡å­—é¡è‰²ç‚ºé»‘è‰²ï¼‰
    const renderAttrUnit = (name, img, color, tier) => {
        const isSecret = tier > 1; // 2éšåŠä»¥ä¸Šç¥ç¥•åŒ–
        const displayName = isSecret ? "???" : name;
        const darkenClass = isSecret ? "attr-darken" : "";
        
        // --- æ ¸å¿ƒä¿®æ”¹ï¼šåˆ¤æ–·æ–‡å­—é¡è‰² ---
        // å¦‚æœæ˜¯ç¥ç¥•åŒ–çš„ ???ï¼Œå¼·åˆ¶æ–‡å­—ç‚ºé»‘è‰² (#000)
        // å¦‚æœæ˜¯æ­£å¸¸é¡¯ç¤ºï¼Œå‰‡æ ¹æ“šèƒŒæ™¯æ·±æ·ºåˆ¤æ–·ï¼ˆé›·ã€å†°ã€æ™¶ã€å…‰ã€æ³¢ç­‰æ·ºè‰²èƒŒæ™¯ç”¨é»‘å­—ï¼Œå…¶é¤˜ç”¨ç™½å­—ï¼‰
        let textColor = "#fff";
        if (isSecret) {
            textColor = "#222"; 
        } else if (['é›·', 'å†°', 'æ™¶', 'å…‰', 'æ³¢'].includes(name)) {
            textColor = "#222";
        }

        return `
            <div class="attr-unit-mini tier-bg-${tier}" style="--glow-color: ${color}">
                <div class="attr-img-box ${darkenClass}">
                    <img src="${img}">
                </div>
                <div class="attr-label-box" style="--tag-bg: ${color}; color: ${textColor}; padding: 1px 0; font-size: 12px; font-weight: bold;">
                    ${displayName}
                </div>
            </div>`;
    };

    // è¾…åŠ©æ¸²æŸ“æ–‘ä¸˜å¡è¡¨æ ¼è¡Œ
    const renderBqRow = (key, title, content) => `
        <div style="display:flex; gap:20px; margin-bottom:25px; align-items:flex-start;">
            <div style="width:70px; flex-shrink:0; text-align:center;">
                <img src="${RuleIcons[key]}" style="width:60px; height:60px; filter:drop-shadow(0 0 5px ${CardColors[key]});">
                <div style="background:${CardColors[key]}; color:${key==='JK'?'#000':'#fff'}; font-size:12px; margin-top:5px; border-radius:4px;">${title}</div>
            </div>
            <div style="flex:1; font-size:14px; line-height:1.6;">${content}</div>
        </div>`;

    OverviewAssets.equip.forEach((item, index) => {
        // ã€æ ¸å¿ƒåˆ¤æ–­ã€‘ï¼šæ˜¯å¦ä¸ºæœ€åä¸€å¼ å›¾
        const isLastItem = (index === OverviewAssets.equip.length - 1);

        if (isLastItem) {
            // --- æœ€åä¸€å¼ å›¾çš„ç‹¬ç«‹é€»è¾‘ï¼šä¸å¥— equip-unit ç±»ï¼Œç›´æ¥æ¸²æŸ“ 100% å®½åº¦çš„å›¾ ---
            html += `<img src="${item.img}" class="equip-final-full">`;
        } else {
        html += `<div class="equip-unit">`; // æ¯ä¸ª item å¼€å¯ä¸€ä¸ªå¤§å•å…ƒ
        
        const imgClass = item.type === 'row-full' ? 'equip-row-full' : 'equip-img';
        html += `<img src="${item.img}" class="${imgClass}">`;

        // åŸºç¡€æ ‡é¢˜ç»ç’ƒæ¡†
        if (item.title && item.desc) {
            html += `
            <div class="equip-glass-card">
                <div class="equip-card-header">${item.title}</div>
                <div class="equip-card-body">${item.desc}</div>
            </div>`;
        }
//<span class="mm-highlight">ç¦æ­¢æš´åŠ›æŠ¢å¤º</span>ã€‚è¡Œå†…å˜è‰²æ ·å¼//
        // --- å•å…ƒ 2 (Index 1: å±æ€§å—) é¢å¤–æŒ‚è½½å†…å®¹ ---
// --- å•å…ƒ 2 (Index 1: å±æ€§å—) ---
// --- å•å…ƒ 2 (Index 1: å±æ€§å—) ---
        if (index === 1) {
            // ç»ç’ƒæ¡†ï¼šå›¾é‰´
            html += `
            <div class="equip-glass-card">
                <div class="equip-card-header">å±æ€§å—ç§ç±»</div>
                <div class="equip-card-body attr-grid-container">
                    ${renderAttrUnit('é‡‘', Attrs.METAL, '#5D9CCF', 1)}
                    ${renderAttrUnit('æœ¨', Attrs.WOOD, '#83D44A', 1)}
                    ${renderAttrUnit('æ°´', Attrs.WATER, '#40B3FF', 1)}
                    ${renderAttrUnit('ç«', Attrs.FIRE, '#FF4738', 1)}
                    ${renderAttrUnit('åœŸ', Attrs.EARTH, '#E8932E', 1)}
                    ${renderAttrUnit('é£', Attrs.WIND, '#3BCBC4', 2)}
                    ${renderAttrUnit('é›·', Attrs.THUNDER, '#F3EA49', 2)}
                    ${renderAttrUnit('å†°', Attrs.ICE, '#56FCD8', 2)}
                    ${renderAttrUnit('æ™¶', Attrs.CRYSTAL, '#E3E3E3', 2)}
                    ${renderAttrUnit('æ—¥', Attrs.SUN, '#F26522', 3)}
                    ${renderAttrUnit('æœˆ', Attrs.MOON, '#805CB0', 3)}
                    ${renderAttrUnit('å°˜', Attrs.DUST, '#6A4C53', 3)}
                    ${renderAttrUnit('å…‰', Attrs.LIGHT, '#feff00', 4)}
                    ${renderAttrUnit('æ˜Ÿ', Attrs.STAR, '#ff32b9', 4)}
                    ${renderAttrUnit('æ³¢', Attrs.WAVE, '#54f6d1', 5)}
                </div>
            </div>
            <div class="equip-glass-card">
                <div class="equip-card-header">å±æ€§å—åŠŸèƒ½</div>
                <div class="mindmap-container">
                    
                    <div class="mm-branches">
                        <div class="mm-branch">
                            <div class="mm-title">æ ¸å¿ƒåŠŸèƒ½</div>
                            <div class="mm-item">
                                <span class="mm-highlight">è´§å¸ï¼š</span>å¯ä»¥åœ¨[å‹è°Šç™¾è´§]ä¸­ï¼Œé€šè¿‡æ”¯ä»˜ä¸ç­‰æ•°é‡çš„[å±æ€§å—]ï¼Œæ¥[æŠ½å–]éƒ¨åˆ†[æ–‘ä¸˜å¡]ï¼Œæˆ–è€…ç›´æ¥[è´­ä¹°]éƒ¨åˆ†å±•ç¤ºå‡ºæ¥çš„[æ–‘ä¸˜å¡]ï¼›
                            </div>
                            <div class="mm-item">
                                <span class="mm-highlight">æ•°å€¼ï¼š</span>æ¸¸æˆä¸­æ²¡æœ‰ç­‰çº§æ¦‚å¿µï¼Œç©å®¶éœ€è¦é€šè¿‡å°†[å±æ€§å—]å¸ƒç½®åœ¨[å±æ€§ç›˜]çš„ç‰¹å®šä½ç½®ï¼Œæ¥æå‡è‡ªèº«æŸäº›ç‰¹å®šæ–¹é¢çš„æ•°å€¼ï¼Œè¯¦è§ä¹‹åçš„[å±æ€§ç›˜]ç¯‡ç« ã€‚
                            </div>
                        </div>
                        <div class="mm-branch">
                            <div class="mm-title">è¿ç”¨ç‰¹ç‚¹</div>
                            <div class="mm-item">
                                [å±æ€§å—]å¯ä»¥åœ¨ç©å®¶ä¸­è‡ªç”±åœ°äº¤æ˜“ã€èµ äºˆç­‰ï¼Œéœ€è¦åŒæ–¹åœ¨äº¤æ¢æ¡ä»¶ä¸Šè¾¾æˆå…±è¯†ï¼Œ<span class="mm-highlight">ä¸å¯ä»¥è¢«æš´åŠ›æŠ¢å¤º</span>ï¼›
                            </div>
                            <div class="mm-item">
                                æ¯å¤©éƒ½å¯ä»¥æŒ‰ç…§è‡ªèº«æ‰€æŒçš„æ•°é‡ï¼Œæœ‰ä¸€å®šå‡ ç‡ï¼Œè·å¾—ä¸€å®šæ¯”ä¾‹çš„<span class="mm-highlight">[åˆ©æ¯]</span>ï¼Œæ­¤[åˆ©æ¯]ç”±[ç¤¾è”ç»„]éšæœºå‘æ”¾ï¼›
                            </div>
                            <div class="mm-item">
                                <span class="mm-highlight">å„æ–­æœºåˆ¶ï¼š</span>å•ç§æ•°é‡å›ºå®šã€‚è‹¥æŸ[ç¤¾å›¢]è·å¾—å…¨éƒ¨æ•°é‡çš„å•ç§å—ï¼Œå¯ä»¥é€‰æ‹©å®£å¸ƒ[å„æ–­]ã€‚å„æ–­å[ç¤¾è”ç»„]å°†ä¸å†å‘æ”¾è¯¥ç§å—ï¼Œä»…èƒ½ä»ç©å®¶å¤„è·å–ã€‚
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;
        }

// --- å•å…ƒ 3 (Index 2: å¡ç›˜) ---
// --- å•å…ƒ 3 (Index 2: å¡ç›˜) è¿™é‡Œçš„é€»è¾‘ç´§è·Ÿåœ¨â€œå¡ç›˜â€å›¾ç‰‡å’Œç»ç’ƒæ¡†åé¢ ---
        if (index === 2) {
            // å®šä¹‰æ¸²æŸ“å•è¡Œå¯¼å›¾çš„è¾…åŠ©å‡½æ•°
            const renderBqMindmap = (key, name, color, textColor, branches) => `
                <div class="bq-mm-row" style="--card-color: ${color}">
                    <div class="bq-mm-header">
                        <img src="${RuleIcons[key]}">
                        <div class="bq-mm-tag" style="--text-color: ${textColor}">${name}</div>
                    </div>
                    <div class="bq-mm-content">
                        <div class="mm-branch">
                            <div class="mm-title">è·å–æ–¹å¼</div>
                            <div class="mm-item">${branches.get}</div>
                        </div>
                        <div class="mm-branch">
                            <div class="mm-title">ä½œç”¨</div>
                            <div class="mm-item">${branches.effect}</div>
                        </div>
                        <div class="mm-branch">
                            <div class="mm-title">æ•°é‡ä¸å„æ–­</div>
                            <div class="mm-item">${branches.monopoly}</div>
                        </div>
                    </div>
                </div>`;

            html += `
            <div class="equip-glass-card">
                <div class="equip-card-header">æ–‘ä¸˜å¡</div>
                <div class="equip-card-body" style="padding: 30px;">
                    
                    ${renderBqMindmap('RW', 'äººç‰©å¡', '#2f5fff', '#fff', {
                        get: `ç©å®¶å¯ä»¥é€šè¿‡å‡»æ€å¯¹æ–¹è·å¾—ã€æˆ–è€…è¢«å¯¹æ–¹è‡ªæ„¿èµ äºˆï¼Œæˆ–äº¤æ˜“è·å¾—`,
                        effect: `è·å–å±æ€§å—ï¼Œå¯ä¸æŒæœ‰åŒæ–¹[äººç‰©å¡]çš„å¯¹è±¡äº¤æµé€šä¿¡ï¼Œéä¸€æ¬¡æ€§ã€‚`,
                        monopoly: `æ€»æ•°æ— é™åˆ¶ã€‚æ¯äººä»…èƒ½ç»™äºˆä¸€æ¬¡ï¼Œ<span class="mm-highlight">ä¸å¯å„æ–­</span>ã€‚`
                    })}

                    ${renderBqMindmap('JN', 'æŠ€èƒ½å¡', '#ff3422', '#fff', {
                        get: `åœ¨[å‹è°Šç™¾è´§]ä¸­æŠ½å–ï¼Œæˆ–äº¤æ˜“è·å¾—ã€‚`,
                        effect: `åœ¨æˆ˜æ–—ä¸­ä½¿å‡ºå¼ºåŠ›æ‹›å¼ã€‚æ¶ˆè€—åå›åˆ°å¡æ± ï¼Œå…¨éƒ¨ä¸º<span class="mm-highlight">ä¸€æ¬¡æ€§</span>ã€‚`,
                        monopoly: `ç´¯è®¡è§¦å‘100æ¬¡å¯å®£å¸ƒ[å„æ–­]ã€‚å„æ–­åæœ¬ç¤¾å›¢æˆå‘˜<span class="mm-highlight">å…è´¹ä½¿ç”¨</span>ï¼ˆæ— è§†æ¡ä»¶ï¼‰ã€‚`
                    })}

                    ${renderBqMindmap('WP', 'ç‰©å“å¡', '#23c75a', '#fff', {
                        get: `æ¢ç´¢åœ°å›¾ã€å®Œæˆä»»åŠ¡ã€ç™¾è´§æŠ½å–æˆ–äº¤æ˜“è·å¾—ã€‚`,
                        effect: `æˆ˜æ–—åŠ æˆã€æ¢å¤ä½“åŠ›ã€‚å¤§éƒ¨åˆ†ä¸ºä¸€æ¬¡æ€§ï¼Œæ¶ˆè€—åå›å¡æ± ã€‚`,
                        monopoly: `<span class="mm-highlight">[æ ¡å¾½å¡]</span>å•ç§ä»…1å¼ ã€‚å¼€å¹´ç”±ç¤¾è”ç»„è‡ªåŠ¨åˆ†é…ï¼Œ<span class="mm-highlight">ä¸å¯å„æ–­</span>ã€‚`
                    })}

                    ${renderBqMindmap('JK', 'ï¼Ÿï¼Ÿï¼Ÿ', '#eeff00', '#000', {
                        get: `ï¼Ÿï¼Ÿï¼Ÿ`,
                        effect: `ï¼Ÿï¼Ÿï¼Ÿ`,
                        monopoly: `ï¼Ÿï¼Ÿï¼Ÿ`
                    })}

                </div>
            </div>`;
        }

        html += `</div>`; // é—­åˆå•å…ƒ
}
    });

    
    // --- 3. å…¬æ­£ç« ç¯€ (ç²‰è‰²) ---
    const justiceColor = 'var(--tab-chars)';
    const justiceBg = `linear-gradient(180deg, color-mix(in srgb, ${justiceColor}, transparent 90%) 0%, rgba(26,26,26,0) 100%)`;
    html += `
    <div class="ov-section" id="ov-justice" style="background: ${justiceBg}; margin-top: 60px;">
        <div class="bqc-chapter-bar" onclick="toggleOvMenu()" style="border-left-color: ${justiceColor}; margin-top: 0 !important;">
            <div style="width:12px; height:12px; background:${justiceColor}; border-radius:50%; box-shadow: 0 0 5px ${justiceColor};"></div>
            <span class="bqc-bar-title" style="color:#fff">ä¸å…¬æ­£å§ï¼ â–¾</span>
        </div>
        <div class="justice-grid">`;
    
    OverviewAssets.justice.forEach(row => {
        html += `
        <div class="justice-unit">
            <img src="${row.imgL}" class="justice-img">
            <div class="justice-capsule" style="--border-color: #3f72ff">${row.textL1}</div>
        </div>
        <div class="justice-unit">
            <img src="${row.imgR}" class="justice-img">
            <div class="justice-capsule" style="--border-color: ${justiceColor}">${row.textR1}</div>
        </div>`;
    });
    html += `</div></div>`;

    root.innerHTML = html;
    if (typeof startOverviewObserver === "function") startOverviewObserver();
}


// [è¡¥å…¨] å¯åŠ¨æ€»è§ˆé¡µé¢çš„æ»šåŠ¨è§‚å¯Ÿå™¨ï¼Œå¤„ç†â€œæ¨æ‹‰é—¨â€åŠ¨ç”»
function startOverviewObserver() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
            } else {
                // å¦‚æœå¸Œæœ›å¾€å›æ»šæ—¶åŠ¨ç”»é‡ç½®ï¼Œä¿ç•™ä¸‹é¢è¿™è¡Œ
                entry.target.classList.remove('active');
            }
        });
    }, { 
        threshold: 0.2, // åªè¦éœ²å‡ºæ¥ 20% å°±è§¦å‘
        root: document.getElementById('view-overview') // é”å®šæ»šåŠ¨å®¹å™¨
    });

    // è§‚å¯Ÿæ‰€æœ‰çš„æˆ˜æ–—è¡Œ
    document.querySelectorAll('[data-animate="battle"], [data-animate="guide"]').forEach(el => observer.observe(el));
}


// 1. åªè¦ HTML ç»“æ„å‡†å¤‡å¥½ï¼Œç«‹å³å¯åŠ¨é¦–é¡µé€»è¾‘ (ä¸å†ç­‰å¾…å›¾ç‰‡ä¸‹è½½)
document.addEventListener('DOMContentLoaded', () => {
    // ç«‹å³åˆå§‹åŒ–é¦–é¡µçš„æ ¸å¿ƒäº¤äº’
    initHomeLogic(); 

    // 2. å¼‚æ­¥æ¸²æŸ“å…¶ä»–æ²‰é‡çš„é¡µé¢ï¼Œä¸é˜»å¡é¦–é¡µ
    setTimeout(() => {
        try {
            renderOverview(); 
            renderCharPage();   
            renderBqCards();    
            renderBqScenery();  
            renderStory();      
        } catch (e) {
            console.error("æ¸²æŸ“å»¶è¿Ÿé¡µé¢æ—¶å‡ºé”™:", e);
        }
    }, 50); // ç»™é¦–é¡µé€»è¾‘ç•™å‡º 50ms çš„ä¼˜å…ˆå¯åŠ¨æ—¶é—´
});
// å°†ä½ åŸæœ¬åœ¨ setTimeout é‡Œçš„é¦–é¡µé€»è¾‘å°è£…æˆå‡½æ•°
function initHomeLogic() {
    const homeView = document.getElementById('view-home');
    const wings = document.getElementById('home-wings');
    const mainImg = document.getElementById('home-main-img');
    const facade = document.querySelector('.home-facade-container');    // 2. å‘¼å¸åŠ¨åŠ›å­¦å˜é‡
    // ã€æ ¸å¿ƒä¿®æ­£ 1ã€‘ï¼šå¿…é¡»åœ¨è¿™é‡ŒæŠ“å–å·¦å³ç¿…è†€å…ƒç´ ï¼Œå¦åˆ™ä¸‹é¢ä¼šæŠ¥é”™
    const leftWing = wings ? wings.querySelector('.left') : null;
    const rightWing = wings ? wings.querySelector('.right') : null;
    let breathPhase = 0; // å‘¼å¸ç›¸ä½ (0 ~ 2Ï€)
// ã€åˆ é™¤æ—§çš„ isSpecialModeã€‘
// ã€æ·»åŠ ä»¥ä¸‹é€»è¾‘ã€‘
    let currentVisualIndex = 0; // è®°å½•å½“å‰æ’­æ”¾åˆ°ç¬¬å‡ å¼  (0, 1, 2)
    const visualSequence = [
    HomeAssets.mainVisual, 
    HomeAssets.specialVisual, 
    HomeAssets.thirdVisual
];

    if (homeView && wings) {
homeView.addEventListener('mousemove', (e) => {
            // --- A. 3D å€¾æ–œé€»è¾‘ (ä¿æŒç°çŠ¶) ---
            const w = homeView.offsetWidth;
            const h = homeView.offsetHeight;
            const mouseX = (e.clientX / w) - 0.5;
            const mouseY = (e.clientY / h) - 0.5;
            wings.style.transform = `rotateX(${mouseY * -15}deg) rotateY(${mouseX * 8}deg)`;

            // --- B. åŠ¨åŠ›å‘¼å¸é€»è¾‘ (å¹³æ»‘ä¼˜åŒ–ç‰ˆ) ---
            // 1. è®¡ç®—åŸå§‹è·ç¦»
            let moveDist = Math.sqrt(Math.pow(e.movementX, 2) + Math.pow(e.movementY, 2));
            
            // 2. ã€æ ¸å¿ƒé™é€Ÿã€‘å•å¸§ä½ç§»è¶…è¿‡ 30 åƒç´ çš„éƒ¨åˆ†ä¼šè¢«å¤§å¹…å‰Šå¼±ï¼Œé˜²æ­¢â€œé¬¼ç•œâ€
            // è¿™æ ·å³ä½¿ä½ é¼ æ ‡ç”©å¾—å†å¿«ï¼ŒåŠ¨ç”»ä¹Ÿåªæ˜¯å¹³ç¨³åŠ é€Ÿï¼Œè€Œä¸ä¼šè·³å˜
            if (moveDist > 30) moveDist = 30 + (moveDist - 30) * 0.1;

            // 3. ã€é™ä½çµæ•åº¦ã€‘ç³»æ•°ä» 0.008 é™åˆ° 0.002ï¼Œè®©åŠ¨ä½œå˜é‡ã€å˜æ²‰ç¨³
            breathPhase += moveDist * 0.001;

            // 4. è®¡ç®—ç¼©æ”¾ (1.0 åˆ° 1.05)
            // è¿™é‡Œçš„ç›¸ä½å˜åŒ–ä¼šå› ä¸º CSS çš„ transition å˜å¾—æå…¶ä¸æ»‘
            const scaleL = 1 + (Math.sin(breathPhase) + 1) * 0.05;
            const scaleR = 1 + (Math.sin(breathPhase + Math.PI) + 1) * 0.05;

            leftWing.style.transform = `scale(${scaleL})`;
            rightWing.style.transform = `scale(${scaleR})`;
        });
    }

    // 3. ç‚¹å‡»åˆ‡æ¢ä¸»è§†è§‰ (å¼€å…³å¼ï¼Œæ— è®¡æ—¶å™¨)
    if (facade && mainImg) {
facade.addEventListener('mousedown', (e) => {
    // æ’é™¤åº•éƒ¨çš„æ ‡ç­¾æŒ‰é’®
    if (e.target.closest('.home-note-btn')) return;

    // --- ã€ä¿®æ”¹æ ¸å¿ƒé€»è¾‘ã€‘ ---
    // 1. ç´¢å¼•é€’å¢
    currentVisualIndex++; 
    
    // 2. å¦‚æœè¶…è¿‡ 2 (ç¬¬ä¸‰å¼ )ï¼Œåˆ™å›åˆ° 0 (ç¬¬ä¸€å¼ )
    if (currentVisualIndex >= visualSequence.length) {
        currentVisualIndex = 0;
    }

    // 3. æ ¹æ®ç´¢å¼•åˆ‡æ¢å›¾ç‰‡åœ°å€
    mainImg.src = visualSequence[currentVisualIndex];
    
    // [å¯é€‰] æ‰“å°ä¸€ä¸‹å½“å‰æ˜¯ç¬¬å‡ å¼ ï¼Œæ–¹ä¾¿è°ƒè¯•
    console.log("å½“å‰ä¸»è§†è§‰åºå·:", currentVisualIndex);
});
    }

    // 4. é»˜è®¤æ˜¾ç¤º
    const defaultTab = document.querySelector('.nav-tab.tab-home');
    switchView('home', defaultTab);
    
    const homeNav = document.querySelector('.home-nav-footer');
    if (homeNav && homeNav.firstElementChild) {
        homeNav.firstElementChild.classList.add('attention-wiggle');
    }
// --- ã€æ–°å¢ã€‘æˆ˜æ–—æˆªå›¾ç”»å»Šé€»è¾‘ ---
    let battleImagesSrc = []; // å­˜æ”¾æ‰€æœ‰æˆ˜æ–—å›¾ç‰‡è·¯å¾„çš„æ•°ç»„
    let currentBattleIndex = 0; // å½“å‰æŸ¥çœ‹çš„å›¾ç‰‡ç´¢å¼•

    const battleModal = document.getElementById('battle-modal');
    const battleModalImg = document.getElementById('battle-modal-img');

    // 1. åˆå§‹åŒ–ç”»å»Šï¼šæ”¶é›†å›¾ç‰‡ï¼ˆä¿®æ”¹ï¼šæ”¹ä¸ºåŠ¨æ€æ”¶é›†ï¼Œä¸å†æ‰‹åŠ¨ç»‘å®šäº‹ä»¶ï¼‰
    function initBattleGallery() {
        // é‡æ–°è·å–å½“å‰é¡µé¢ä¸Šæ‰€æœ‰çš„æˆ˜æ–—æˆªå›¾
        const imgs = document.querySelectorAll('.battle-row .battle-img-box img');
        battleImagesSrc = Array.from(imgs).map(img => img.src);
    }

    // ã€æ ¸å¿ƒæ–°å¢ã€‘ï¼šä½¿ç”¨å…¨å±€ç›‘å¬å®ç°ç‚¹å‡»ï¼Œè§£å†³åŠ¨æ€æ¸²æŸ“ç‚¹ä¸å¼€çš„é—®é¢˜
    document.addEventListener('click', (e) => {
        // å¯»æ‰¾ç‚¹å‡»çš„ç›®æ ‡æ˜¯å¦æ˜¯æˆ˜æ–—æˆªå›¾å®¹å™¨
        const box = e.target.closest('.battle-img-box');
        if (box && box.closest('.battle-row')) {
            initBattleGallery(); // æ¯æ¬¡æ‰“å¼€å‰æ›´æ–°ä¸€æ¬¡å›¾ç‰‡æ± 
            
            // æ‰¾åˆ°å½“å‰ç‚¹å‡»çš„æ˜¯ç¬¬å‡ å¼ 
            const allBoxes = Array.from(document.querySelectorAll('.battle-row .battle-img-box'));
            const index = allBoxes.indexOf(box);
            
            if (index !== -1) {
                openBattleModal(index);
            }
        }
    });

// 2. æ‰“å¼€æµ®çª—
    window.openBattleModal = function(index) {
        currentBattleIndex = index;
        updateModalImage();
        const battleModal = document.getElementById('battle-modal');
        if (battleModal) {
            battleModal.classList.add('open');
            // ã€æ ¸å¿ƒä¿®æ­£ã€‘å¼ºåˆ¶æ˜¾ç¤ºï¼Œé˜²æ­¢æ ·å¼å†²çª
            battleModal.style.display = 'flex'; 
        }
        document.body.style.overflow = 'hidden';
    };

    // 3. å…³é—­æµ®çª—
    window.closeBattleModal = function() {
        const battleModal = document.getElementById('battle-modal');
        if (battleModal) {
            battleModal.classList.remove('open');
            battleModal.style.display = 'none'; 
        }
        // æ¸…ç©ºè·¯å¾„é˜²æ­¢æ®‹å½±
        if (battleModalImg) battleModalImg.src = '';
        document.body.style.overflow = '';
    };

    // 4. åˆ‡æ¢å›¾ç‰‡ (å¾ªç¯æ’­æ”¾é€»è¾‘)
    // direction: -1 ç‚ºä¸Šä¸€å¼µ, 1 ç‚ºä¸‹ä¸€å¼µ
    window.changeBattleImage = function(direction) {
        currentBattleIndex += direction;

        // å¾ªç¯é€»è¾‘æ ¸å¿ƒï¼š
        if (currentBattleIndex >= battleImagesSrc.length) {
            currentBattleIndex = 0; // è¶…è¿‡æœ€åä¸€å¼ ï¼Œå›åˆ°ç¬¬ä¸€å¼ 
        } else if (currentBattleIndex < 0) {
            currentBattleIndex = battleImagesSrc.length - 1; // å°äºç¬¬ä¸€å¼ ï¼Œå›åˆ°æœ€åä¸€å¼ 
        }

        updateModalImage();
    };

    // 5. æ›´æ–°æµ®çª—å¤§å›¾ src
function updateModalImage() {
        if (battleImagesSrc.length > 0 && battleModalImg) {
            // [æ ¸å¿ƒä¿®æ”¹]ï¼šåˆ é™¤äº† opacity å˜åŒ–å’Œ setTimeout
            // ç›´æ¥æ›´æ¢å›¾ç‰‡è·¯å¾„ï¼Œå®ç°ç¬é—´åˆ‡æ¢
            battleModalImg.src = battleImagesSrc[currentBattleIndex];
        }
    }

    // é”®ç›˜æ”¯æŒï¼šæŒ‰ ESC å…³é—­ï¼ŒæŒ‰å·¦å³é”®åˆ‡æ¢
    document.addEventListener('keydown', (e) => {
        if (!battleModal || !battleModal.classList.contains('open')) return;
        if (e.key === 'Escape') closeBattleModal();
        if (e.key === 'ArrowLeft') changeBattleImage(-1);
        if (e.key === 'ArrowRight') changeBattleImage(1);
    });


console.log("é¦–é¡µäº¤äº’é€»è¾‘å·²ä¼˜å…ˆå¯åŠ¨");
}

</script>

</body>
</html>